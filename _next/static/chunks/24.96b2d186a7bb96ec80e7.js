(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[24],{"16wW":function(t,e,n){"use strict";var r={};(0,n("vn/o").assign)(r,n("QSbz"),n("cX6o"),n("LOvY")),t.exports=r},"6PBO":function(t,e,n){"use strict";n.r(e);var r=n("Womt"),i=n("16wW"),o=n.n(i),a=n("Q/xN"),s=n.n(a),l=n("qjPM");const h=function(t,e){const n=this,i=-1,o=0,a=1,s=2,l=3,h=4;this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.5,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new r.L;const u=new r.L;let c=i,d=i;const f=new r.L,p=new r.K,m=new r.K,g=new r.L;let _=0;const v=new r.K,w=new r.K;let y=0,b=0;const x=new r.K,k=new r.K;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();const S={type:"change"},M={type:"start"},A={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{const t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}};const E=function(){const t=new r.K;return function(e,r){return t.set((e-n.screen.left)/n.screen.width,(r-n.screen.top)/n.screen.height),t}}(),C=function(){const t=new r.K;return function(e,r){return t.set((e-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-r))/n.screen.width),t}}();function O(t){!1!==n.enabled&&(window.removeEventListener("keydown",O),d=c,c===i&&(t.keyCode!==n.keys[o]||n.noRotate?t.keyCode!==n.keys[a]||n.noZoom?t.keyCode!==n.keys[s]||n.noPan||(c=s):c=a:c=o))}function z(t){!1!==n.enabled&&(c=d,window.addEventListener("keydown",O,!1))}function j(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),c===i&&(c=t.button),c!==o||n.noRotate?c!==a||n.noZoom?c!==s||n.noPan||(x.copy(E(t.pageX,t.pageY)),k.copy(x)):(v.copy(E(t.pageX,t.pageY)),w.copy(v)):(m.copy(C(t.pageX,t.pageY)),p.copy(m)),document.addEventListener("mousemove",T,!1),document.addEventListener("mouseup",F,!1),n.dispatchEvent(M))}function T(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),c!==o||n.noRotate?c!==a||n.noZoom?c!==s||n.noPan||k.copy(E(t.pageX,t.pageY)):w.copy(E(t.pageX,t.pageY)):(p.copy(m),m.copy(C(t.pageX,t.pageY))))}function F(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),c=i,document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",F),n.dispatchEvent(A))}function N(t){if(!1!==n.enabled&&!0!==n.noZoom){switch(t.preventDefault(),t.stopPropagation(),t.deltaMode){case 2:v.y-=.025*t.deltaY;break;case 1:v.y-=.01*t.deltaY;break;default:v.y-=25e-5*t.deltaY}n.dispatchEvent(M),n.dispatchEvent(A)}}function P(t){if(!1!==n.enabled){switch(t.preventDefault(),t.touches.length){case 1:c=l,m.copy(C(t.touches[0].pageX,t.touches[0].pageY)),p.copy(m);break;default:c=h;var e=t.touches[0].pageX-t.touches[1].pageX,r=t.touches[0].pageY-t.touches[1].pageY;b=y=Math.sqrt(e*e+r*r);var i=(t.touches[0].pageX+t.touches[1].pageX)/2,o=(t.touches[0].pageY+t.touches[1].pageY)/2;x.copy(E(i,o)),k.copy(x)}n.dispatchEvent(M)}}function L(t){if(!1!==n.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:p.copy(m),m.copy(C(t.touches[0].pageX,t.touches[0].pageY));break;default:var e=t.touches[0].pageX-t.touches[1].pageX,r=t.touches[0].pageY-t.touches[1].pageY;b=Math.sqrt(e*e+r*r);var i=(t.touches[0].pageX+t.touches[1].pageX)/2,o=(t.touches[0].pageY+t.touches[1].pageY)/2;k.copy(E(i,o))}}function D(t){if(!1!==n.enabled){switch(t.touches.length){case 0:c=i;break;case 1:c=l,m.copy(C(t.touches[0].pageX,t.touches[0].pageY)),p.copy(m)}n.dispatchEvent(A)}}function R(t){!1!==n.enabled&&t.preventDefault()}this.rotateCamera=function(){const t=new r.L,e=new r.B,i=new r.L,o=new r.L,a=new r.L,s=new r.L;let l;return function(){s.set(m.x-p.x,m.y-p.y,0),l=s.length(),l?(f.copy(n.object.position).sub(n.target),i.copy(f).normalize(),o.copy(n.object.up).normalize(),a.crossVectors(o,i).normalize(),o.setLength(m.y-p.y),a.setLength(m.x-p.x),s.copy(o.add(a)),t.crossVectors(s,f).normalize(),l*=n.rotateSpeed,e.setFromAxisAngle(t,l),f.applyQuaternion(e),n.object.up.applyQuaternion(e),g.copy(t),_=l):!n.staticMoving&&_&&(_*=Math.sqrt(1-n.dynamicDampingFactor),f.copy(n.object.position).sub(n.target),e.setFromAxisAngle(g,_),f.applyQuaternion(e),n.object.up.applyQuaternion(e)),p.copy(m)}}(),this.zoomCamera=function(){let t;c===h?(t=y/b,y=b,f.multiplyScalar(t)):(t=1+(w.y-v.y)*n.zoomSpeed,1!==t&&t>0&&f.multiplyScalar(t),n.staticMoving?v.copy(w):v.y+=(w.y-v.y)*this.dynamicDampingFactor)},this.panCamera=function(){const t=new r.K,e=new r.L,i=new r.L;return function(){t.copy(k).sub(x),t.lengthSq()&&(t.multiplyScalar(f.length()*n.panSpeed),i.copy(f).cross(n.object.up).setLength(t.x),i.add(e.copy(n.object.up).setLength(t.y)),n.object.position.add(i),n.target.add(i),n.staticMoving?x.copy(k):x.add(t.subVectors(k,x).multiplyScalar(n.dynamicDampingFactor)))}}(),this.checkDistances=function(){n.noZoom&&n.noPan||(f.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,f.setLength(n.maxDistance)),v.copy(w)),f.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,f.setLength(n.minDistance)),v.copy(w)))},this.update=function(){f.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,f),n.checkDistances(),n.object.lookAt(n.target),u.distanceToSquared(n.object.position)>1e-6&&(n.dispatchEvent(S),u.copy(n.object.position))},this.reset=function(){c=i,d=i,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),f.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(S),u.copy(n.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",R,!1),this.domElement.removeEventListener("mousedown",j,!1),this.domElement.removeEventListener("wheel",N,!1),this.domElement.removeEventListener("touchstart",P,!1),this.domElement.removeEventListener("touchend",D,!1),this.domElement.removeEventListener("touchmove",L,!1),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",F,!1),window.removeEventListener("keydown",O,!1),window.removeEventListener("keyup",z,!1)},this.domElement.addEventListener("contextmenu",R,!1),this.domElement.addEventListener("mousedown",j,!1),this.domElement.addEventListener("wheel",N,!1),this.domElement.addEventListener("touchstart",P,!1),this.domElement.addEventListener("touchend",D,!1),this.domElement.addEventListener("touchmove",L,!1),window.addEventListener("keydown",O,!1),window.addEventListener("keyup",z,!1),this.handleResize(),this.update()};h.prototype=Object.create(r.i.prototype);const u=function(t){this.manager=void 0!==t?t:r.f};u.prototype={constructor:u,load(t,e,n,i){const a=this,s=new r.k(a.manager);s.setResponseType("arraybuffer"),s.load(t,(t=>{try{t=o.a.inflate(t).buffer}catch(n){}try{e(a.parse(t))}catch(r){i&&i(r)}}),n,i)},parse(t){function e(t,e,n){for(let r=0,i=t.length;r<i;r++)if(t[r]!==e.getUint8(n+r,!1))return!1;return!0}const n=function(t){if("string"===typeof t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer||e}return t}(t);return function(t){let n,r,i,o;if(o=new DataView(t),r=50,i=o.getUint32(80,!0),n=84+50*i,n===o.byteLength)return!0;const a=[115,111,108,105,100];for(let s=0;s<5;s++)if(e(a,o,s))return!1;return!0}(n)?function(t){const e=new DataView(t),n=e.getUint32(80,!0);let i,o,a,s,l,h,u,c,d=!1;for(let r=0;r<70;r++)1129270351==e.getUint32(r,!1)&&82==e.getUint8(r+4)&&61==e.getUint8(r+5)&&(d=!0,s=[],l=e.getUint8(r+6)/255,h=e.getUint8(r+7)/255,u=e.getUint8(r+8)/255,c=e.getUint8(r+9)/255);const f=new r.d,p=[],m=[];for(let r=0;r<n;r++){const t=84+50*r,n=e.getFloat32(t,!0),c=e.getFloat32(t+4,!0),f=e.getFloat32(t+8,!0);if(d){const n=e.getUint16(t+48,!0);0===(32768&n)?(i=(31&n)/31,o=(n>>5&31)/31,a=(n>>10&31)/31):(i=l,o=h,a=u)}for(let r=1;r<=3;r++){const l=t+12*r;p.push(e.getFloat32(l,!0)),p.push(e.getFloat32(l+4,!0)),p.push(e.getFloat32(l+8,!0)),m.push(n,c,f),d&&s.push(i,o,a)}}return f.addAttribute("position",new r.c(new Float32Array(p),3)),f.addAttribute("normal",new r.c(new Float32Array(m),3)),d&&(f.addAttribute("color",new r.c(new Float32Array(s),3)),f.hasColors=!0,f.alpha=c),f}(n):function(t){const e=new r.d,n=/facet([\s\S]*?)endfacet/g;let i=0;const o=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,a=new RegExp(`vertex${o}${o}${o}`,"g"),s=new RegExp(`normal${o}${o}${o}`,"g"),l=[],h=[],u=new r.L;let c;for(;null!==(c=n.exec(t));){let t=0,e=0;const n=c[0];for(;null!==(c=s.exec(n));)u.x=parseFloat(c[1]),u.y=parseFloat(c[2]),u.z=parseFloat(c[3]),e++;for(;null!==(c=a.exec(n));)l.push(parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3])),h.push(u.x,u.y,u.z),t++;1!==e&&console.error(`THREE.STLLoader: Something isn't right with the normal of face number ${i}`),3!==t&&console.error(`THREE.STLLoader: Something isn't right with the vertices of face number ${i}`),i++}return e.addAttribute("position",new r.l(l,3)),e.addAttribute("normal",new r.l(h,3)),e}("string"!==typeof(i=t)?r.s.decodeText(new Uint8Array(i)):i);var i}};class c{static getOption(t,e,n){return t&&e in t?t[e]:n}static makeCylinder(t,e,n,i,o){const a=.5*Math.PI,s=t.distanceTo(e),l=e.clone().add(t).divideScalar(2),h=new r.t;h.setPosition(l);const u=new r.e(n,i,s,32,1,o),c=new r.t;c.multiply(h);const d=new r.t;return c.lookAt(t,e,new r.L(0,1,0)),d.makeRotationX(a),c.multiply(d),u.applyMatrix(c),u}static triggerDownload(t,e){const n=document.createElement("a");document.body.appendChild(n),n.download=e,n.href=t,n.click(),document.body.removeChild(n)}}const d=1e3;class f extends class{constructor(){this._events={}}on(t,e){"function"===typeof e?(t in this._events||(this._events[t]=[]),this._events[t].push(e)):console.warn("The callback must be of type Function")}emit(t,e=[]){if(t in this._events&&this._events[t].length>0){const n=this._events[t];for(let t=0;t<n.length;t+=1)n[t](...e)}else console.warn(`No function associated to the event ${t}`)}}{constructor(t=null){super();const e=this;if(!t)return void console.error("The ThreeContext needs a div object");this._requestFrameId=null,this._morphologyMeshCollection={},this._meshCollection={},this._camera=new r.z(27,t.clientWidth/t.clientHeight,1,1e6),this._camera.position.z=d,this._scene=new r.D,this._scene.add(new r.a(4473924));const n=new r.g(16777215,.8);this._scene.add(this._camera),this._camera.add(n),this._renderer=new r.M({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}),this._renderer.setClearColor(16777215,0),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(t.clientWidth,t.clientHeight),this._renderer.gammaInput=!0,this._renderer.gammaOutput=!0,t.appendChild(this._renderer.domElement),this._raycaster=new r.C,this._raycastMouse=new r.K,this._renderer.domElement.addEventListener("mousemove",(function(t){const n=e._renderer.domElement.getBoundingClientRect(),r=t.clientX-n.left,i=t.clientY-n.top;e._raycastMouse.x=r/e._renderer.domElement.clientWidth*2-1,e._raycastMouse.y=-i/e._renderer.domElement.clientHeight*2+1}),!1),this._renderer.domElement.addEventListener("dblclick",(()=>{this._performRaycast()}),!1),this._controls=new h(this._camera,this._renderer.domElement),this._controls.rotateSpeed=3,this._controls.addEventListener("change",this._render.bind(this)),window.addEventListener("resize",(()=>{e._camera.aspect=t.clientWidth/t.clientHeight,e._camera.updateProjectionMatrix(),e._renderer.setSize(t.clientWidth,t.clientHeight),e._controls.handleResize(),e._render()}),!1),this._testObjMesh(),this._render(),this._animate()}_testObjMesh(){}getCameraFieldOfView(){return this._camera.fov}setCameraFieldOfView(t){this._camera.fov=t,this._camera.updateProjectionMatrix(),this._render()}addStlToMeshCollection(t,e){const n=this,i=c.getOption(e,"name",`mesh_${Math.round(1e6*Math.random()).toString()}`),o=c.getOption(e,"focusOn",!0);(new u).load(t,(t=>{const a=this._buildMeshMaterialFromOptions(e);t.computeBoundingSphere();const s=new r.u(t,a);s.userData.name=i,n._scene.add(s),n._meshCollection[i]=s,o&&n.focusOnMesh(i);const l=c.getOption(e,"onDone",null);l&&l(i),this._render()}))}_buildMeshMaterialFromOptions(t){const e=c.getOption(t,"color",Math.floor(16777215*Math.random())),n=c.getOption(t,"opacity",.15),i=c.getOption(t,"wireframe",!1),o=c.getOption(t,"shininess",300),a=c.getOption(t,"doubleSide",!1);return new r.w({specular:16777215,shininess:o,side:a?r.h:r.m,color:e,transparent:!0,opacity:n,wireframe:i})}addObjToMeshCollection(t,e){const n=c.getOption(e,"name",`mesh_${Math.round(1e6*Math.random()).toString()}`),i=c.getOption(e,"focusOn",!0);let o=s()(t);const a=o.cells[0].length;let l=new Uint32Array(a*o.cells.length),h=new Float32Array(3*o.positions.length);for(let r=0;r<o.cells.length;r+=1){let t=r*a;for(let e=0;e<a;e+=1)l[t+e]=o.cells[r][e]}for(let r=0;r<o.positions.length;r+=1){let t=3*r;h[t]=o.positions[r][0],h[t+1]=o.positions[r][1],h[t+2]=o.positions[r][2]}var u=new r.d;u.setIndex(new r.c(l,1)),u.addAttribute("position",new r.c(h,a)),u.computeBoundingSphere(),u.computeVertexNormals(),u.rotateX(Math.PI),u.rotateY(Math.PI);let d=this._buildMeshMaterialFromOptions(e);const f=new r.u(u,d);f.userData.name=n,this._scene.add(f),this._meshCollection[n]=f,i&&this.focusOnMesh(n);const p=c.getOption(e,"onDone",null);p&&p(n),this._render()}_animate(){this._requestFrameId=requestAnimationFrame(this._animate.bind(this)),this._controls.update()}_render(){this._renderer.render(this._scene,this._camera)}_performRaycast(){this._raycaster.setFromCamera(this._raycastMouse,this._camera);const t=this._raycaster.intersectObjects(this._scene.children,!0);if(t.length){const e=t[0].object;if("sectionId"in e.userData){const{sectionId:t}=e.userData,n=e.parent.getMorphology();this.emit("onRaycast",[n._sections[t]])}else"name"in e.userData?this.emit("onRaycast",[e.userData.name]):this.emit("onRaycast",[null])}}addMorphology(t,e){const n=e.name,r=c.getOption(e,"focusOn",!0),i=c.getOption(e,"distance",d);this._morphologyMeshCollection[n]=t,this._scene.add(t),r&&this.focusOnMorphology(n,i);const o=c.getOption(e,"onDone");o&&o(n),this._render()}focusOnMorphology(t=null,e=1e3){let n=t;if(!n){const t=Object.keys(this._morphologyMeshCollection);if(!t.length)return;n=t[0]}const r=this._morphologyMeshCollection[n].getTargetPoint();this._camera.position.set(r.x,r.y,r.z-e),this._camera.lookAt(r),this._controls.target.copy(r),this._render()}focusOnMesh(t){const e=this._meshCollection[t].geometry.boundingSphere;this._camera.position.set(e.center.x-3*e.radius,e.center.y,e.center.z),this._camera.lookAt(e.center),this._controls.target.copy(e.center),this._render()}getSnapshotData(){return this._renderer.domElement.toDataURL("image/png")}showMesh(t){t in this._meshCollection&&(this._meshCollection[t].material.visible=!0,this._render())}hideMesh(t){t in this._meshCollection&&(this._meshCollection[t].material.visible=!1,this._render())}destroy(){this._controls.dispose(),cancelAnimationFrame(this._requestFrameId),this._camera=null,this._controls=null,this._scene=null,this._morphologyMeshCollection=null,this._meshCollection=null,this._renderer.domElement.remove(),this._renderer=null}}function p(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new v,this.unassigned=new v,this.vertices=[]}function m(){this.normal=new r.L,this.midpoint=new r.L,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}function g(t,e){this.vertex=t,this.prev=null,this.next=null,this.twin=null,this.face=e}function _(t){this.point=t,this.prev=null,this.next=null,this.face=null}function v(){this.head=null,this.tail=null}function w(t){r.n.call(this),this.fromBufferGeometry(new y(t)),this.mergeVertices()}function y(t){r.d.call(this);const e=[],n=[];void 0===p&&console.error("THREE.ConvexBufferGeometry: ConvexBufferGeometry relies on THREE.QuickHull");const i=(new p).setFromPoints(t).faces;for(let r=0;r<i.length;r++){const t=i[r];let o=t.edge;do{const r=o.head().point;e.push(r.x,r.y,r.z),n.push(t.normal.x,t.normal.y,t.normal.z),o=o.next}while(o!==t.edge)}this.addAttribute("position",new r.l(e,3)),this.addAttribute("normal",new r.l(n,3))}Object.assign(p.prototype,{setFromPoints(t){!0!==Array.isArray(t)&&console.error("THREE.QuickHull: Points parameter is not an array."),t.length<4&&console.error("THREE.QuickHull: The algorithm needs at least four points."),this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.vertices.push(new _(t[e]));return this.compute(),this},setFromObject(t){const e=[];return t.updateMatrixWorld(!0),t.traverse((t=>{let n,i,o;const a=t.geometry;if(void 0!==a)if(a.isGeometry){const r=a.vertices;for(n=0,i=r.length;n<i;n++)o=r[n].clone(),o.applyMatrix4(t.matrixWorld),e.push(o)}else if(a.isBufferGeometry){const s=a.attributes.position;if(void 0!==s)for(n=0,i=s.count;n<i;n++)o=new r.L,o.fromBufferAttribute(s,n).applyMatrix4(t.matrixWorld),e.push(o)}})),this.setFromPoints(e)},makeEmpty(){return this.faces=[],this.vertices=[],this},addVertexToFace(t,e){return t.face=e,null===e.outside?this.assigned.append(t):this.assigned.insertBefore(e.outside,t),e.outside=t,this},removeVertexFromFace(t,e){return t===e.outside&&(null!==t.next&&t.next.face===e?e.outside=t.next:e.outside=null),this.assigned.remove(t),this},removeAllVerticesFromFace(t){if(null!==t.outside){const e=t.outside;let n=t.outside;for(;null!==n.next&&n.next.face===t;)n=n.next;return this.assigned.removeSubList(e,n),e.prev=n.next=null,t.outside=null,e}},deleteFaceVertices(t,e){const n=this.removeAllVerticesFromFace(t);if(void 0!==n)if(void 0===e)this.unassigned.appendChain(n);else{let t=n;do{const n=t.next;e.distanceToPoint(t.point)>this.tolerance?this.addVertexToFace(t,e):this.unassigned.append(t),t=n}while(null!==t)}return this},resolveUnassignedPoints(t){if(!1===this.unassigned.isEmpty()){let e=this.unassigned.first();do{const n=e.next;let r=this.tolerance,i=null;for(let o=0;o<t.length;o++){const n=t[o];if(0===n.mark){const t=n.distanceToPoint(e.point);if(t>r&&(r=t,i=n),r>1e3*this.tolerance)break}}null!==i&&this.addVertexToFace(e,i),e=n}while(null!==e)}return this},computeExtremes(){const t=new r.L,e=new r.L,n=[],i=[];let o,a,s;for(o=0;o<3;o++)n[o]=i[o]=this.vertices[0];for(t.copy(this.vertices[0].point),e.copy(this.vertices[0].point),o=0,a=this.vertices.length;o<a;o++){const r=this.vertices[o],a=r.point;for(s=0;s<3;s++)a.getComponent(s)<t.getComponent(s)&&(t.setComponent(s,a.getComponent(s)),n[s]=r);for(s=0;s<3;s++)a.getComponent(s)>e.getComponent(s)&&(e.setComponent(s,a.getComponent(s)),i[s]=r)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(t.x),Math.abs(e.x))+Math.max(Math.abs(t.y),Math.abs(e.y))+Math.max(Math.abs(t.z),Math.abs(e.z))),{min:n,max:i}},computeInitialHull:function(){let t,e,n;return function(){let i;void 0===t&&(t=new r.p,e=new r.A,n=new r.L);const o=this.vertices,a=this.computeExtremes(),s=a.min,l=a.max;let h,u,c,d,f,p,g,_,v=0,w=0;for(f=0;f<3;f++)_=l[f].point.getComponent(f)-s[f].point.getComponent(f),_>v&&(v=_,w=f);for(h=s[w],u=l[w],v=0,t.set(h.point,u.point),f=0,p=this.vertices.length;f<p;f++)i=o[f],i!==h&&i!==u&&(t.closestPointToPoint(i.point,!0,n),_=n.distanceToSquared(i.point),_>v&&(v=_,c=i));for(v=-1,e.setFromCoplanarPoints(h.point,u.point,c.point),f=0,p=this.vertices.length;f<p;f++)i=o[f],i!==h&&i!==u&&i!==c&&(_=Math.abs(e.distanceToPoint(i.point)),_>v&&(v=_,d=i));const y=[];if(e.distanceToPoint(d.point)<0)for(y.push(m.create(h,u,c),m.create(d,u,h),m.create(d,c,u),m.create(d,h,c)),f=0;f<3;f++)g=(f+1)%3,y[f+1].getEdge(2).setTwin(y[0].getEdge(g)),y[f+1].getEdge(1).setTwin(y[g+1].getEdge(0));else for(y.push(m.create(h,c,u),m.create(d,h,u),m.create(d,u,c),m.create(d,c,h)),f=0;f<3;f++)g=(f+1)%3,y[f+1].getEdge(2).setTwin(y[0].getEdge((3-f)%3)),y[f+1].getEdge(0).setTwin(y[g+1].getEdge(1));for(f=0;f<4;f++)this.faces.push(y[f]);for(f=0,p=o.length;f<p;f++)if(i=o[f],i!==h&&i!==u&&i!==c&&i!==d){v=this.tolerance;let t=null;for(g=0;g<4;g++)_=this.faces[g].distanceToPoint(i.point),_>v&&(v=_,t=this.faces[g]);null!==t&&this.addVertexToFace(i,t)}return this}}(),reindexFaces(){const t=[];for(let e=0;e<this.faces.length;e++){const n=this.faces[e];0===n.mark&&t.push(n)}return this.faces=t,this},nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let t,e=0;const n=this.assigned.first().face;let r=n.outside;do{const i=n.distanceToPoint(r.point);i>e&&(e=i,t=r),r=r.next}while(null!==r&&r.face===n);return t}},computeHorizon(t,e,n,r){let i;this.deleteFaceVertices(n),n.mark=1,i=null===e?e=n.getEdge(0):e.next;do{const e=i.twin,n=e.face;0===n.mark&&(n.distanceToPoint(t)>this.tolerance?this.computeHorizon(t,e,n,r):r.push(i)),i=i.next}while(i!==e);return this},addAdjoiningFace(t,e){const n=m.create(t,e.tail(),e.head());return this.faces.push(n),n.getEdge(-1).setTwin(e.twin),n.getEdge(0)},addNewFaces(t,e){this.newFaces=[];let n=null,r=null;for(let i=0;i<e.length;i++){const o=e[i],a=this.addAdjoiningFace(t,o);null===n?n=a:a.next.setTwin(r),this.newFaces.push(a.face),r=a}return n.next.setTwin(r),this},addVertexToHull(t){const e=[];return this.unassigned.clear(),this.removeVertexFromFace(t,t.face),this.computeHorizon(t.point,null,t.face,e),this.addNewFaces(t,e),this.resolveUnassignedPoints(this.newFaces),this},cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute(){let t;for(this.computeInitialHull();void 0!==(t=this.nextVertexToAdd());)this.addVertexToHull(t);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(m,{create(t,e,n){const r=new m,i=new g(t,r),o=new g(e,r),a=new g(n,r);return i.next=a.prev=o,o.next=i.prev=a,a.next=o.prev=i,r.edge=i,r.compute()}}),Object.assign(m.prototype,{getEdge(t){let e=this.edge;for(;t>0;)e=e.next,t--;for(;t<0;)e=e.prev,t++;return e},compute:function(){let t;return function(){void 0===t&&(t=new r.J);const e=this.edge.tail(),n=this.edge.head(),i=this.edge.next.head();return t.set(e.point,n.point,i.point),t.getNormal(this.normal),t.getMidpoint(this.midpoint),this.area=t.getArea(),this.constant=this.normal.dot(this.midpoint),this}}(),distanceToPoint(t){return this.normal.dot(t)-this.constant}}),Object.assign(g.prototype,{head(){return this.vertex},tail(){return this.prev?this.prev.vertex:null},length(){const t=this.head(),e=this.tail();return null!==e?e.point.distanceTo(t.point):-1},lengthSquared(){const t=this.head(),e=this.tail();return null!==e?e.point.distanceToSquared(t.point):-1},setTwin(t){return this.twin=t,t.twin=this,this}}),Object.assign(v.prototype,{first(){return this.head},last(){return this.tail},clear(){return this.head=this.tail=null,this},insertBefore(t,e){return e.prev=t.prev,e.next=t,null===e.prev?this.head=e:e.prev.next=e,t.prev=e,this},insertAfter(t,e){return e.prev=t,e.next=t.next,null===e.next?this.tail=e:e.next.prev=e,t.next=e,this},append(t){return null===this.head?this.head=t:this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t,this},appendChain(t){for(null===this.head?this.head=t:this.tail.next=t,t.prev=this.tail;null!==t.next;)t=t.next;return this.tail=t,this},remove(t){return null===t.prev?this.head=t.next:t.prev.next=t.next,null===t.next?this.tail=t.prev:t.next.prev=t.prev,this},removeSubList(t,e){return null===t.prev?this.head=e.next:t.prev.next=e.next,null===e.next?this.tail=t.prev:e.next.prev=t.prev,this},isEmpty(){return null===this.head}}),w.prototype=Object.create(r.n.prototype),w.prototype.constructor=w,y.prototype=Object.create(r.d.prototype),y.prototype.constructor=y;class b extends r.y{constructor(t,e){super(),this.userData.morphologyName=e.name,this._pointToTarget=null,this._morpho=t;const n=c.getOption(e,"color",null);this._sectionColors={axon:n||1118719,basal_dendrite:n||16716049,apical_dendrite:n||16007853}}_buildSomaDefault(){const t=this._morpho.getSoma(),e=t.getPoints();if(1===e.length){console.log("single point soma");const n=new r.u(new r.F(t.getRadius(),32,32),new r.w({color:5592405,transparent:!1,opacity:1}));return n.position.set(e[0][0],e[0][1],e[0][2]),n}if(3===e.length){console.log("3 points soma");const n=new r.u(new r.F(t.getRadius(),32,32),new r.w({color:5592405,transparent:!1,opacity:1}));return n.position.set(e[0][0],e[0][1],e[0][2]),n}if(e.length>1){console.log("many point soma");const n=t.getCenter(),i=new r.L(n[0],n[1],n[2]),o=new r.n;for(let t=0;t<e.length;t+=1)o.vertices.push(new r.L(e[t][0],e[t][1],e[t][2]),new r.L(e[(t+1)%e.length][0],e[(t+1)%e.length][1],e[(t+1)%e.length][2]),i),o.faces.push(new r.j(3*t,3*t+1,3*t+2));return new r.u(o,new r.v({color:5592405,transparent:!1,opacity:1,side:r.h}))}return console.warn("No soma defined"),null}_buildSomaFromOrphanSections(){const t=this._morpho.getSoma().getPoints();let e=null;try{const n=this._morpho.getNeuriteStarts().map((t=>new r.L(...t)));for(let e=0;e<t.length;e+=1)n.push(new r.L(...t[e]));const i=new y(n),o=new r.w({color:5592405,transparent:!0,opacity:.7,side:r.h});return e=new r.u(i,o),e}catch(n){return console.warn("Attempted to build a soma from orphan section points but failed. Back to the regular version."),this._buildSomaDefault()}}_buildSoma(t){this._pointToTarget=this._morpho.getSoma().getCenter();let e=null;return e="fromOrphanSections"===c.getOption(t,"somaMode",null)?this._buildSomaFromOrphanSections():this._buildSomaDefault(),e}getTargetPoint(){if(this._pointToTarget){const t=new r.L(this._pointToTarget[0],this._pointToTarget[1],this._pointToTarget[2]);return t.applyAxisAngle(new r.L(1,0,0),Math.PI),t.applyAxisAngle(new r.L(0,1,0),Math.PI),t}const t=new r.L;return this.box.getCenter(t),t}getMorphology(){return this._morpho}}class x extends b{constructor(t,e){super(t,e);const n=this._morpho.getArrayOfSections();for(let r=0;r<n.length;r+=1){const t=this._buildSection(n[r]);this.add(t)}if(this._morpho.getSoma()){const t=this._buildSoma(e);this.add(t)}this.rotateX(Math.PI),this.rotateY(Math.PI),this.box=(new r.b).setFromObject(this)}_buildSection(t){const e=new r.q({color:this._sectionColors[t.getTypename()]}),n=t.getPoints(),i=new r.n;for(let a=0;a<n.length;a+=1)i.vertices.push(new r.L(n[a][0],n[a][1],n[a][2]));const o=new r.o(i,e);return o.name=t.getId(),o.userData.sectionId=t.getId(),o.userData.typevalue=t.getTypevalue(),o.userData.typename=t.getTypename(),o}}const k={computeTangents(t){const e=t.index,n=t.attributes;if(null===e||void 0===n.position||void 0===n.normal||void 0===n.uv)return void console.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");const i=e.array,o=n.position.array,a=n.normal.array,s=n.uv.array,l=o.length/3;void 0===n.tangent&&t.addAttribute("tangent",new r.c(new Float32Array(4*l),4));const h=n.tangent.array,u=[],c=[];for(var d=0;d<l;d++)u[d]=new r.L,c[d]=new r.L;const f=new r.L,p=new r.L,m=new r.L,g=new r.K,_=new r.K,v=new r.K,w=new r.L,y=new r.L;function b(t,e,n){f.fromArray(o,3*t),p.fromArray(o,3*e),m.fromArray(o,3*n),g.fromArray(s,2*t),_.fromArray(s,2*e),v.fromArray(s,2*n);const r=p.x-f.x,i=m.x-f.x,a=p.y-f.y,l=m.y-f.y,h=p.z-f.z,d=m.z-f.z,b=_.x-g.x,x=v.x-g.x,k=_.y-g.y,S=v.y-g.y,M=1/(b*S-x*k);w.set((S*r-k*i)*M,(S*a-k*l)*M,(S*h-k*d)*M),y.set((b*i-x*r)*M,(b*l-x*a)*M,(b*d-x*h)*M),u[t].add(w),u[e].add(w),u[n].add(w),c[t].add(y),c[e].add(y),c[n].add(y)}let x=t.groups;0===x.length&&(x=[{start:0,count:i.length}]);d=0;for(var k=x.length;d<k;++d)for(var S=P=(N=x[d]).start,M=P+N.count;S<M;S+=3)b(i[S+0],i[S+1],i[S+2]);const A=new r.L,E=new r.L,C=new r.L,O=new r.L;let z,j,T;function F(t){C.fromArray(a,3*t),O.copy(C),j=u[t],A.copy(j),A.sub(C.multiplyScalar(C.dot(j))).normalize(),E.crossVectors(O,j),T=E.dot(c[t]),z=T<0?-1:1,h[4*t]=A.x,h[4*t+1]=A.y,h[4*t+2]=A.z,h[4*t+3]=z}for(d=0,k=x.length;d<k;++d){var N,P;for(S=P=(N=x[d]).start,M=P+N.count;S<M;S+=3)F(i[S+0]),F(i[S+1]),F(i[S+2])}},mergeBufferGeometries(t,e){const n=null!==t[0].index,i=new Set(Object.keys(t[0].attributes)),o=new Set(Object.keys(t[0].morphAttributes)),a={},s={},l=new r.d;let h=0;for(var u=0;u<t.length;++u){const r=t[u];if(n!==(null!==r.index))return null;for(var c in r.attributes){if(!i.has(c))return null;void 0===a[c]&&(a[c]=[]),a[c].push(r.attributes[c])}for(var c in r.morphAttributes){if(!o.has(c))return null;void 0===s[c]&&(s[c]=[]),s[c].push(r.morphAttributes[c])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(r.userData),e){var d;if(n)d=r.index.count;else{if(void 0===r.attributes.position)return null;d=r.attributes.position.count}l.addGroup(h,d,u),h+=d}}if(n){let e=0;const n=[];for(u=0;u<t.length;++u){const r=t[u].index;for(var f=0;f<r.count;++f)n.push(r.getX(f)+e);e+=t[u].attributes.position.count}l.setIndex(n)}for(var c in a){const t=this.mergeBufferAttributes(a[c]);if(!t)return null;l.addAttribute(c,t)}for(var c in s){const t=s[c][0].length;if(0===t)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(u=0;u<t;++u){const t=[];for(f=0;f<s[c].length;++f)t.push(s[c][f][u]);const e=this.mergeBufferAttributes(t);if(!e)return null;l.morphAttributes[c].push(e)}}return l},mergeBufferAttributes(t){let e,n,i,o=0;for(var a=0;a<t.length;++a){const r=t[a];if(r.isInterleavedBufferAttribute)return null;if(void 0===e&&(e=r.array.constructor),e!==r.array.constructor)return null;if(void 0===n&&(n=r.itemSize),n!==r.itemSize)return null;if(void 0===i&&(i=r.normalized),i!==r.normalized)return null;o+=r.array.length}const s=new e(o);let l=0;for(a=0;a<t.length;++a)s.set(t[a].array,l),l+=t[a].array.length;return new r.c(s,n,i)}};class S extends b{constructor(t,e){super(t,e),this._sectionTubeMaterials={axon:new r.w({color:this._sectionColors.axon}),basal_dendrite:new r.w({color:this._sectionColors.basal_dendrite}),apical_dendrite:new r.w({color:this._sectionColors.apical_dendrite})};const n=this._morpho.getArrayOfSections();for(let r=0;r<n.length;r+=1){const t=this._buildSection(n[r]);t&&this.add(t)}if(this._morpho.getSoma()){const t=this._buildSoma(e);this.add(t)}this.rotateX(Math.PI),this.rotateY(Math.PI),this.box=(new r.b).setFromObject(this)}_buildSection(t){console.log("section.getTypename()",t.getTypename());const e=this._sectionTubeMaterials[t.getTypename()],n=t.getPoints(),i=t.getRadiuses(),o=t.getParent(),a=o&&"soma"===o.getTypename()?1:0;if(n.length-a<2)return null;const s=[];for(let u=a;u<n.length-1;u+=1){const t=c.makeCylinder(new r.L(n[u][0],n[u][1],n[u][2]),new r.L(n[u+1][0],n[u+1][1],n[u+1][2]),i[u],i[u+1],!1);s.push(t)}const l=k.mergeBufferGeometries(s),h=new r.u(l,e);return h.name=t.getId(),h.userData.sectionId=t.getId(),h.userData.typevalue=t.getTypevalue(),h.userData.typename=t.getTypename(),h}}class M extends r.d{constructor(t,e,n=32){super(),this.type="WormBufferGeometry";const i=t.length-1,o=M.computeFrenetFrames(t);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new r.L,s=new r.L,l=new r.K;let h=new r.L;const u=[],c=[],d=[],f=[];function p(r){h=t[r];const i=o.normals[r],l=o.binormals[r];for(let t=0;t<=n;t+=1){const o=t/n*Math.PI*2,d=Math.sin(o),f=-Math.cos(o);s.x=f*i.x+d*l.x,s.y=f*i.y+d*l.y,s.z=f*i.z+d*l.z,s.normalize(),c.push(s.x,s.y,s.z),a.x=h.x+e[r]*s.x,a.y=h.y+e[r]*s.y,a.z=h.z+e[r]*s.z,u.push(a.x,a.y,a.z)}}!function(){for(let e=0;e<t.length;e+=1)p(e);(function(){for(let t=0;t<=i;t+=1)for(let e=0;e<=n;e+=1)l.x=t/i,l.y=e/n,d.push(l.x,l.y)})(),function(){for(let t=1;t<=i;t+=1)for(let e=1;e<=n;e+=1){const r=(n+1)*(t-1)+(e-1),i=(n+1)*t+(e-1),o=(n+1)*t+e,a=(n+1)*(t-1)+e;f.push(r,i,a),f.push(i,o,a)}}()}(),this.setIndex(f),this.addAttribute("position",new r.l(u,3)),this.addAttribute("normal",new r.l(c,3)),this.addAttribute("uv",new r.l(d,2))}static computeFrenetFrames(t){const e=[new r.L],n=[new r.L],i=t.map(((e,n)=>{let i=n-1,o=n+1;0===n?i=0:n===t.length-1&&(o=t.length-1);const a=t[i],s=t[o],l=new r.L;return l.copy(s).sub(a).normalize(),l})),o=new r.L,a=new r.L,s=new r.t;let l=Number.MAX_VALUE;const h=Math.abs(i[0].x),u=Math.abs(i[0].y),c=Math.abs(i[0].z);h<=l&&(l=h,o.set(1,0,0)),u<=l&&(l=u,o.set(0,1,0)),c<=l&&o.set(0,0,1),a.crossVectors(i[0],o).normalize(),e[0].crossVectors(i[0],a),n[0].crossVectors(i[0],e[0]);for(let r=1;r<t.length;r+=1){if(e[r]=e[r-1].clone(),n[r]=n[r-1].clone(),a.crossVectors(i[r-1],i[r]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(Math.max(-1,Math.min(1,i[r-1].dot(i[r]))));e[r].applyMatrix4(s.makeRotationAxis(a,t))}n[r].crossVectors(i[r],e[r])}return{tangents:i,normals:e,binormals:n}}}function A(t,e){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function E(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0]-r,s=n[1]-i,l=n[2]-o;if(0!==a||0!==s||0!==l){var h=((t[0]-r)*a+(t[1]-i)*s+(t[2]-o)*l)/(a*a+s*s+l*l);h>1?(r=n[0],i=n[1],o=n[2]):h>0&&(r+=a*h,i+=s*h,o+=l*h)}return(a=t[0]-r)*a+(s=t[1]-i)*s+(l=t[2]-o)*l}function C(t,e,n){var r=void 0!==e?e*e:1;return t=function(t,e){var n,r,i,o,a=t.length,s=new("undefined"!==typeof Uint8Array?Uint8Array:Array)(a),l=0,h=a-1,u=[],c=[];for(s[l]=s[h]=1;h;){for(r=0,n=l+1;n<h;n++)(i=E(t[n],t[l],t[h]))>r&&(o=n,r=i);r>e&&(s[o]=1,u.push(l,o,o,h)),h=u.pop(),l=u.pop()}for(n=0;n<a;n++)s[n]&&c.push(t[n]);return c}(t=n?t:function(t,e){for(var n,r=t[0],i=[r],o=1,a=t.length;o<a;o++)A(n=t[o],r)>e&&(i.push(n),r=n);return r!==n&&i.push(n),i}(t,r),r)}class O extends r.y{constructor(t,e={}){super(),this._smoothSections=new r.y,this._polylineSections=new r.y,this._polylineSimpleSections=new r.y,this._boundingSphere=null,this.add(this._polylineSections),this.add(this._smoothSections),this.add(this._polylineSimpleSections),this.userData.morphologyName=e.name,this._morpho=t,this._pointToTarget=this._morpho.getSoma().getCenter();const n=e.color?e.color:null;this._sectionColors={soma:n||8947848,axon:n||1118719,basal_dendrite:n||16716049,apical_dendrite:n||16007853};const i=100;this._sectionTubeMaterials={soma:new r.w({color:this._sectionColors.soma,transparent:!0,side:r.h,shininess:i}),axon:new r.w({color:this._sectionColors.axon,transparent:!0,side:r.h,shininess:i}),basal_dendrite:new r.w({color:this._sectionColors.basal_dendrite,transparent:!0,side:r.h,shininess:i}),apical_dendrite:new r.w({color:this._sectionColors.apical_dendrite,transparent:!0,side:r.h,shininess:i})},e.neuriteMode?this.enableMode(e.neuriteMode):this.enableMode("simple"),this._somaFromModel=this._buildSomaFromModel(),this.add(this._somaFromModel),this._somaFromOrphanSections=this._buildSomaFromOrphanSections(),this.add(this._somaFromOrphanSections),e.somaMode?this.enableSomaMode(e.somaModel):this.enableSomaMode("fromModel"),this.box=(new r.b).setFromObject(this)}get boundingSphere(){if(this._boundingSphere)return this._boundingSphere;let t=null;try{t=this._morpho.getSoma().getCenter()}catch(n){return null}const e=this._morpho.getRadiusFromSoma();return this._boundingSphere=new r.E(new r.L(...t),e),this._boundingSphere}_createTubularSections(){if(this._smoothSections.children.length>0)return;const t=this._morpho.getArrayOfSections();for(let e=0;e<t.length;e+=1){const n=this._buildWormSection(t[e]);n&&this._smoothSections.add(n)}}_createPolylineSections(){if(this._polylineSections.children.length>0)return;const t=this._morpho.getArrayOfSections();for(let e=0;e<t.length;e+=1){const n=this._buildLineSection(t[e]);n&&this._polylineSections.add(n)}}_createSimplifiedSections(){if(this._polylineSimpleSections.children.length>0)return;const t=this._morpho.getArrayOfSections();for(let e=0;e<t.length;e+=1){const n=this._buildSimpleLineSection(t[e]);n&&this._polylineSimpleSections.add(n)}}_buildSomaFromModel(){const t=this._morpho.getSoma(),e=t.getPoints(),n=new r.w({color:0,transparent:!1,opacity:1});if(1===e.length||3===e.length){const i=new r.u(new r.F(t.getRadius(),32,32),n);return i.position.set(e[0][0],e[0][1],e[0][2]),i}if(e.length>1){const t=new r.y;return t.name="somaSphereContainer",this._morpho.getArrayOfSections().filter((t=>"soma"===t.getTypename())).forEach((e=>{const i=e.getPoints(),o=e.getRadiuses();i.forEach(((e,i)=>{const a=new r.u(new r.F(o[i],32,32),n);a.position.set(e[0],e[1],e[2]),t.add(a)}))})),t}return console.warn("No soma defined"),null}_buildSomaFromOrphanSections(){const t=this._morpho.getSoma().getPoints();let e=null;try{const n=this._morpho.getNeuriteStarts().map((t=>new r.L(...t)));for(let e=0;e<t.length;e+=1)n.push(new r.L(...t[e]));const i=new y(n),o=new r.w({color:0,transparent:!1,opacity:1,side:r.h});return e=new r.u(i,o),e}catch(n){return console.warn("Attempted to build a soma from orphan section points but failed. Back to the regular version.",n.message),this._buildSomaDefault()}}getTargetPoint(){if(this._pointToTarget){const t=new r.L(this._pointToTarget[0],this._pointToTarget[1],this._pointToTarget[2]);return t.applyAxisAngle(new r.L(1,0,0),Math.PI),t.applyAxisAngle(new r.L(0,1,0),Math.PI),t}const t=new r.L;return this.box.getCenter(t),t}getMorphology(){return this._morpho}_buildWormSection(t){if("soma"===t.getTypename())return null;const e=this._sectionTubeMaterials[t.getTypename()];let n=t.getPoints(),i=t.getRadiuses();const o=t.getParent()?0:1,a=t.getParent(),s=a&&"soma"===a.getTypename();if(n.length-o<2)return null;s&&(i=[i[1]].concat(i.slice(1)));const l=n.map((t=>new r.L(t[0],t[1],t[2]))),h=new M(l,i),u=new r.u(h,e);return u.name=t.getId(),u.userData.sectionId=t.getId(),u.userData.typevalue=t.getTypevalue(),u.userData.typename=t.getTypename(),u}_buildLineSection(t){const e=new r.q({color:this._sectionColors[t.getTypename()]}),n=t.getPoints(),i=t.getParent()?0:1;if(n.length-i<2)return null;const o=new r.n;for(let s=0;s<n.length;s+=1)o.vertices.push(new r.L(n[s][0],n[s][1],n[s][2]));const a=new r.o(o,e);return a.name=t.getId(),a.userData.sectionId=t.getId(),a.userData.typevalue=t.getTypevalue(),a.userData.typename=t.getTypename(),a}_buildSimpleLineSection(t){const e=new r.q({color:this._sectionColors[t.getTypename()]}),n=C(t.getPoints(),10,!0);if(n.length<2)return null;const i=new r.n;for(let a=0;a<n.length;a+=1)i.vertices.push(new r.L(n[a][0],n[a][1],n[a][2]));const o=new r.o(i,e);return o.name=t.getId(),o.userData.sectionId=t.getId(),o.userData.typevalue=t.getTypevalue(),o.userData.typename=t.getTypename(),o}setSmoothOpacity(t){this._smoothSections.children.forEach((e=>{e.material.opacity=t}))}setSmoothVisibility(t){this._smoothSections.visible=t}setPolylineVisibility(t){this._polylineSections.visible=t}enableMode(t){this._neuriteModeName=t,"smooth"===t?(this._createTubularSections(),this._smoothSections.visible=!0,this._polylineSections.visible=!1,this._polylineSimpleSections.visible=!1):"polyline"===t||"line"===t?(this._createPolylineSections(),this._smoothSections.visible=!1,this._polylineSections.visible=!0,this._polylineSimpleSections.visible=!1):"simple"===t&&(this._createSimplifiedSections(),this._smoothSections.visible=!1,this._polylineSections.visible=!1,this._polylineSimpleSections.visible=!0)}getNeuriteModename(){return this._neuriteModeName}enableSomaMode(t){if(this._somaModeName=t,"fromOrphanSections"===t){try{this._somaFromOrphanSections.visible=!0}catch(e){}try{this._somaFromModel.visible=!1}catch(e){}}else if("fromModel"===t){try{this._somaFromOrphanSections.visible=!1}catch(e){}try{this._somaFromModel.visible=!0}catch(e){}}else if("hidden"===t){try{this._somaFromOrphanSections.visible=!1}catch(e){}try{this._somaFromModel.visible=!1}catch(e){}}}getSomaModeName(){return this._somaModeName}}var z={MorphoViewer:class{constructor(t=null){t?this._threeContext=new f(t):console.error("MorphoViewer needs a div object to display WebGL context.")}addMorphology(t,e){let n=null;e.name=c.getOption(e,"name",`morpho_${Math.round(1e6*Math.random()).toString()}`),t instanceof l.a.Morphology?n=t:(n=new l.a.Morphology,n.buildFromRawMorphology(t)),n.setId(e.name);const r=!("asPolyline"in e)||e.asPolyline;let i=null;return e.formFactor&&"hybrid"===e.formFactor?i=new O(n,e):e.formFactor&&"polyline"===e.formFactor||r?i=new x(n,e):(e.formFactor&&"tubular"===e.formFactor||!r)&&(i=new S(n,e)),this._threeContext.addMorphology(i,e),i}addStlToMeshCollection(t,e){this._threeContext.addStlToMeshCollection(t,e)}destroy(){this._threeContext.destroy()}getCameraFieldOfView(){return this._threeContext.getCameraFieldOfView()}setCameraFieldOfView(t){this._threeContext.setCameraFieldOfView(t)}focusOnMorphology(t,e){this._threeContext.focusOnMorphology(t,e)}focusOnMesh(t){this._threeContext.focusOnMesh(t)}onRaycast(t){this._threeContext.on("onRaycast",t)}takeScreenshot(t="capture.png"){const e=this._threeContext.getSnapshotData();c.triggerDownload(e,t)}addObjToMeshCollection(t,e){this._threeContext.addObjToMeshCollection(t,e)}showMesh(t){this._threeContext.showMesh(t)}hideMesh(t){this._threeContext.hideMesh(t)}}};e.default=z},"7tol":function(t,e,n){"use strict";var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=function(t,e,n,i){var o=r,a=i+n;t^=-1;for(var s=i;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},"B/RK":function(t,e,n){"use strict";var r=n("vn/o");function i(t){for(var e=t.length;--e>=0;)t[e]=0}var o=256,a=286,s=30,l=15,h=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);i(f);var p=new Array(60);i(p);var m=new Array(512);i(m);var g=new Array(256);i(g);var _=new Array(29);i(_);var v,w,y,b=new Array(s);function x(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function k(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function S(t){return t<256?m[t]:m[256+(t>>>7)]}function M(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function A(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,M(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function E(t,e,n){A(t,n[2*e],n[2*e+1])}function C(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function O(t,e,n){var r,i,o=new Array(16),a=0;for(r=1;r<=l;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=C(o[s]++,s))}}function z(t){var e;for(e=0;e<a;e++)t.dyn_ltree[2*e]=0;for(e=0;e<s;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function j(t){t.bi_valid>8?M(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function T(t,e,n,r){var i=2*e,o=2*n;return t[i]<t[o]||t[i]===t[o]&&r[e]<=r[n]}function F(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&T(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!T(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function N(t,e,n){var r,i,a,s,l=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*l]<<8|t.pending_buf[t.d_buf+2*l+1],i=t.pending_buf[t.l_buf+l],l++,0===r?E(t,i,e):(E(t,(a=g[i])+o+1,e),0!==(s=h[a])&&A(t,i-=_[a],s),E(t,a=S(--r),n),0!==(s=u[a])&&A(t,r-=b[a],s))}while(l<t.last_lit);E(t,256,e)}function P(t,e){var n,r,i,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,h=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<h;n++)0!==o[2*n]?(t.heap[++t.heap_len]=u=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=a[2*i+1]);for(e.max_code=u,n=t.heap_len>>1;n>=1;n--)F(t,o,n);i=h;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],F(t,o,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,o[2*i]=o[2*n]+o[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,o[2*n+1]=o[2*r+1]=i,t.heap[1]=i++,F(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,r,i,o,a,s,h=e.dyn_tree,u=e.max_code,c=e.stat_desc.static_tree,d=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,p=e.stat_desc.extra_base,m=e.stat_desc.max_length,g=0;for(o=0;o<=l;o++)t.bl_count[o]=0;for(h[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)(o=h[2*h[2*(r=t.heap[n])+1]+1]+1)>m&&(o=m,g++),h[2*r+1]=o,r>u||(t.bl_count[o]++,a=0,r>=p&&(a=f[r-p]),s=h[2*r],t.opt_len+=s*(o+a),d&&(t.static_len+=s*(c[2*r+1]+a)));if(0!==g){do{for(o=m-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[m]--,g-=2}while(g>0);for(o=m;0!==o;o--)for(r=t.bl_count[o];0!==r;)(i=t.heap[--n])>u||(h[2*i+1]!==o&&(t.opt_len+=(o-h[2*i+1])*h[2*i],h[2*i+1]=o),r--)}}(t,e),O(o,u,t.bl_count)}function L(t,e,n){var r,i,o=-1,a=e[1],s=0,l=7,h=4;for(0===a&&(l=138,h=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=e[2*(r+1)+1],++s<l&&i===a||(s<h?t.bl_tree[2*i]+=s:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,o=i,0===a?(l=138,h=3):i===a?(l=6,h=3):(l=7,h=4))}function D(t,e,n){var r,i,o=-1,a=e[1],s=0,l=7,h=4;for(0===a&&(l=138,h=3),r=0;r<=n;r++)if(i=a,a=e[2*(r+1)+1],!(++s<l&&i===a)){if(s<h)do{E(t,i,t.bl_tree)}while(0!==--s);else 0!==i?(i!==o&&(E(t,i,t.bl_tree),s--),E(t,16,t.bl_tree),A(t,s-3,2)):s<=10?(E(t,17,t.bl_tree),A(t,s-3,3)):(E(t,18,t.bl_tree),A(t,s-11,7));s=0,o=i,0===a?(l=138,h=3):i===a?(l=6,h=3):(l=7,h=4)}}i(b);var R=!1;function I(t,e,n,i){A(t,0+(i?1:0),3),function(t,e,n,i){j(t),i&&(M(t,n),M(t,~n)),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}e._tr_init=function(t){R||(!function(){var t,e,n,r,i,o=new Array(16);for(n=0,r=0;r<28;r++)for(_[r]=n,t=0;t<1<<h[r];t++)g[n++]=r;for(g[n-1]=r,i=0,r=0;r<16;r++)for(b[r]=i,t=0;t<1<<u[r];t++)m[i++]=r;for(i>>=7;r<s;r++)for(b[r]=i<<7,t=0;t<1<<u[r]-7;t++)m[256+i++]=r;for(e=0;e<=l;e++)o[e]=0;for(t=0;t<=143;)f[2*t+1]=8,t++,o[8]++;for(;t<=255;)f[2*t+1]=9,t++,o[9]++;for(;t<=279;)f[2*t+1]=7,t++,o[7]++;for(;t<=287;)f[2*t+1]=8,t++,o[8]++;for(O(f,287,o),t=0;t<s;t++)p[2*t+1]=5,p[2*t]=C(t,5);v=new x(f,h,257,a,l),w=new x(p,u,0,s,l),y=new x(new Array(0),c,0,19,7)}(),R=!0),t.l_desc=new k(t.dyn_ltree,v),t.d_desc=new k(t.dyn_dtree,w),t.bl_desc=new k(t.bl_tree,y),t.bi_buf=0,t.bi_valid=0,z(t)},e._tr_stored_block=I,e._tr_flush_block=function(t,e,n,r){var i,a,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<o;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),P(t,t.l_desc),P(t,t.d_desc),s=function(t){var e;for(L(t,t.dyn_ltree,t.l_desc.max_code),L(t,t.dyn_dtree,t.d_desc.max_code),P(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*d[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==e?I(t,e,n,r):4===t.strategy||a===i?(A(t,2+(r?1:0),3),N(t,f,p)):(A(t,4+(r?1:0),3),function(t,e,n,r){var i;for(A(t,e-257,5),A(t,n-1,5),A(t,r-4,4),i=0;i<r;i++)A(t,t.bl_tree[2*d[i]+1],3);D(t,t.dyn_ltree,e-1),D(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),N(t,t.dyn_ltree,t.dyn_dtree)),z(t),r&&j(t)},e._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(g[n]+o+1)]++,t.dyn_dtree[2*S(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){A(t,2,3),E(t,256,f),function(t){16===t.bi_valid?(M(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},"H+61":function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},LOvY:function(t,e,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},MPS6:function(t,e,n){"use strict";n.r(e);var r=n("nKUr"),i=n("cpVT"),o=n("xvhg"),a=n("q1tI"),s=n.n(a),l=n("2/Rp"),h=n("Womt"),u=function(t){return t._threeContext.getMorphoFromCollection=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=t;if(!e){var n=Object.keys(this._morphologyMeshCollection);if(!n.length)return;e=n[0]}var r=this._morphologyMeshCollection[e];return r},t.isInterneuron=function(){return!this._threeContext.getMorphoFromCollection().children.find((function(t){var e;return"apical_dendrite"===(null===t||void 0===t||null===(e=t.userData)||void 0===e?void 0:e.typename)}))},t._threeContext.getSomaChildren=function(){return this.getMorphoFromCollection().children.filter((function(t){return"soma"===t.userData.typename}))},t._threeContext.getOrphanedSomaChildren=function(){return this.getMorphoFromCollection().children.filter((function(t){return""===t.name}))[0]},t._threeContext.removeOrphanedSomaChildren=function(){var t=this.getMorphoFromCollection(),e=this.getOrphanedSomaChildren();t.remove(e)},t._threeContext.getTargetPointFromSoma=function(){var t=this.getMorphoFromCollection(),e=t.getTargetPoint();if(!!!t._pointToTarget){var n=t.children[t.children.length-1],r=new h.b;r.expandByObject(n),e=r.getCenter(new h.L)}return e},t._threeContext.getCameraHeightAtMorpho=function(){var t=this.getTargetPointFromSoma();this._camera.updateMatrixWorld();var e=this._camera.position.clone().distanceTo(t),n=this._camera.fov*Math.PI/180;return 2*Math.tan(n/2)*e},t._threeContext.focusOnMorphology=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getMorphoFromCollection(t),n=1,r=new h.b;r.expandByObject(e);var i=r.getSize(new h.L),o=Math.max(i.x,i.y,i.z),a=o/(2*Math.atan(Math.PI*this._camera.fov/360)),s=a/this._camera.aspect,l=n*Math.max(a,s),u=this._controls.target.clone().sub(this._camera.position).normalize().multiplyScalar(l);this._controls.maxDistance=10*l;var c=this.getTargetPointFromSoma();this._camera.lookAt(c),this._controls.target.copy(c),this._camera.near=l/100,this._camera.far=100*l,this._camera.updateProjectionMatrix(),this._camera.position.copy(this._controls.target).sub(u),this._camera.rotation.set(new h.L),this._controls.update(),this._render()},t},c=n("H+61"),d=n("UlJF"),f=function(t){for(;t.lastChild;)t.removeChild(t.lastChild)},p=function(t,e){var n=e.apparentFontSize,r=void 0===n?5:n,i=function(t,e){var n=e.fontSize,r=void 0===n?48:n,i=e.font,o=void 0===i?"monospace":i,a=e.align,s=void 0===a?"center":a,l=e.baseline,h=void 0===l?"middle":l,u=e.color,c=void 0===u?"black":u,d=document.createElement("canvas"),f=d.getContext("2d");if(f){f.font="".concat(r,"px ").concat(o);var p=f.measureText(t).width,m=r;return d.width=p,d.height=m,d.style.width=p+"px",d.style.height=m+"px",f.font="".concat(r,"px ").concat(o),f.textAlign=s,f.textBaseline=h,f.fillStyle="transparent",f.fillRect(0,0,f.canvas.width,f.canvas.height),f.fillStyle=c,f.fillText(t,p/2,m/2),d}}(t,e);if(i){var o=new h.I(i);o.magFilter=h.x,o.needsUpdate=!0;var a=new h.H({map:o}),s=new h.G(a),l=new h.y;return s.scale.set(i.width/i.height*r,r,1),s.position.set(0,1.5,0),l.add(s),l}console.warn("no canvas found when making text")},m=function(){function t(e){var n=this;Object(c.a)(this,t),this.div=e,Object(i.a)(this,"renderer",void 0),Object(i.a)(this,"scene",void 0),Object(i.a)(this,"camera",void 0),Object(i.a)(this,"orientationHelper",void 0),Object(i.a)(this,"requestedAnimationFrameID",0),Object(i.a)(this,"followCamera",null);var r=document.createElement("canvas");e.appendChild(r);var o=r.getContext("webgl2",{alpha:!0,antialias:!0});this.renderer=new h.M({canvas:r,context:o||void 0}),this.renderer.setClearColor(16777215,0),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e.clientWidth,e.clientHeight),this.scene=new h.D,this.camera=new h.z(27,e.clientWidth/e.clientHeight,1,5e4);var a=0,s=0,l=100;this.camera.lookAt(new h.L(0,0,0)),this.camera.position.x=a,this.camera.position.y=s,this.camera.position.z=l,this.scene.add(this.camera),this.orientationHelper=function(){for(var t=new h.y,e=["red","green","blue"],n=["X","Y","Z"],r=[[15,0,0],[0,0,15],[0,15,0]],i=0;i<=2;i++){var o=e[i],a=new h.L(r[i][0],r[i][1],r[i][2]),s=new h.n;s.vertices.push(a,new h.L(0,0,0));var l=new h.q({color:o,linewidth:1}),u=new h.r(s,l),c=p(n[i],{color:o}),d=a.clone().multiplyScalar(1.2);null===c||void 0===c||c.position.set(d.x,d.y,d.z),c&&t.add(c,u)}return t}(),this.scene.add(this.orientationHelper),window.addEventListener("resize",(function(){var t;null===(t=n.renderer)||void 0===t||t.setSize(e.clientWidth,e.clientHeight)})),this.animate()}return Object(d.a)(t,[{key:"setFollowCamera",value:function(t){this.followCamera=t}},{key:"animate",value:function(){this.requestedAnimationFrameID=requestAnimationFrame(this.animate.bind(this)),this.render()}},{key:"render",value:function(){var t;this.followCamera&&(null===(t=this.camera)||void 0===t||t.lookAt(this.orientationHelper.position.clone()),this.orientationHelper.rotation.copy(this.followCamera.rotation.clone()),this.orientationHelper.scale.x=-1,this.orientationHelper.scale.y=-1,this.orientationHelper.scale.z=-1);this.scene&&this.camera&&this.renderer&&this.renderer.render(this.scene,this.camera)}},{key:"destroy",value:function(){f(this.div),cancelAnimationFrame(this.requestedAnimationFrameID),this.scene=null,this.renderer=null,this.camera=null}}]),t}();function g(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function _(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}var v=Array.prototype.slice,w=function(t){return t},y=1e-6;function b(t){return"translate("+t+",0)"}function x(t){return"translate(0,"+t+")"}function k(t){return e=>+t(e)}function S(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function M(){return!this.__axis}function A(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,l="undefined"!==typeof window&&window.devicePixelRatio>1?0:.5,h=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",c=1===t||3===t?b:x;function d(d){var f=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,p=null==i?e.tickFormat?e.tickFormat.apply(e,n):w:i,m=Math.max(o,0)+s,g=e.range(),_=+g[0]+l,v=+g[g.length-1]+l,b=(e.bandwidth?S:k)(e.copy(),l),x=d.selection?d.selection():d,A=x.selectAll(".domain").data([null]),E=x.selectAll(".tick").data(f,e).order(),C=E.exit(),O=E.enter().append("g").attr("class","tick"),z=E.select("line"),j=E.select("text");A=A.merge(A.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),E=E.merge(O),z=z.merge(O.append("line").attr("stroke","currentColor").attr(u+"2",h*o)),j=j.merge(O.append("text").attr("fill","currentColor").attr(u,h*m).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),d!==x&&(A=A.transition(d),E=E.transition(d),z=z.transition(d),j=j.transition(d),C=C.transition(d).attr("opacity",y).attr("transform",(function(t){return isFinite(t=b(t))?c(t+l):this.getAttribute("transform")})),O.attr("opacity",y).attr("transform",(function(t){var e=this.parentNode.__axis;return c((e&&isFinite(e=e(t))?e:b(t))+l)}))),C.remove(),A.attr("d",4===t||2===t?a?"M"+h*a+","+_+"H"+l+"V"+v+"H"+h*a:"M"+l+","+_+"V"+v:a?"M"+_+","+h*a+"V"+l+"H"+v+"V"+h*a:"M"+_+","+l+"H"+v),E.attr("opacity",1).attr("transform",(function(t){return c(b(t)+l)})),z.attr(u+"2",h*o),j.attr(u,h*m).text(p),x.filter(M).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),x.each((function(){this.__axis=b}))}return d.scale=function(t){return arguments.length?(e=t,d):e},d.ticks=function(){return n=v.call(arguments),d},d.tickArguments=function(t){return arguments.length?(n=null==t?[]:v.call(t),d):n.slice()},d.tickValues=function(t){return arguments.length?(r=null==t?null:v.call(t),d):r&&r.slice()},d.tickFormat=function(t){return arguments.length?(i=t,d):i},d.tickSize=function(t){return arguments.length?(o=a=+t,d):o},d.tickSizeInner=function(t){return arguments.length?(o=+t,d):o},d.tickSizeOuter=function(t){return arguments.length?(a=+t,d):a},d.tickPadding=function(t){return arguments.length?(s=+t,d):s},d.offset=function(t){return arguments.length?(l=+t,d):l},d}function E(t){return A(2,t)}var C={value:()=>{}};function O(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new z(r)}function z(t){this._=t}function j(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function T(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function F(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=C,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}z.prototype=O.prototype={constructor:z,on:function(t,e){var n,r=this._,i=j(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=F(r[n],t.name,e);else if(null==e)for(n in r)r[n]=F(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=T(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new z(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var N=O;function P(){}var L=function(t){return null==t?P:function(){return this.querySelector(t)}},D=function(t){return"object"===typeof t&&"length"in t?t:Array.from(t)};function R(){return[]}var I=function(t){return null==t?R:function(){return this.querySelectorAll(t)}};var B=function(t){return function(){return this.matches(t)}};function H(t){return function(e){return e.matches(t)}}var V=Array.prototype.find;function Z(){return this.firstElementChild}var U=Array.prototype.filter;function q(){return this.children}var X=function(t){return new Array(t.length)};function Y(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Y.prototype={constructor:Y,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var K=function(t){return function(){return t}};function $(t,e,n,r,i,o){for(var a,s=0,l=e.length,h=o.length;s<h;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Y(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function W(t,e,n,r,i,o,a){var s,l,h,u=new Map,c=e.length,d=o.length,f=new Array(c);for(s=0;s<c;++s)(l=e[s])&&(f[s]=h=a.call(l,l.__data__,s,e)+"",u.has(h)?i[s]=l:u.set(h,l));for(s=0;s<d;++s)h=a.call(t,o[s],s,o)+"",(l=u.get(h))?(r[s]=l,l.__data__=o[s],u.delete(h)):n[s]=new Y(t,o[s]);for(s=0;s<c;++s)(l=e[s])&&u.get(f[s])===l&&(i[s]=l)}function G(t){return t.__data__}function Q(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var J="http://www.w3.org/1999/xhtml",tt={svg:"http://www.w3.org/2000/svg",xhtml:J,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},et=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),tt.hasOwnProperty(e)?{space:tt[e],local:t}:t};function nt(t){return function(){this.removeAttribute(t)}}function rt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function it(t,e){return function(){this.setAttribute(t,e)}}function ot(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function at(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function st(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var lt=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function ht(t){return function(){this.style.removeProperty(t)}}function ut(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ct(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function dt(t,e){return t.style.getPropertyValue(e)||lt(t).getComputedStyle(t,null).getPropertyValue(e)}function ft(t){return function(){delete this[t]}}function pt(t,e){return function(){this[t]=e}}function mt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function gt(t){return t.trim().split(/^|\s+/)}function _t(t){return t.classList||new vt(t)}function vt(t){this._node=t,this._names=gt(t.getAttribute("class")||"")}function wt(t,e){for(var n=_t(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function yt(t,e){for(var n=_t(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function bt(t){return function(){wt(this,t)}}function xt(t){return function(){yt(this,t)}}function kt(t,e){return function(){(e.apply(this,arguments)?wt:yt)(this,t)}}vt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function St(){this.textContent=""}function Mt(t){return function(){this.textContent=t}}function At(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Et(){this.innerHTML=""}function Ct(t){return function(){this.innerHTML=t}}function Ot(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function zt(){this.nextSibling&&this.parentNode.appendChild(this)}function jt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Tt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===J&&e.documentElement.namespaceURI===J?e.createElement(t):e.createElementNS(n,t)}}function Ft(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var Nt=function(t){var e=et(t);return(e.local?Ft:Tt)(e)};function Pt(){return null}function Lt(){var t=this.parentNode;t&&t.removeChild(this)}function Dt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Rt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function It(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Bt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function Ht(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function Vt(t,e,n){var r=lt(t),i=r.CustomEvent;"function"===typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Zt(t,e){return function(){return Vt(this,t,e)}}function Ut(t,e){return function(){return Vt(this,t,e.apply(this,arguments))}}var qt=[null];function Xt(t,e){this._groups=t,this._parents=e}function Yt(){return new Xt([[document.documentElement]],qt)}Xt.prototype=Yt.prototype={constructor:Xt,select:function(t){"function"!==typeof t&&(t=L(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],l=s.length,h=r[i]=new Array(l),u=0;u<l;++u)(o=s[u])&&(a=t.call(o,o.__data__,u,s))&&("__data__"in o&&(a.__data__=o.__data__),h[u]=a);return new Xt(r,this._parents)},selectAll:function(t){t="function"===typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:D(e)}}(t):I(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,h=0;h<l;++h)(a=s[h])&&(r.push(t.call(a,a.__data__,h,s)),i.push(a));return new Xt(r,i)},selectChild:function(t){return this.select(null==t?Z:function(t){return function(){return V.call(this.children,t)}}("function"===typeof t?t:H(t)))},selectChildren:function(t){return this.selectAll(null==t?q:function(t){return function(){return U.call(this.children,t)}}("function"===typeof t?t:H(t)))},filter:function(t){"function"!==typeof t&&(t=B(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],h=0;h<s;++h)(o=a[h])&&t.call(o,o.__data__,h,a)&&l.push(o);return new Xt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,G);var n=e?W:$,r=this._parents,i=this._groups;"function"!==typeof t&&(t=K(t));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),h=0;h<o;++h){var u=r[h],c=i[h],d=c.length,f=D(t.call(u,u&&u.__data__,h,r)),p=f.length,m=s[h]=new Array(p),g=a[h]=new Array(p),_=l[h]=new Array(d);n(u,c,m,g,_,f,e);for(var v,w,y=0,b=0;y<p;++y)if(v=m[y]){for(y>=b&&(b=y+1);!(w=g[b])&&++b<p;);v._next=w||null}}return(a=new Xt(a,r))._enter=s,a._exit=l,a},enter:function(){return new Xt(this._enter||this._groups.map(X),this._parents)},exit:function(){return new Xt(this._exit||this._groups.map(X),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"===typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){if(!(t instanceof Xt))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,h=e[s],u=n[s],c=h.length,d=a[s]=new Array(c),f=0;f<c;++f)(l=h[f]||u[f])&&(d[f]=l);for(;s<r;++s)a[s]=e[s];return new Xt(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Q);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,h=i[o]=new Array(l),u=0;u<l;++u)(a=s[u])&&(h[u]=a);h.sort(e)}return new Xt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=et(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?rt:nt:"function"===typeof e?n.local?st:at:n.local?ot:it)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?ht:"function"===typeof e?ct:ut)(t,e,null==n?"":n)):dt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?ft:"function"===typeof e?mt:pt)(t,e)):this.node()[t]},classed:function(t,e){var n=gt(t+"");if(arguments.length<2){for(var r=_t(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof e?kt:e?bt:xt)(n,e))},text:function(t){return arguments.length?this.each(null==t?St:("function"===typeof t?At:Mt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Et:("function"===typeof t?Ot:Ct)(t)):this.node().innerHTML},raise:function(){return this.each(zt)},lower:function(){return this.each(jt)},append:function(t){var e="function"===typeof t?t:Nt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"===typeof t?t:Nt(t),r=null==e?Pt:"function"===typeof e?e:L(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Lt)},clone:function(t){return this.select(t?Rt:Dt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=It(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?Ht:Bt,r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,h=0,u=s.length;h<u;++h)for(r=0,l=s[h];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"===typeof e?Ut:Zt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};var Kt=Yt,$t=function(t){return"string"===typeof t?new Xt([[document.querySelector(t)]],[document.documentElement]):new Xt([[t]],qt)};var Wt=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Gt(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Qt(){}var Jt=.7,te=1/Jt,ee="\\s*([+-]?\\d+)\\s*",ne="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",re="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ie=/^#([0-9a-f]{3,8})$/,oe=new RegExp("^rgb\\("+[ee,ee,ee]+"\\)$"),ae=new RegExp("^rgb\\("+[re,re,re]+"\\)$"),se=new RegExp("^rgba\\("+[ee,ee,ee,ne]+"\\)$"),le=new RegExp("^rgba\\("+[re,re,re,ne]+"\\)$"),he=new RegExp("^hsl\\("+[ne,re,re]+"\\)$"),ue=new RegExp("^hsla\\("+[ne,re,re,ne]+"\\)$"),ce={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function de(){return this.rgb().formatHex()}function fe(){return this.rgb().formatRgb()}function pe(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ie.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?me(e):3===n?new we(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ge(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ge(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=oe.exec(t))?new we(e[1],e[2],e[3],1):(e=ae.exec(t))?new we(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=se.exec(t))?ge(e[1],e[2],e[3],e[4]):(e=le.exec(t))?ge(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=he.exec(t))?ke(e[1],e[2]/100,e[3]/100,1):(e=ue.exec(t))?ke(e[1],e[2]/100,e[3]/100,e[4]):ce.hasOwnProperty(t)?me(ce[t]):"transparent"===t?new we(NaN,NaN,NaN,0):null}function me(t){return new we(t>>16&255,t>>8&255,255&t,1)}function ge(t,e,n,r){return r<=0&&(t=e=n=NaN),new we(t,e,n,r)}function _e(t){return t instanceof Qt||(t=pe(t)),t?new we((t=t.rgb()).r,t.g,t.b,t.opacity):new we}function ve(t,e,n,r){return 1===arguments.length?_e(t):new we(t,e,n,null==r?1:r)}function we(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ye(){return"#"+xe(this.r)+xe(this.g)+xe(this.b)}function be(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function xe(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ke(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Me(t,e,n,r)}function Se(t){if(t instanceof Me)return new Me(t.h,t.s,t.l,t.opacity);if(t instanceof Qt||(t=pe(t)),!t)return new Me;if(t instanceof Me)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new Me(a,s,l,t.opacity)}function Me(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Ae(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ee(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}Wt(Qt,pe,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:de,formatHex:de,formatHsl:function(){return Se(this).formatHsl()},formatRgb:fe,toString:fe}),Wt(we,ve,Gt(Qt,{brighter:function(t){return t=null==t?te:Math.pow(te,t),new we(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Jt:Math.pow(Jt,t),new we(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ye,formatHex:ye,formatRgb:be,toString:be})),Wt(Me,(function(t,e,n,r){return 1===arguments.length?Se(t):new Me(t,e,n,null==r?1:r)}),Gt(Qt,{brighter:function(t){return t=null==t?te:Math.pow(te,t),new Me(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Jt:Math.pow(Jt,t),new Me(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new we(Ae(t>=240?t-240:t+120,i,r),Ae(t,i,r),Ae(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Ce=t=>()=>t;function Oe(t,e){return function(n){return t+n*e}}function ze(t){return 1===(t=+t)?je:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ce(isNaN(e)?n:e)}}function je(t,e){var n=e-t;return n?Oe(t,n):Ce(isNaN(t)?e:t)}var Te=function t(e){var n=ze(e);function r(t,e){var r=n((t=ve(t)).r,(e=ve(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=je(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function Fe(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=ve(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}Fe((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Ee((n-r/e)*e,a,i,o,s)}})),Fe((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return Ee((n-r/e)*e,i,o,a,s)}}));var Ne=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function Pe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Le(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=qe(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}var De=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},Re=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Ie=function(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=qe(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},Be=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,He=new RegExp(Be.source,"g");var Ve,Ze,Ue=function(t,e){var n,r,i,o=Be.lastIndex=He.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=Be.exec(t))&&(r=He.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Re(n,r)})),o=He.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})},qe=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Ce(e):("number"===r?Re:"string"===r?(n=pe(e))?(e=n,Te):Ue:e instanceof pe?Te:e instanceof Date?De:Pe(e)?Ne:Array.isArray(e)?Le:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Ie:Re)(t,e)},Xe=0,Ye=0,Ke=0,$e=0,We=0,Ge=0,Qe="object"===typeof performance&&performance.now?performance:Date,Je="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function tn(){return We||(Je(en),We=Qe.now()+Ge)}function en(){We=0}function nn(){this._call=this._time=this._next=null}function rn(t,e,n){var r=new nn;return r.restart(t,e,n),r}function on(){We=($e=Qe.now())+Ge,Xe=Ye=0;try{!function(){tn(),++Xe;for(var t,e=Ve;e;)(t=We-e._time)>=0&&e._call.call(null,t),e=e._next;--Xe}()}finally{Xe=0,function(){var t,e,n=Ve,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ve=e);Ze=t,sn(r)}(),We=0}}function an(){var t=Qe.now(),e=t-$e;e>1e3&&(Ge-=e,$e=t)}function sn(t){Xe||(Ye&&(Ye=clearTimeout(Ye)),t-We>24?(t<1/0&&(Ye=setTimeout(on,t-Qe.now()-Ge)),Ke&&(Ke=clearInterval(Ke))):(Ke||($e=Qe.now(),Ke=setInterval(an,1e3)),Xe=1,Je(on)))}nn.prototype=rn.prototype={constructor:nn,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?tn():+n)+(null==e?0:+e),this._next||Ze===this||(Ze?Ze._next=this:Ve=this,Ze=this),this._call=t,this._time=n,sn()},stop:function(){this._call&&(this._call=null,this._time=1/0,sn())}};var ln=function(t,e,n){var r=new nn;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r},hn=N("start","end","cancel","interrupt"),un=[],cn=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(o){var h,u,c,d;if(1!==n.state)return l();for(h in i)if((d=i[h]).name===n.name){if(3===d.state)return ln(a);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[h]):+h<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[h])}if(ln((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(o))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(c=n.tween.length),h=0,u=-1;h<c;++h)(d=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=rn(o,0,n.time)}(t,n,{name:e,index:r,group:i,on:hn,tween:un,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function dn(t,e){var n=pn(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function fn(t,e){var n=pn(t,e);if(n.state>3)throw new Error("too late; already running");return n}function pn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var mn,gn=function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}},_n=180/Math.PI,vn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},wn=function(t,e,n,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*_n,skewX:Math.atan(l)*_n,scaleX:a,scaleY:s}};function yn(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:Re(t,i)},{i:l-2,x:Re(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Re(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Re(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Re(t,n)},{i:s-2,x:Re(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var bn=yn((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?vn:wn(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),xn=yn((function(t){return null==t?vn:(mn||(mn=document.createElementNS("http://www.w3.org/2000/svg","g")),mn.setAttribute("transform",t),(t=mn.transform.baseVal.consolidate())?(t=t.matrix,wn(t.a,t.b,t.c,t.d,t.e,t.f)):vn)}),", ",")",")");function kn(t,e){var n,r;return function(){var i=fn(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function Sn(t,e,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var o=fn(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},l=0,h=i.length;l<h;++l)if(i[l].name===e){i[l]=s;break}l===h&&i.push(s)}o.tween=i}}function Mn(t,e,n){var r=t._id;return t.each((function(){var t=fn(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return pn(t,r).value[e]}}var An=function(t,e){var n;return("number"===typeof e?Re:e instanceof pe?Te:(n=pe(e))?(e=n,Te):Ue)(t,e)};function En(t){return function(){this.removeAttribute(t)}}function Cn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function On(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function zn(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function jn(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function Tn(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function Fn(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Nn(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Pn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Nn(t,i)),n}return i._value=e,i}function Ln(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Fn(t,i)),n}return i._value=e,i}function Dn(t,e){return function(){dn(this,t).delay=+e.apply(this,arguments)}}function Rn(t,e){return e=+e,function(){dn(this,t).delay=e}}function In(t,e){return function(){fn(this,t).duration=+e.apply(this,arguments)}}function Bn(t,e){return e=+e,function(){fn(this,t).duration=e}}function Hn(t,e){if("function"!==typeof e)throw new Error;return function(){fn(this,t).ease=e}}function Vn(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?dn:fn;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var Zn=Kt.prototype.constructor;function Un(t){return function(){this.style.removeProperty(t)}}function qn(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Xn(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&qn(t,o,n)),r}return o._value=e,o}function Yn(t){return function(e){this.textContent=t.call(this,e)}}function Kn(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Yn(r)),e}return r._value=t,r}var $n=0;function Wn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Gn(){return++$n}var Qn=Kt.prototype;Wn.prototype=function(t){return Kt().transition(t)}.prototype={constructor:Wn,select:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=L(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,h=r[a],u=h.length,c=o[a]=new Array(u),d=0;d<u;++d)(s=h[d])&&(l=t.call(s,s.__data__,d,h))&&("__data__"in s&&(l.__data__=s.__data__),c[d]=l,cn(c[d],e,n,d,c,pn(s,n)));return new Wn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=I(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,h=r[s],u=h.length,c=0;c<u;++c)if(l=h[c]){for(var d,f=t.call(l,l.__data__,c,h),p=pn(l,n),m=0,g=f.length;m<g;++m)(d=f[m])&&cn(d,e,n,m,f,p);o.push(f),a.push(l)}return new Wn(o,a,e,n)},filter:function(t){"function"!==typeof t&&(t=B(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],h=0;h<s;++h)(o=a[h])&&t.call(o,o.__data__,h,a)&&l.push(o);return new Wn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,h=e[s],u=n[s],c=h.length,d=a[s]=new Array(c),f=0;f<c;++f)(l=h[f]||u[f])&&(d[f]=l);for(;s<r;++s)a[s]=e[s];return new Wn(a,this._parents,this._name,this._id)},selection:function(){return new Zn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Gn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,h=0;h<l;++h)if(a=s[h]){var u=pn(a,e);cn(a,t,n,h,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Wn(r,this._parents,t,n)},call:Qn.call,nodes:Qn.nodes,node:Qn.node,size:Qn.size,empty:Qn.empty,each:Qn.each,on:function(t,e){var n=this._id;return arguments.length<2?pn(this.node(),n).on.on(t):this.each(Vn(n,t,e))},attr:function(t,e){var n=et(t),r="transform"===n?xn:An;return this.attrTween(t,"function"===typeof e?(n.local?Tn:jn)(n,r,Mn(this,"attr."+t,e)):null==e?(n.local?Cn:En)(n):(n.local?zn:On)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!==typeof e)throw new Error;var r=et(t);return this.tween(n,(r.local?Pn:Ln)(r,e))},style:function(t,e,n){var r="transform"===(t+="")?bn:An;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=dt(this,t),a=(this.style.removeProperty(t),dt(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,Un(t)):"function"===typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=dt(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=dt(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,s))}}(t,r,Mn(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var l=fn(this,t),h=l.on,u=null==l.value[a]?o||(o=Un(e)):void 0;h===n&&i===u||(r=(n=h).copy()).on(s,i=u),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=dt(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!==typeof e)throw new Error;return this.tween(r,Xn(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"===typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Mn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!==typeof t)throw new Error;return this.tween(e,Kn(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=pn(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?kn:Sn)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?Dn:Rn)(e,t)):pn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?In:Bn)(e,t)):pn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Hn(e,t)):pn(this.node(),e).ease},easeVarying:function(t){if("function"!==typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!==typeof n)throw new Error;fn(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0===--i&&o()}};n.each((function(){var n=fn(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:Qn[Symbol.iterator]};var Jn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function tr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Kt.prototype.interrupt=function(t){return this.each((function(){gn(this,t)}))},Kt.prototype.transition=function(t){var e,n;t instanceof Wn?(e=t._id,t=t._name):(e=Gn(),(n=Jn).time=tn(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,h=0;h<l;++h)(a=s[h])&&cn(a,t,e,h,s,n||tr(a,e));return new Wn(r,this._parents,t,e)};const{abs:er,max:nr,min:rr}=Math;function ir(t){return[+t[0],+t[1]]}function or(t){return[ir(t[0]),ir(t[1])]}["w","e"].map(ar),["n","s"].map(ar),["n","w","e","s","nw","ne","sw","se"].map(ar);function ar(t){return{type:t}}var sr=Math.sqrt(50),lr=Math.sqrt(10),hr=Math.sqrt(2);function ur(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=sr?10:o>=lr?5:o>=hr?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=sr?10:o>=lr?5:o>=hr?2:1)}var cr=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},dr=function(t){let e=t,n=t;function r(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>cr(t(e),n)}(t)),{left:r,center:function(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const a=r(t,n,i,o-1);return a>i&&e(t[a-1],n)>-e(t[a],n)?a-1:a},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}}};const fr=dr(cr),pr=fr.right;fr.left,dr((function(t){return null===t?NaN:+t})).center;var mr=pr,gr=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}};function _r(t){return+t}var vr=[0,1];function wr(t){return t}function yr(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function br(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=yr(i,r),o=n(a,o)):(r=yr(r,i),o=n(o,a)),function(t){return o(r(t))}}function xr(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=yr(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=mr(t,e,1,r)-1;return o[n](i[n](e))}}function kr(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Sr(){var t,e,n,r,i,o,a=vr,s=vr,l=qe,h=wr;function u(){var t=Math.min(a.length,s.length);return h!==wr&&(h=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(a[0],a[t-1])),r=t>2?xr:br,i=o=null,c}function c(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,l)))(t(h(e)))}return c.invert=function(n){return h(e((o||(o=r(s,a.map(t),Re)))(n)))},c.domain=function(t){return arguments.length?(a=Array.from(t,_r),u()):a.slice()},c.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},c.rangeRound=function(t){return s=Array.from(t),l=gr,u()},c.clamp=function(t){return arguments.length?(h=!!t||wr,u()):h!==wr},c.interpolate=function(t){return arguments.length?(l=t,u()):l},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,r){return t=n,e=r,u()}}function Mr(){return Sr()(wr,wr)}function Ar(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var Er=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Cr(t){if(!(e=Er.exec(t)))throw new Error("invalid format: "+t);var e;return new Or({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Or(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}Cr.prototype=Or.prototype,Or.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};function zr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}var jr,Tr,Fr,Nr,Pr=function(t){return(t=zr(Math.abs(t)))?t[1]:NaN},Lr=function(t,e){var n=zr(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Dr={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Lr(100*t,e),r:Lr,s:function(t,e){var n=zr(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(jr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+zr(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)},Rr=function(t){return t},Ir=Array.prototype.map,Br=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];Tr=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Rr:(e=Ir.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Rr:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Ir.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"\u2212":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=Cr(t)).fill,n=t.align,c=t.sign,d=t.symbol,f=t.zero,p=t.width,m=t.comma,g=t.precision,_=t.trim,v=t.type;"n"===v?(m=!0,v="g"):Dr[v]||(void 0===g&&(g=12),_=!0,v="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var w="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",y="$"===d?o:/[%p]/.test(v)?l:"",b=Dr[v],x=/[defgprs%]/.test(v);function k(t){var i,o,l,d=w,k=y;if("c"===v)k=b(t)+k,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:b(Math.abs(t),g),_&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0===+t&&"+"!==c&&(S=!1),d=(S?"("===c?c:h:"-"===c||"("===c?"":c)+d,k=("s"===v?Br[8+jr/3]:"")+k+(S&&"("===c?")":""),x)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){k=(46===l?a+t.slice(i+1):t.slice(i))+k,t=t.slice(0,i);break}}m&&!f&&(t=r(t,1/0));var M=d.length+t.length+k.length,A=M<p?new Array(p-M+1).join(e):"";switch(m&&f&&(t=r(A+t,A.length?p-k.length:1/0),A=""),n){case"<":t=d+t+k+A;break;case"=":t=d+A+t+k;break;case"^":t=A.slice(0,M=A.length>>1)+d+t+k+A.slice(M);break;default:t=A+d+t+k}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:c,formatPrefix:function(t,e){var n=c(((t=Cr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Pr(e)/3))),i=Math.pow(10,-r),o=Br[8+r/3];return function(t){return n(i*t)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),Fr=Tr.format,Nr=Tr.formatPrefix;function Hr(t,e,n,r){var i,o=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=sr?i*=10:o>=lr?i*=5:o>=hr&&(i*=2),e<t?-i:i}(t,e,n);switch((r=Cr(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Pr(e)/3)))-Pr(Math.abs(t)))}(o,a))||(r.precision=i),Nr(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Pr(e)-Pr(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Pr(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return Fr(r)}function Vr(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=ur(t,e,n))||!isFinite(a))return[];if(a>0){let n=Math.round(t/a),r=Math.round(e/a);for(n*a<t&&++n,r*a>e&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)*a}else{a=-a;let n=Math.round(t*a),r=Math.round(e*a);for(n/a<t&&++n,r/a>e&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)/a}return r&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Hr(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),a=0,s=o.length-1,l=o[a],h=o[s],u=10;for(h<l&&(i=l,l=h,h=i,i=a,a=s,s=i);u-- >0;){if((i=ur(l,h,n))===r)return o[a]=l,o[s]=h,e(o);if(i>0)l=Math.floor(l/i)*i,h=Math.ceil(h/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,h=Math.floor(h*i)/i}r=i}return t},t}function Zr(){var t=Mr();return t.copy=function(){return kr(t,Zr())},Ar.apply(t,arguments),Vr(t)}function Ur(t){return((t=Math.exp(t))+1/t)/2}(function t(e,n,r){function i(t,i){var o,a,s=t[0],l=t[1],h=t[2],u=i[0],c=i[1],d=i[2],f=u-s,p=c-l,m=f*f+p*p;if(m<1e-12)a=Math.log(d/h)/e,o=function(t){return[s+t*f,l+t*p,h*Math.exp(e*t*a)]};else{var g=Math.sqrt(m),_=(d*d-h*h+r*m)/(2*h*n*g),v=(d*d-h*h-r*m)/(2*d*n*g),w=Math.log(Math.sqrt(_*_+1)-_),y=Math.log(Math.sqrt(v*v+1)-v);a=(y-w)/e,o=function(t){var r,i=t*a,o=Ur(w),u=h/(n*g)*(o*(r=e*i+w,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(w));return[s+u*f,l+u*p,h*o/Ur(e*i+w)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i})(Math.SQRT2,2,4);function qr(t,e,n){this.k=t,this.x=e,this.y=n}qr.prototype={constructor:qr,scale:function(t){return 1===t?this:new qr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new qr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new qr(1,0,0);qr.prototype;var Xr=function(){function t(e,n){Object(c.a)(this,t),this.div=e,Object(i.a)(this,"svg",void 0),Object(i.a)(this,"scale",void 0),Object(i.a)(this,"axis",void 0);var r=e,o=r.clientWidth,a=r.clientHeight,s=20,l=20,h=[0,n];this.svg=$t(e).append("svg").attr("width",o).attr("height",a),this.scale=Zr().range([a-s,l]).domain([_(h)||0,g(h)||n]),this.axis=E(this.scale),this.svg.append("g").call(this.axis),this.onScaleChange(n)}return Object(d.a)(t,[{key:"onScaleChange",value:function(t){this.scale.domain([0,t]),this.svg.call(E(this.scale).tickFormat((function(t){return"".concat(t," \u03bcm")})))}},{key:"destroy",value:function(){this.svg.remove(),f(this.div)}}]),t}(),Yr=function(t){var e=t.isInterneuron,n=t.hasApproximatedSoma;return Object(r.jsx)("div",{className:"morpho-legend",children:Object(r.jsxs)("ul",{children:[Object(r.jsxs)("li",{className:"soma",children:["Soma ",n&&"(Approximated)"]}),Object(r.jsx)("li",{className:"axon",children:"Axon"}),e?Object(r.jsx)("li",{className:"basal-dendrites",children:"Dendrites"}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("li",{className:"basal-dendrites",children:"Basal Dendrites"}),Object(r.jsx)("li",{className:"apical-dendrites",children:"Apical Dendrites"})]})]})})};function Kr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var $r=n("6PBO").default,Wr=n("kEIc").default,Gr=function(t){var e=t.data,n=t.options,a=s.a.useRef(null),l=s.a.useRef(null),h=s.a.useRef(null),c=s.a.useState(null),d=Object(o.a)(c,2),f=d[0],p=d[1],g=s.a.useState(null),_=Object(o.a)(g,2),v=_[0],w=_[1],y=s.a.useState(null),b=Object(o.a)(y,2),x=b[0],k=b[1];s.a.useEffect((function(){if(f){if(!f.hasSomaData){var t=f._threeContext.getOrphanedSomaChildren();null===t||void 0===t||t.material.color.setHex(0)}f.hasSomaData&&!n.asPolyline&&(f._threeContext.removeOrphanedSomaChildren(),f._threeContext.getSomaChildren().forEach((function(t){null===t||void 0===t||t.material.color.setHex(0)})),f._threeContext._render())}}),[f&&f._threeContext]),s.a.useEffect((function(){var t;if(a.current){try{var r=new Wr.SwcParser;r.parse(e);var o=r.getRawMorphology(),s=o.soma.points.length>1;(t=u(new $r.MorphoViewer(a.current))).hasSomaData=s,t._threeContext._camera.up.negate(),p(t);var l=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kr(Object(n),!0).forEach((function(e){Object(i.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"morphology"},n);t.addMorphology(o,l)}catch(h){throw new Error("Morphology parsing error: ".concat(h.message))}return function(){t&&t.destroy()}}}),[a,e,n]),s.a.useEffect((function(){if(l.current)return v||w(new m(l.current)),f&&v&&v.setFollowCamera(f._threeContext._camera),function(){null===v||void 0===v||v.destroy(),w(null)}}),[l,f,n]),s.a.useEffect((function(){var t=null;if(h.current)return x||k(new Xr(h.current,0)),f&&x&&(x.onScaleChange(f._threeContext.getCameraHeightAtMorpho()),t=function(){x.onScaleChange(f._threeContext.getCameraHeightAtMorpho())},f._threeContext._controls.addEventListener("change",t)),function(){var e,n;null===x||void 0===x||x.destroy(),k(null),null===f||void 0===f||null===(e=f._threeContext)||void 0===e||null===(n=e._controls)||void 0===n||n.removeEventListener("change",t)}}),[h,f,n]);var S=function(){null===f||void 0===f||f._threeContext._controls.reset(),null===f||void 0===f||f._threeContext._camera.up.negate(),null===f||void 0===f||f._threeContext.focusOnMorphology()};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Yr,{isInterneuron:!(null===f||void 0===f||!f.isInterneuron()),hasApproximatedSoma:!(null!==f&&void 0!==f&&f.hasSomaData)}),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"morpho-viewer",ref:a}),Object(r.jsx)("div",{className:"scale",ref:h,onClick:S}),Object(r.jsx)("div",{className:"orientation",ref:l,onClick:S})]})]})},Qr=function(t){var e=t.loading,n=t.error,i=t.data,o=t.options,a=t.onPolylineClick;return Object(r.jsxs)("div",{className:e?"morpho-wrapper loading":"morpho-wrapper",children:[Object(r.jsx)("div",{className:"actions",children:Object(r.jsx)(l.a,{size:"small",disabled:e,onClick:a,children:o.asPolyline?"Show as Geometry":"Show as Lines"})}),n&&Object(r.jsx)("p",{children:n.message}),i&&!n&&Object(r.jsx)(Gr,{data:i,options:o})]})};function Jr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ti(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jr(Object(n),!0).forEach((function(e){Object(i.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.default=function(t){var e=t.path,n=s.a.useState({loading:!0,error:null,data:null}),i=Object(o.a)(n,2),a=i[0],l=a.loading,h=a.error,u=a.data,c=i[1],d=s.a.useState({asPolyline:!1,focusOn:!0,somaMode:"fromOrphanSections"}),f=Object(o.a)(d,2),p=f[0],m=f[1];s.a.useEffect((function(){fetch(e).then((function(t){return t.text()})).then((function(t){return c({data:t,error:null,loading:!1})})).catch((function(t){return c({error:t,data:null,loading:!1})}))}),[e]);return Object(r.jsx)(Qr,ti({},{loading:l,error:h,data:u,options:p,onPolylineClick:function(){m(ti(ti({},p),{},{asPolyline:!p.asPolyline}))}}))}},"Q/xN":function(t,e){function n(t,e){return t>0?t-1:t+e}t.exports=function(t){"string"!==typeof buf&&(t=t.toString());for(var e=t.trim().split("\n"),r=[],i=[],o=[],a=[],s=[],l=[],h=null,u=0;u<e.length;u++){var c=e[u];if("#"!==c[0]){var d=c.trim().replace(/ +/g," ").split(" ");switch(d[0]){case"o":h=d.slice(1).join(" ");break;case"v":var f=d.slice(1).map(Number).slice(0,3);r.push(f);break;case"vt":var p=d.slice(1).map(Number);o.push(p);break;case"vn":var m=d.slice(1).map(Number);a.push(m);break;case"f":var g=[],_=[],v=[];d.slice(1).forEach((function(t){var e=t.split("/").map((function(t){return""===t?NaN:Number(t)}));g.push(n(e[0],r.length)),e.length>1&&(isNaN(e[1])||_.push(n(e[1],o.length)),isNaN(e[2])||v.push(n(e[2],a.length)))})),i.push(g),_.length>0&&s.push(_),v.length>0&&l.push(v)}}}var w={positions:r,cells:i};return o.length>0&&(w.vertexUVs=o),s.length>0&&(w.faceUVs=s),a.length>0&&(w.vertexNormals=a),l.length>0&&(w.faceNormals=l),null!==h&&(w.name=h),w}},QSbz:function(t,e,n){"use strict";var r=n("oXfm"),i=n("vn/o"),o=n("eydS"),a=n("Tcbo"),s=n("iTZm"),l=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(a[n]);if(e.header&&r.deflateSetHeader(this.strm,e.header),e.dictionary){var u;if(u="string"===typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=r.deflateSetDictionary(this.strm,u)))throw new Error(a[n]);this._dict_set=!0}}function u(t,e){var n=new h(e);if(n.push(t,!0),n.err)throw n.msg||a[n.err];return n.result}h.prototype.push=function(t,e){var n,a,s=this.strm,h=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"===typeof t?s.input=o.string2buf(t):"[object ArrayBuffer]"===l.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(h),s.next_out=0,s.avail_out=h),1!==(n=r.deflate(s,a))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===a?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==a||(this.onEnd(0),s.avail_out=0,!0)},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=h,e.deflate=u,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,u(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,u(t,e)}},Tcbo:function(t,e,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},UlJF:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},aFNf:function(t,e,n){"use strict";var r=n("vn/o"),i=15,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,n,h,u,c,d,f){var p,m,g,_,v,w,y,b,x,k=f.bits,S=0,M=0,A=0,E=0,C=0,O=0,z=0,j=0,T=0,F=0,N=null,P=0,L=new r.Buf16(16),D=new r.Buf16(16),R=null,I=0;for(S=0;S<=i;S++)L[S]=0;for(M=0;M<h;M++)L[e[n+M]]++;for(C=k,E=i;E>=1&&0===L[E];E--);if(C>E&&(C=E),0===E)return u[c++]=20971520,u[c++]=20971520,f.bits=1,0;for(A=1;A<E&&0===L[A];A++);for(C<A&&(C=A),j=1,S=1;S<=i;S++)if(j<<=1,(j-=L[S])<0)return-1;if(j>0&&(0===t||1!==E))return-1;for(D[1]=0,S=1;S<i;S++)D[S+1]=D[S]+L[S];for(M=0;M<h;M++)0!==e[n+M]&&(d[D[e[n+M]]++]=M);if(0===t?(N=R=d,w=19):1===t?(N=o,P-=257,R=a,I-=257,w=256):(N=s,R=l,w=-1),F=0,M=0,S=A,v=c,O=C,z=0,g=-1,_=(T=1<<C)-1,1===t&&T>852||2===t&&T>592)return 1;for(;;){y=S-z,d[M]<w?(b=0,x=d[M]):d[M]>w?(b=R[I+d[M]],x=N[P+d[M]]):(b=96,x=0),p=1<<S-z,A=m=1<<O;do{u[v+(F>>z)+(m-=p)]=y<<24|b<<16|x|0}while(0!==m);for(p=1<<S-1;F&p;)p>>=1;if(0!==p?(F&=p-1,F+=p):F=0,M++,0===--L[S]){if(S===E)break;S=e[n+d[M]]}if(S>C&&(F&_)!==g){for(0===z&&(z=C),v+=A,j=1<<(O=S-z);O+z<E&&!((j-=L[O+z])<=0);)O++,j<<=1;if(T+=1<<O,1===t&&T>852||2===t&&T>592)return 1;u[g=F&_]=C<<24|O<<16|v-c|0}}return 0!==F&&(u[v+F]=S-z<<24|64<<16|0),f.bits=C,0}},cX6o:function(t,e,n){"use strict";var r=n("nm4c"),i=n("vn/o"),o=n("eydS"),a=n("LOvY"),s=n("Tcbo"),l=n("iTZm"),h=n("gBP8"),u=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,e.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);if(this.header=new h,r.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"===typeof e.dictionary?e.dictionary=o.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=r.inflateSetDictionary(this.strm,e.dictionary))!==a.Z_OK))throw new Error(s[n])}function d(t,e){var n=new c(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}c.prototype.push=function(t,e){var n,s,l,h,c,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?a.Z_FINISH:a.Z_NO_FLUSH,"string"===typeof t?d.input=o.binstring2buf(t):"[object ArrayBuffer]"===u.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(f),d.next_out=0,d.avail_out=f),(n=r.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&p&&(n=r.inflateSetDictionary(this.strm,p)),n===a.Z_BUF_ERROR&&!0===m&&(n=a.Z_OK,m=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&n!==a.Z_STREAM_END&&(0!==d.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(d.output,d.next_out),h=d.next_out-l,c=o.buf2string(d.output,l),d.next_out=h,d.avail_out=f-h,h&&i.arraySet(d.output,d.output,l,h,0),this.onData(c)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),d.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){t===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=c,e.inflate=d,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},e.ungzip=d},eydS:function(t,e,n){"use strict";var r=n("vn/o"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(h){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){o=!1}for(var a=new r.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&o||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",a=0;a<e;a++)n+=String.fromCharCode(t[a]);return n}a[254]=a[254]=1,e.string2buf=function(t){var e,n,i,o,a,s=t.length,l=0;for(o=0;o<s;o++)55296===(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320===(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(l),a=0,o=0;a<l;o++)55296===(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320===(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},e.buf2string=function(t,e){var n,r,i,o,s=e||t.length,h=new Array(2*s);for(r=0,n=0;n<s;)if((i=t[n++])<128)h[r++]=i;else if((o=a[i])>4)h[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&n<s;)i=i<<6|63&t[n++],o--;o>1?h[r++]=65533:i<65536?h[r++]=i:(i-=65536,h[r++]=55296|i>>10&1023,h[r++]=56320|1023&i)}return l(h,r)},e.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128===(192&t[n]);)n--;return n<0||0===n?e:n+a[t[n]]>e?n:e}},frGm:function(t,e,n){"use strict";t.exports=function(t,e){var n,r,i,o,a,s,l,h,u,c,d,f,p,m,g,_,v,w,y,b,x,k,S,M,A;n=t.state,r=t.next_in,M=t.input,i=r+(t.avail_in-5),o=t.next_out,A=t.output,a=o-(e-t.avail_out),s=o+(t.avail_out-257),l=n.dmax,h=n.wsize,u=n.whave,c=n.wnext,d=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,_=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;t:do{p<15&&(f+=M[r++]<<p,p+=8,f+=M[r++]<<p,p+=8),w=m[f&_];e:for(;;){if(f>>>=y=w>>>24,p-=y,0===(y=w>>>16&255))A[o++]=65535&w;else{if(!(16&y)){if(0===(64&y)){w=m[(65535&w)+(f&(1<<y)-1)];continue e}if(32&y){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}b=65535&w,(y&=15)&&(p<y&&(f+=M[r++]<<p,p+=8),b+=f&(1<<y)-1,f>>>=y,p-=y),p<15&&(f+=M[r++]<<p,p+=8,f+=M[r++]<<p,p+=8),w=g[f&v];n:for(;;){if(f>>>=y=w>>>24,p-=y,!(16&(y=w>>>16&255))){if(0===(64&y)){w=g[(65535&w)+(f&(1<<y)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(x=65535&w,p<(y&=15)&&(f+=M[r++]<<p,(p+=8)<y&&(f+=M[r++]<<p,p+=8)),(x+=f&(1<<y)-1)>l){t.msg="invalid distance too far back",n.mode=30;break t}if(f>>>=y,p-=y,x>(y=o-a)){if((y=x-y)>u&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(k=0,S=d,0===c){if(k+=h-y,y<b){b-=y;do{A[o++]=d[k++]}while(--y);k=o-x,S=A}}else if(c<y){if(k+=h+c-y,(y-=c)<b){b-=y;do{A[o++]=d[k++]}while(--y);if(k=0,c<b){b-=y=c;do{A[o++]=d[k++]}while(--y);k=o-x,S=A}}}else if(k+=c-y,y<b){b-=y;do{A[o++]=d[k++]}while(--y);k=o-x,S=A}for(;b>2;)A[o++]=S[k++],A[o++]=S[k++],A[o++]=S[k++],b-=3;b&&(A[o++]=S[k++],b>1&&(A[o++]=S[k++]))}else{k=o-x;do{A[o++]=A[k++],A[o++]=A[k++],A[o++]=A[k++],b-=3}while(b>2);b&&(A[o++]=A[k++],b>1&&(A[o++]=A[k++]))}break}}break}}while(r<i&&o<s);r-=b=p>>3,f&=(1<<(p-=b<<3))-1,t.next_in=r,t.next_out=o,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=o<s?s-o+257:257-(o-s),n.hold=f,n.bits=p}},gBP8:function(t,e,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},iTZm:function(t,e,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},kEIc:function(t,e,n){"use strict";n.r(e);var r=n("qjPM"),i=1;class o{constructor(t,e,n,r,i,o){this._id=t,this._type=e,this._position=[n,r,i],this._radius=o,this._parent=null,this._parentId=null,this._children=[]}getId(){return this._id}getType(){return this._type}isSoma(){return this._type===i}getRadius(){return this._radius}getPosition(){return this._position}setParent(t){this._parent=t,t._addChild(this)}getParent(){return this._parent}setParentId(t){this._parentId=t}getParentId(){return this._parentId}_addChild(t){this.doesAlreadyHaveChild(t)||this._children.push(t)}getChildren(){return this._children}getNonSomaChildren(){return this._children.filter((t=>!t.isSoma()))}doesAlreadyHaveChild(t){for(let e=0;e<this._children.length;e+=1)if(this._children[e].getId()===t.getId())return!0;return!1}dive(t){t.push(this);const e=this.getChildren();return 1===e.length&&e[0].getType()===this._type?e[0].dive(t):e}}class a{constructor(t){this._nodes={},this._rawSoma=null,this._rawSections=null,this._rawMorphology=null,this._morphology=null,this._initCollection(t),this._buildSections(),this._buildMorphologyObjects()}getRawMorphology(){return this._rawMorphology}getMorphology(){return this._morphology}_initCollection(t){const e=[];for(let n=0;n<t.length;n+=1){const r=new o(t[n][0],t[n][1],t[n][2],t[n][3],t[n][4],t[n][5]);this._nodes[t[n][0]]=r,t[n][1]===i&&e.push(r);const a=t[n][6];-1!==a&&r.setParentId(a)}Object.values(this._nodes).forEach((t=>{const e=t.getParentId();null!==e&&t.setParent(this._nodes[e])})),e.length&&(this._rawSoma={id:0,type:"soma",radius:Math.max(...e.map((t=>t.getRadius()))),points:e.map((t=>({position:t.getPosition()})))})}_buildSections(){let t=0;const e=[],n=Object.values(this._nodes).filter((t=>null===t.getParent())),r=[];function i(n,i){const o=[];n.getParent()&&o.push(n.getParent());const a=n.dive(o),s=o.map((t=>({position:t.getPosition(),radius:t.getRadius()}))),l={typevalue:n.getType(),points:s,id:t,children:[],parent:i};null!==i&&e[i].children.push(t);for(let e=0;e<a.length;e+=1)r.push({node:a[e],parentSectionId:t});return t+=1,l}for(n.forEach((t=>{r.push({node:t,parentSectionId:null})}));r.length;){const t=r.pop(),n=i(t.node,t.parentSectionId);e.push(n),e[n.id]=n}e.length&&(this._rawSections=e)}_buildMorphologyObjects(){this._rawSections||console.warn("This morphology has no section to export"),this._rawSoma||console.warn("This morphology has no soma to show"),this._rawSections||this._rawSoma?(this._rawMorphology={soma:this._rawSoma,sections:this._rawSections},this._morphology=new r.a.Morphology,this._morphology.buildFromRawMorphology(this._rawMorphology)):console.warn("No valid morphology data.")}}class s{constructor(){this._morphology=null,this._rawMorphology=null}parse(t){this._morphology=null,this._rawMorphology=null;const e=s.extractPoints(t),n=new a(e);this._morphology=n.getMorphology(),this._rawMorphology=n.getRawMorphology();let r=Object.values(n._nodes).filter((t=>2===t._type))[0];for(;r._parent;)r=r._parent}getRawMorphology(){return this._rawMorphology}getMorphology(){return this._morphology}static extractPoints(t){let e=t.replace(/\s*#.*?$/gm,"");e=e.trim().replace(/^\s*$/gm,"");const n=e.split("\n"),r=[];for(let i=0;i<n.length;i+=1){const t=n[i].replace(/^\s+/m,"").replace(/\s+$/m,"").split(/[\s,]+/);t.length>=7&&(r[i]=[Math.round(parseFloat(t[0])),Math.round(parseFloat(t[1])),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4]),parseFloat(t[5]),Math.round(parseFloat(t[6]))])}return r}}var l={SwcParser:s};e.default=l},nm4c:function(t,e,n){"use strict";var r=n("vn/o"),i=n("yDR0"),o=n("7tol"),a=n("frGm"),s=n("aFNf"),l=-2,h=12,u=30;function c(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(852),e.distcode=e.distdyn=new r.Buf32(592),e.sane=1,e.back=-1,0):l}function p(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,f(t)):l}function m(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?l:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,p(t))):l}function g(t,e){var n,r;return t?(r=new d,t.state=r,r.window=null,0!==(n=m(t,e))&&(t.state=null),n):l}var _,v,w=!0;function y(t){if(w){var e;for(_=new r.Buf32(512),v=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(1,t.lens,0,288,_,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(2,t.lens,0,32,v,0,t.work,{bits:5}),w=!1}t.lencode=_,t.lenbits=9,t.distcode=v,t.distbits=5}function b(t,e,n,i){var o,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),i>=a.wsize?(r.arraySet(a.window,e,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),r.arraySet(a.window,e,n-i,o,a.wnext),(i-=o)?(r.arraySet(a.window,e,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}e.inflateReset=p,e.inflateReset2=m,e.inflateResetKeep=f,e.inflateInit=function(t){return g(t,15)},e.inflateInit2=g,e.inflate=function(t,e){var n,d,f,p,m,g,_,v,w,x,k,S,M,A,E,C,O,z,j,T,F,N,P,L,D=0,R=new r.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return l;(n=t.state).mode===h&&(n.mode=13),m=t.next_out,f=t.output,_=t.avail_out,p=t.next_in,d=t.input,g=t.avail_in,v=n.hold,w=n.bits,x=g,k=_,N=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;w<16;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(2&n.wrap&&35615===v){n.check=0,R[0]=255&v,R[1]=v>>>8&255,n.check=o(n.check,R,2,0),v=0,w=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&v)<<8)+(v>>8))%31){t.msg="incorrect header check",n.mode=u;break}if(8!==(15&v)){t.msg="unknown compression method",n.mode=u;break}if(w-=4,F=8+(15&(v>>>=4)),0===n.wbits)n.wbits=F;else if(F>n.wbits){t.msg="invalid window size",n.mode=u;break}n.dmax=1<<F,t.adler=n.check=1,n.mode=512&v?10:h,v=0,w=0;break;case 2:for(;w<16;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(n.flags=v,8!==(255&n.flags)){t.msg="unknown compression method",n.mode=u;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=u;break}n.head&&(n.head.text=v>>8&1),512&n.flags&&(R[0]=255&v,R[1]=v>>>8&255,n.check=o(n.check,R,2,0)),v=0,w=0,n.mode=3;case 3:for(;w<32;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}n.head&&(n.head.time=v),512&n.flags&&(R[0]=255&v,R[1]=v>>>8&255,R[2]=v>>>16&255,R[3]=v>>>24&255,n.check=o(n.check,R,4,0)),v=0,w=0,n.mode=4;case 4:for(;w<16;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}n.head&&(n.head.xflags=255&v,n.head.os=v>>8),512&n.flags&&(R[0]=255&v,R[1]=v>>>8&255,n.check=o(n.check,R,2,0)),v=0,w=0,n.mode=5;case 5:if(1024&n.flags){for(;w<16;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}n.length=v,n.head&&(n.head.extra_len=v),512&n.flags&&(R[0]=255&v,R[1]=v>>>8&255,n.check=o(n.check,R,2,0)),v=0,w=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((S=n.length)>g&&(S=g),S&&(n.head&&(F=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,d,p,S,F)),512&n.flags&&(n.check=o(n.check,d,S,p)),g-=S,p+=S,n.length-=S),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===g)break t;S=0;do{F=d[p+S++],n.head&&F&&n.length<65536&&(n.head.name+=String.fromCharCode(F))}while(F&&S<g);if(512&n.flags&&(n.check=o(n.check,d,S,p)),g-=S,p+=S,F)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===g)break t;S=0;do{F=d[p+S++],n.head&&F&&n.length<65536&&(n.head.comment+=String.fromCharCode(F))}while(F&&S<g);if(512&n.flags&&(n.check=o(n.check,d,S,p)),g-=S,p+=S,F)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;w<16;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(v!==(65535&n.check)){t.msg="header crc mismatch",n.mode=u;break}v=0,w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=h;break;case 10:for(;w<32;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}t.adler=n.check=c(v),v=0,w=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=m,t.avail_out=_,t.next_in=p,t.avail_in=g,n.hold=v,n.bits=w,2;t.adler=n.check=1,n.mode=h;case h:if(5===e||6===e)break t;case 13:if(n.last){v>>>=7&w,w-=7&w,n.mode=27;break}for(;w<3;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}switch(n.last=1&v,w-=1,3&(v>>>=1)){case 0:n.mode=14;break;case 1:if(y(n),n.mode=20,6===e){v>>>=2,w-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=u}v>>>=2,w-=2;break;case 14:for(v>>>=7&w,w-=7&w;w<32;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if((65535&v)!==(v>>>16^65535)){t.msg="invalid stored block lengths",n.mode=u;break}if(n.length=65535&v,v=0,w=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(S=n.length){if(S>g&&(S=g),S>_&&(S=_),0===S)break t;r.arraySet(f,d,p,S,m),g-=S,p+=S,_-=S,m+=S,n.length-=S;break}n.mode=h;break;case 17:for(;w<14;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(n.nlen=257+(31&v),v>>>=5,w-=5,n.ndist=1+(31&v),v>>>=5,w-=5,n.ncode=4+(15&v),v>>>=4,w-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=u;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;w<3;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}n.lens[I[n.have++]]=7&v,v>>>=3,w-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,P={bits:n.lenbits},N=s(0,n.lens,0,19,n.lencode,0,n.work,P),n.lenbits=P.bits,N){t.msg="invalid code lengths set",n.mode=u;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;C=(D=n.lencode[v&(1<<n.lenbits)-1])>>>16&255,O=65535&D,!((E=D>>>24)<=w);){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(O<16)v>>>=E,w-=E,n.lens[n.have++]=O;else{if(16===O){for(L=E+2;w<L;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(v>>>=E,w-=E,0===n.have){t.msg="invalid bit length repeat",n.mode=u;break}F=n.lens[n.have-1],S=3+(3&v),v>>>=2,w-=2}else if(17===O){for(L=E+3;w<L;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}w-=E,F=0,S=3+(7&(v>>>=E)),v>>>=3,w-=3}else{for(L=E+7;w<L;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}w-=E,F=0,S=11+(127&(v>>>=E)),v>>>=7,w-=7}if(n.have+S>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=u;break}for(;S--;)n.lens[n.have++]=F}}if(n.mode===u)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=u;break}if(n.lenbits=9,P={bits:n.lenbits},N=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,P),n.lenbits=P.bits,N){t.msg="invalid literal/lengths set",n.mode=u;break}if(n.distbits=6,n.distcode=n.distdyn,P={bits:n.distbits},N=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,P),n.distbits=P.bits,N){t.msg="invalid distances set",n.mode=u;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(g>=6&&_>=258){t.next_out=m,t.avail_out=_,t.next_in=p,t.avail_in=g,n.hold=v,n.bits=w,a(t,k),m=t.next_out,f=t.output,_=t.avail_out,p=t.next_in,d=t.input,g=t.avail_in,v=n.hold,w=n.bits,n.mode===h&&(n.back=-1);break}for(n.back=0;C=(D=n.lencode[v&(1<<n.lenbits)-1])>>>16&255,O=65535&D,!((E=D>>>24)<=w);){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(C&&0===(240&C)){for(z=E,j=C,T=O;C=(D=n.lencode[T+((v&(1<<z+j)-1)>>z)])>>>16&255,O=65535&D,!(z+(E=D>>>24)<=w);){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}v>>>=z,w-=z,n.back+=z}if(v>>>=E,w-=E,n.back+=E,n.length=O,0===C){n.mode=26;break}if(32&C){n.back=-1,n.mode=h;break}if(64&C){t.msg="invalid literal/length code",n.mode=u;break}n.extra=15&C,n.mode=22;case 22:if(n.extra){for(L=n.extra;w<L;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}n.length+=v&(1<<n.extra)-1,v>>>=n.extra,w-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;C=(D=n.distcode[v&(1<<n.distbits)-1])>>>16&255,O=65535&D,!((E=D>>>24)<=w);){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(0===(240&C)){for(z=E,j=C,T=O;C=(D=n.distcode[T+((v&(1<<z+j)-1)>>z)])>>>16&255,O=65535&D,!(z+(E=D>>>24)<=w);){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}v>>>=z,w-=z,n.back+=z}if(v>>>=E,w-=E,n.back+=E,64&C){t.msg="invalid distance code",n.mode=u;break}n.offset=O,n.extra=15&C,n.mode=24;case 24:if(n.extra){for(L=n.extra;w<L;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}n.offset+=v&(1<<n.extra)-1,v>>>=n.extra,w-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=u;break}n.mode=25;case 25:if(0===_)break t;if(S=k-_,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=u;break}S>n.wnext?(S-=n.wnext,M=n.wsize-S):M=n.wnext-S,S>n.length&&(S=n.length),A=n.window}else A=f,M=m-n.offset,S=n.length;S>_&&(S=_),_-=S,n.length-=S;do{f[m++]=A[M++]}while(--S);0===n.length&&(n.mode=21);break;case 26:if(0===_)break t;f[m++]=n.length,_--,n.mode=21;break;case 27:if(n.wrap){for(;w<32;){if(0===g)break t;g--,v|=d[p++]<<w,w+=8}if(k-=_,t.total_out+=k,n.total+=k,k&&(t.adler=n.check=n.flags?o(n.check,f,k,m-k):i(n.check,f,k,m-k)),k=_,(n.flags?v:c(v))!==n.check){t.msg="incorrect data check",n.mode=u;break}v=0,w=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;w<32;){if(0===g)break t;g--,v+=d[p++]<<w,w+=8}if(v!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=u;break}v=0,w=0}n.mode=29;case 29:N=1;break t;case u:N=-3;break t;case 31:return-4;case 32:default:return l}return t.next_out=m,t.avail_out=_,t.next_in=p,t.avail_in=g,n.hold=v,n.bits=w,(n.wsize||k!==t.avail_out&&n.mode<u&&(n.mode<27||4!==e))&&b(t,t.output,t.next_out,k-t.avail_out)?(n.mode=31,-4):(x-=t.avail_in,k-=t.avail_out,t.total_in+=x,t.total_out+=k,n.total+=k,n.wrap&&k&&(t.adler=n.check=n.flags?o(n.check,f,k,t.next_out-k):i(n.check,f,k,t.next_out-k)),t.data_type=n.bits+(n.last?64:0)+(n.mode===h?128:0)+(20===n.mode||15===n.mode?256:0),(0===x&&0===k||4===e)&&0===N&&(N=-5),N)},e.inflateEnd=function(t){if(!t||!t.state)return l;var e=t.state;return e.window&&(e.window=null),t.state=null,0},e.inflateGetHeader=function(t,e){var n;return t&&t.state?0===(2&(n=t.state).wrap)?l:(n.head=e,e.done=!1,0):l},e.inflateSetDictionary=function(t,e){var n,r=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?l:11===n.mode&&i(1,e,r,0)!==n.check?-3:b(t,e,r,r)?(n.mode=31,-4):(n.havedict=1,0):l},e.inflateInfo="pako inflate (from Nodeca project)"},oXfm:function(t,e,n){"use strict";var r,i=n("vn/o"),o=n("B/RK"),a=n("yDR0"),s=n("7tol"),l=n("Tcbo"),h=-2,u=258,c=262,d=103,f=113,p=666;function m(t,e){return t.msg=l[e],e}function g(t){return(t<<1)-(t>4?9:0)}function _(t){for(var e=t.length;--e>=0;)t[e]=0}function v(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function w(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,v(t.strm)}function y(t,e){t.pending_buf[t.pending++]=e}function b(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function x(t,e,n,r){var o=t.avail_in;return o>r&&(o=r),0===o?0:(t.avail_in-=o,i.arraySet(e,t.input,t.next_in,o,n),1===t.state.wrap?t.adler=a(t.adler,e,o,n):2===t.state.wrap&&(t.adler=s(t.adler,e,o,n)),t.next_in+=o,t.total_in+=o,o)}function k(t,e){var n,r,i=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-c?t.strstart-(t.w_size-c):0,h=t.window,d=t.w_mask,f=t.prev,p=t.strstart+u,m=h[o+a-1],g=h[o+a];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(h[(n=e)+a]===g&&h[n+a-1]===m&&h[n]===h[o]&&h[++n]===h[o+1]){o+=2,n++;do{}while(h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&o<p);if(r=u-(p-o),o=p-u,r>a){if(t.match_start=e,a=r,r>=s)break;m=h[o+a-1],g=h[o+a]}}}while((e=f[e&d])>l&&0!==--i);return a<=t.lookahead?a:t.lookahead}function S(t){var e,n,r,o,a,s=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-c)){i.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,e=n=t.hash_size;do{r=t.head[--e],t.head[e]=r>=s?r-s:0}while(--n);e=n=s;do{r=t.prev[--e],t.prev[e]=r>=s?r-s:0}while(--n);o+=s}if(0===t.strm.avail_in)break;if(n=x(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=3)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+3-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<c&&0!==t.strm.avail_in)}function M(t,e){for(var n,r;;){if(t.lookahead<c){if(S(t),t.lookahead<c&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-c&&(t.match_length=k(t,n)),t.match_length>=3)if(r=o._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(w(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(w(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(w(t,!1),0===t.strm.avail_out)?1:2}function A(t,e){for(var n,r,i;;){if(t.lookahead<c){if(S(t),t.lookahead<c&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-c&&(t.match_length=k(t,n),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,r=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(w(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=o._tr_tally(t,0,t.window[t.strstart-1]))&&w(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(w(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(w(t,!1),0===t.strm.avail_out)?1:2}function E(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function C(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),_(this.dyn_ltree),_(this.dyn_dtree),_(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),_(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),_(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function O(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:f,t.adler=2===e.wrap?0:1,e.last_flush=0,o._tr_init(e),0):m(t,h)}function z(t){var e,n=O(t);return 0===n&&((e=t.state).window_size=2*e.w_size,_(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),n}function j(t,e,n,r,o,a){if(!t)return h;var s=1;if(-1===e&&(e=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),o<1||o>9||8!==n||r<8||r>15||e<0||e>9||a<0||a>4)return m(t,h);8===r&&(r=9);var l=new C;return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=n,z(t)}r=[new E(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(S(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,w(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-c&&(w(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(w(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(w(t,!1),t.strm.avail_out),1)})),new E(4,4,8,4,M),new E(4,5,16,8,M),new E(4,6,32,32,M),new E(4,4,16,16,A),new E(8,16,32,32,A),new E(8,16,128,128,A),new E(8,32,128,256,A),new E(32,128,258,1024,A),new E(32,258,258,4096,A)],e.deflateInit=function(t,e){return j(t,e,8,15,8,0)},e.deflateInit2=j,e.deflateReset=z,e.deflateResetKeep=O,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?h:(t.state.gzhead=e,0):h},e.deflate=function(t,e){var n,i,a,l;if(!t||!t.state||e>5||e<0)return t?m(t,h):h;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||i.status===p&&4!==e)return m(t,0===t.avail_out?-5:h);if(i.strm=t,n=i.last_flush,i.last_flush=e,42===i.status)if(2===i.wrap)t.adler=0,y(i,31),y(i,139),y(i,8),i.gzhead?(y(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),y(i,255&i.gzhead.time),y(i,i.gzhead.time>>8&255),y(i,i.gzhead.time>>16&255),y(i,i.gzhead.time>>24&255),y(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),y(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(y(i,255&i.gzhead.extra.length),y(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=s(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(y(i,0),y(i,0),y(i,0),y(i,0),y(i,0),y(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),y(i,3),i.status=f);else{var c=8+(i.w_bits-8<<4)<<8;c|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(c|=32),c+=31-c%31,i.status=f,b(i,c),0!==i.strstart&&(b(i,t.adler>>>16),b(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),v(t),a=i.pending,i.pending!==i.pending_buf_size));)y(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),v(t),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,y(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),v(t),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,y(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=d)}else i.status=d;if(i.status===d&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&v(t),i.pending+2<=i.pending_buf_size&&(y(i,255&t.adler),y(i,t.adler>>8&255),t.adler=0,i.status=f)):i.status=f),0!==i.pending){if(v(t),0===t.avail_out)return i.last_flush=-1,0}else if(0===t.avail_in&&g(e)<=g(n)&&4!==e)return m(t,-5);if(i.status===p&&0!==t.avail_in)return m(t,-5);if(0!==t.avail_in||0!==i.lookahead||0!==e&&i.status!==p){var x=2===i.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(S(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(w(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(w(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(w(t,!1),0===t.strm.avail_out)?1:2}(i,e):3===i.strategy?function(t,e){for(var n,r,i,a,s=t.window;;){if(t.lookahead<=u){if(S(t),t.lookahead<=u&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=s[i=t.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){a=t.strstart+u;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);t.match_length=u-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=o._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(w(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(w(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(w(t,!1),0===t.strm.avail_out)?1:2}(i,e):r[i.level].func(i,e);if(3!==x&&4!==x||(i.status=p),1===x||3===x)return 0===t.avail_out&&(i.last_flush=-1),0;if(2===x&&(1===e?o._tr_align(i):5!==e&&(o._tr_stored_block(i,0,0,!1),3===e&&(_(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),v(t),0===t.avail_out))return i.last_flush=-1,0}return 4!==e?0:i.wrap<=0?1:(2===i.wrap?(y(i,255&t.adler),y(i,t.adler>>8&255),y(i,t.adler>>16&255),y(i,t.adler>>24&255),y(i,255&t.total_in),y(i,t.total_in>>8&255),y(i,t.total_in>>16&255),y(i,t.total_in>>24&255)):(b(i,t.adler>>>16),b(i,65535&t.adler)),v(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},e.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&e!==d&&e!==f&&e!==p?m(t,h):(t.state=null,e===f?m(t,-3):0):h},e.deflateSetDictionary=function(t,e){var n,r,o,s,l,u,c,d,f=e.length;if(!t||!t.state)return h;if(2===(s=(n=t.state).wrap)||1===s&&42!==n.status||n.lookahead)return h;for(1===s&&(t.adler=a(t.adler,e,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&(_(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new i.Buf8(n.w_size),i.arraySet(d,e,f-n.w_size,n.w_size,0),e=d,f=n.w_size),l=t.avail_in,u=t.next_in,c=t.input,t.avail_in=f,t.next_in=0,t.input=e,S(n);n.lookahead>=3;){r=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--o);n.strstart=r,n.lookahead=2,S(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=u,t.input=c,t.avail_in=l,n.wrap=s,0},e.deflateInfo="pako deflate (from Nodeca project)"},qjPM:function(t,e,n){"use strict";const r={0:"undefined",1:"soma",2:"axon",3:"basal_dendrite",4:"apical_dendrite",5:"custom"},i={undefined:0,soma:1,axon:2,basal_dendrite:3,apical_dendrite:4,custom:5};class o{constructor(t=null){this._id=null,this._parent=null,this._children=[],this._typename=null,this._typevalue=null,this._points=null,this._radiuses=null,this._morphology=t}setId(t){this._id=t}getId(){return this._id}setTypename(t){t in i?(this._typename=t,this._typevalue=i[t]):console.warn(`The typename must be one of ${Object.key(i).join(" ")}`)}getTypename(){return this._typename}setTypeValue(t){this._typevalue=t}getTypevalue(){return this._typevalue}getTypeValue(){return this._typevalue}addPoint(t,e,n,r=1){this._points.push([t,e,n]),this._radiuses.push(r)}getPoints(){return this._points}getRadiuses(){return this._radiuses}initWithRawSection(t){return this._id=t.id,this._points=t.points.map((t=>t.position)),this._radiuses=t.points.map((t=>t.radius)),(t.typename||t.typevalue)&&(this._typename=t.typename||r[t.typevalue],this._typevalue=t.typevalue||i[t.typename]),this._id}setParent(t){return t&&t.getId()!==this._id?(this._parent=t,!0):(console.warn("A section cannot be the parent of itself."),!1)}getParent(){return this._parent}addChild(t){return t.getId()!==this._id?(this.hasChild(t)?console.warn("The given section is already one of the child to this one."):this._children.push(t),!0):(console.warn("A section cannot be the child of itself."),!1)}hasChild(t){if(!this._children)return!1;const e=t.getId();for(let n=0;n<this._children.length;n+=1)if(this._children[n].getId()===e)return!0;return!1}getSize(){let t=0;for(let e=0;e<this._points.length-1;e+=1){const n=this._points[e],r=this._points[e+1],i=n[0]-r[0],o=n[1]-r[1],a=n[2]-r[2];t+=Math.sqrt(i*i+o*o+a*a)}return t}getMorphology(){return this._morphology}getChildren(){return this._children}}class a{constructor(){this._id=null,this._typename="soma",this._typevalue=1,this._points=[],this._radius=null}setId(t){this._id=t}getId(){return this._id}addPoint(t,e,n){this._points.push([t,e,n])}getPoints(){return this._points}setRadius(t){this._radius=t}getRadius(){return this._radius}getCenter(){const t=this._points.length;if(1===t)return this._points[0].slice();if(t>1){const e=[0,0,0];for(let n=0;n<t;n+=1)e[0]+=this._points[n][0],e[1]+=this._points[n][1],e[2]+=this._points[n][2];return e[0]/=t,e[1]/=t,e[2]/=t,e}return null}initWithRawSection(t){return t?(this._id=t.id,this._points=t.points.map((t=>t.position)),this._radius=t.radius,this._id):(console.warn("Cannot init the Soma instance, no soma data provided in raw morphology."),null)}}var s={Morphology:class{constructor(){this._id=null,this._sections={},this._soma=null,this._radiusFromSoma=null,this._specialSections={}}setId(t){this._id=t}getId(){return this._id}buildFromRawMorphology(t){t.soma&&(this._soma=new a,this._soma.initWithRawSection(t.soma));for(let e=0;e<t.sections.length;e+=1){const n=new o(this),r=n.initWithRawSection(t.sections[e]);this._sections[r]=n}for(let e=0;e<t.sections.length;e+=1){const n=t.sections[e],r=this._sections[n.id];if(null!==n.parent){const t=this._sections[n.parent];r.setParent(t)}const i=n.children.map((t=>this._sections[t]));for(let t=0;t<i.length;t+=1)r.addChild(i[t])}}getNumberOfSections(){return Object.keys(this._sections)}getSection(t){return t in this._sections?this._sections[t]:null}getArrayOfSections(){return Object.values(this._sections)}getSoma(){return this._soma}getOrphanSections(t=!1){console.error("This method is deprecated. In order to get neurite starting point, use `.getNeuriteStarts()` instead.");return this._findSpecialSection("orphans",(t=>!t.getParent()),t),this._specialSections.orphans}_findSpecialSection(t,e,n=!1){if(t in this._specialSections||(this._specialSections[t]=null),n||!this._specialSections[t]){this._specialSections[t]=[];const n=Object.values(this._sections);for(let r=0;r<n.length;r+=1)e(n[r])&&this._specialSections[t].push(n[r])}return this._specialSections[t]}getNeuriteStarts(){const t=Object.values(this._sections).filter((t=>t.getTypeValue()===i.soma));if(0===t.length)return null;const e=[];return t.forEach((t=>{t.getChildren().filter((t=>t.getTypeValue()!==i.soma)).forEach((t=>{const n=t.getPoints();n.length>1&&e.push(n[1])}))})),e}getRadiusFromSoma(){if(null!==this._radiusFromSoma)return this._radiusFromSoma;const t=this._soma.getCenter();let e=0;const n=Object.values(this._sections);for(let r=0;r<n.length;r+=1){const i=n[r].getPoints();for(let n=0;n<i.length;n+=1){const r=i[n],o=Math.sqrt((r[0]-t[0])**2+(r[1]-t[1])**2+(r[2]-t[2])**2);o>e&&(e=o)}}return this._radiusFromSoma=e,e}}};e.a=s},"vn/o":function(t,e,n){"use strict";var r="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!==typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(t[r]=n[r])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){var e,n,r,i,o,a;for(r=0,e=0,n=t.length;e<n;e++)r+=t[e].length;for(a=new Uint8Array(r),i=0,e=0,n=t.length;e<n;e++)o=t[e],a.set(o,i),i+=o.length;return a}},a={arraySet:function(t,e,n,r,i){for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,o)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(r)},yDR0:function(t,e,n){"use strict";t.exports=function(t,e,n,r){for(var i=65535&t|0,o=t>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(i=i+e[r++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}}}]);