(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6524],{21906:function(e,t,n){"use strict";var a=n(85893),r=n(67294),l=n(2307),o=n(25675),i=n.n(o),s=n(41664),c=n.n(s),d=n(17931);t.Z=e=>{let{currentInstance:t,MorphologyData:n,isMorphologyLibrary:o}=e,s=(0,r.useMemo)(()=>{let e=[{title:"Morphology",dataIndex:"morphology",key:"morphology",width:150,render:(e,t)=>o?(0,a.jsx)(c(),{href:"/reconstruction-data/morphology-library/?layer=".concat(t.layer,"&etype=").concat(t.etype,"&mtype=").concat(t.mtype,"&morphology=").concat(e),children:e}):(0,a.jsx)(c(),{href:"/experimental-data/neuronal-morphology/?layer=".concat(t.layer,"&mtype=").concat(t.mtype,"&instance=").concat(t.morphology),children:e})},{title:"M-type",dataIndex:"mtype",key:"mtype",width:150}];return o||e.push({title:"Preview",dataIndex:"morphology",key:"preview",width:220,render:e=>(0,a.jsx)(i(),{src:"".concat(d.$N,"/images/1_experimental-data/neuronal-morphology/").concat(e,".png"),alt:"morphology preview ".concat(e),width:200,height:100,style:{height:"auto"}})}),e},[o]),u=(0,r.useMemo)(()=>{let e;return Array.isArray(n)&&(e=o?n.find(e=>e.morphology===t||e.id===t):n.find(e=>e.name===t))?[{key:e.name||e.morphology,layer:e.layer,mtype:e.mtype,morphology:e.morphology}]:[]},[t,o,n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{columns:s,dataSource:u,pagination:!1,scroll:{x:"max-content"}}),0===u.length&&(0,a.jsxs)("p",{children:["No data found for the current instance: ",t]})]})}},8404:function(e,t,n){"use strict";n.d(t,{Z:function(){return components_Factsheet}});var a=n(85893);n(67294);var r=n(76343),l=n(14293),o=n.n(l);let i={MOhm:"Mâ„¦"};var components_Unit=e=>{var t;let{value:n=""}=e;return(0,a.jsx)(a.Fragment,{children:null!==(t=i[n])&&void 0!==t?t:n})},s=n(43483);let c=(0,s.o)(),FactsheetSingleValueEntry=e=>{let{fact:t}=e;return(0,a.jsxs)("div",{className:"row mt-1",children:[(0,a.jsx)("div",{className:"col-xs-6 col-sm-4 name",children:(0,a.jsx)(c,{term:t.name,description:t.description})}),(0,a.jsx)("div",{className:"col-xs-6 col-sm-8 value",children:o()(t.value)?(0,a.jsx)("span",{children:"-"}):(0,a.jsxs)("span",{children:[(0,a.jsx)(r.Z,{value:t.value})," ",(0,a.jsx)(components_Unit,{value:t.units||t.unit})]})})]})},FactsheetSingleMeanStdEntry=e=>{var t,n,r,l,o,i,s,d;let{fact:u}=e,m=null!==(i=null===(t=u.value_map)||void 0===t?void 0:t.mean)&&void 0!==i?i:null!==(o=null===(n=u.values)||void 0===n?void 0:n[0])&&void 0!==o?o:"-",h=null!==(d=null===(r=u.value_map)||void 0===r?void 0:r.std)&&void 0!==d?d:null!==(s=null===(l=u.values)||void 0===l?void 0:l[1])&&void 0!==s?s:"-",formatValue=e=>"number"==typeof e?e.toFixed(3):e,formatNumberWithoutCommas=e=>"number"==typeof e?e.toString().replace(/,/g,""):e;return(0,a.jsxs)("div",{className:"row mt-1",children:[(0,a.jsx)("div",{className:"col-xs-4 name",children:(0,a.jsx)(c,{term:u.name,description:u.description})}),(0,a.jsxs)("div",{className:"col-xs-4 value",children:[formatNumberWithoutCommas(formatValue(m)),"-"!==h?(0,a.jsxs)(a.Fragment,{children:[" \xb1 ",formatNumberWithoutCommas(formatValue(h))]}):"",u.units||u.unit&&(0,a.jsxs)(a.Fragment,{children:[" ",u.units||u.unit]})]})]})},FactsheetMapValueEntry=e=>{let{fact:t}=e,n=Math.max.apply(null,Object.values(t.value_map).map(e=>parseFloat(e))),l=t.units||t.unit,o=Object.entries(t.value_map).map(e=>{let[t,o]=e,i=parseFloat(o)/n*80;return(0,a.jsxs)("div",{className:"row mb-1",children:[(0,a.jsxs)("div",{className:"col-xs-6 pos-relative",children:[t,(0,a.jsx)("div",{className:"bar",style:{width:"".concat(i,"%")}})]}),(0,a.jsxs)("div",{className:"col-xs-6",children:[(0,a.jsx)(r.Z,{value:o})," ",(0,a.jsx)(components_Unit,{value:l})]})]},t)});return(0,a.jsxs)("div",{className:"row mt-1",children:[(0,a.jsx)("div",{className:"col-xs-6 col-lg-4 name",children:(0,a.jsx)(c,{term:t.name,description:t.description})}),(0,a.jsx)("div",{className:"col-xs-6 col-lg-8",children:o})]})},FactsheetEntry=e=>{let{fact:t}=e;return t.value_map&&!o()(t.value_map.mean)&&!o()(t.value_map.std)||Array.isArray(t.values)?(0,a.jsx)(FactsheetSingleMeanStdEntry,{fact:t}):t.value_map?(0,a.jsx)(FactsheetMapValueEntry,{fact:t}):(0,a.jsx)(FactsheetSingleValueEntry,{fact:t})};var components_Factsheet=e=>{let{facts:t,className:n=""}=e;return(0,a.jsx)("div",{className:"".concat("factsheet__","basis ").concat(n),children:t.map((e,t)=>(0,a.jsx)(FactsheetEntry,{fact:e},"".concat(e.name,"-").concat(t)))})}},97145:function(e,t,n){"use strict";var a=n(85893),r=n(67294),l=n(99477),o=n(97157),i=n(71711),s=n(61267),c=n(17931);t.Z=e=>{let{value:t,onSelect:n,theme:d=1}=e,u=(0,r.useRef)(null),[m,h]=(0,r.useState)(null),[p,v]=(0,r.useState)([]),[x,g]=(0,r.useState)([]),[y,f]=(0,r.useState)([]),[w,j]=(0,r.useState)(!1),[b,_]=(0,r.useState)(null),[E,F]=(0,r.useState)(null),[k,S]=(0,r.useState)(null),N={SLM:.224*1.6,SR:.684656,SP:.144,SO:.258*1.6};return(0,r.useEffect)(()=>{if(!u.current)return;let e=new l.xsS;e.background=new l.Ilk(3224404);let t=u.current.clientWidth/u.current.clientHeight,n=new l.iKG(-(5*t/2),5*t/2,2.5,-2.5,.1,1e3);n.position.set(0,-10,90),n.lookAt(0,0,1),n.zoom=2.2,n.updateProjectionMatrix();let a=new l.CP7({antialias:!0});a.setPixelRatio(window.devicePixelRatio),a.setSize(u.current.clientWidth,u.current.clientHeight),u.current.appendChild(a.domElement),_(e),F(n),S(a),j(!0);let handleResize=()=>{if(u.current&&a&&n){let e=u.current.clientWidth,t=u.current.clientHeight;a.setSize(e,t);let r=e/t;n.left=-5*r/2,n.right=5*r/2,n.top=2.5,n.bottom=-2.5,n.updateProjectionMatrix()}};return window.addEventListener("resize",handleResize),()=>{window.removeEventListener("resize",handleResize),u.current&&u.current.removeChild(a.domElement)}},[]),(0,r.useEffect)(()=>{if(!w||!b||!E||!k)return;let e=new l.vBJ({color:16777215}),t=[],n=[],a=[],r=s.ug.length,d=0,u=1.5,m=s.ug.reduce((e,t)=>e+(N[t]||1)+0,-0);d=m/2;let h=new o.J;h.load("".concat(c.sb,"/assets/fonts/Titillium_Web_Light_.json"),o=>{for(let c=0;c<r;c++){let r=N[s.ug[c]]||1,m=l.M8C.degToRad(10),h=u-2*r*Math.tan(m),p=new l.YT8([new l.Pa4(-u/2,r/2,0),new l.Pa4(0,r/2+.02,0),new l.Pa4(u/2,r/2,0)]),v=new l.YT8([new l.Pa4(-h/2,-r/2,0),new l.Pa4(0,-r/2+.02,0),new l.Pa4(h/2,-r/2,0)]),x=p.getPoints(20),g=v.getPoints(20),y=new l.bnF;y.moveTo(x[0].x,x[0].y),x.forEach(e=>y.lineTo(e.x,e.y)),g.reverse().forEach(e=>y.lineTo(e.x,e.y)),y.lineTo(x[0].x,x[0].y);let f=new l.O7d(y,{depth:1,bevelEnabled:!1}),w=new l.Kj0(f,e.clone());w.userData.layer=s.ug[c],w.userData.index=c,w.position.set(0,d-r/2,.05),b.add(w),t.push(w);let j=new l.TOt(f),_=new l.nls({color:16777215,linewidth:1,linecap:"round",linejoin:"round"}),E=new l.ejS(j,_);E.position.set(0,d-r/2,.05),b.add(E),n.push(E);let F=new i.M(s.ug[c],{font:o,size:.06,height:.001,curveSegments:24,bevelEnabled:!0,bevelThickness:.005,bevelSize:.002});F.computeBoundingBox();let k=F.boundingBox.max.x-F.boundingBox.min.x,S=new l.vBJ({color:16777215}),M=new l.Kj0(F,S);M.position.set(-k/2,d-r+.06,1.05),b.add(M),a.push(M),d-=r+0,u=h}v(t),g(n),f(a)})},[w,b,E,k]),(0,r.useEffect)(()=>{if(!w||!b||!E||!k||0===p.length)return;let e=new l.iMs,t=new l.FM8(-10,-10),a=null,updateMousePosition=e=>{let n=k.domElement.getBoundingClientRect();t.x=(e.clientX-n.left)/n.width*2-1,t.y=-(2*((e.clientY-n.top)/n.height))+1},onMouseMove=e=>{updateMousePosition(e)},onClick=a=>{updateMousePosition(a),e.setFromCamera(t,E);let r=e.intersectObjects(p);if(r.length>0){let e=r[0].object,t=e.userData.layer;n&&t&&(n(t),h(null))}},onHover=()=>{e.setFromCamera(t,E);let n=e.intersectObjects(p);if(n.length>0){document.body.style.cursor="pointer";let e=n[0].object,t=e.userData.index;a!==e&&(h(t),a=e)}else document.body.style.cursor="default",a&&(h(null),a=null)};window.addEventListener("mousemove",onMouseMove),window.addEventListener("click",onClick);let animate=()=>{requestAnimationFrame(animate),onHover(),k.render(b,E)};return animate(),e.setFromCamera(t,E),onHover(),()=>{window.removeEventListener("mousemove",onMouseMove),window.removeEventListener("click",onClick),u.current&&u.current.removeChild(k.domElement)}},[w,b,E,k,p]),(0,r.useEffect)(()=>{w&&0!==p.length&&p.forEach((e,n)=>{let a=e.material,r=x[n].material,l=y[n].material,o=s.rS[d];n===m&&t!==s.ug[n]?(a.color.set(o.hover),r.color.set(o.selected),l.color.set(o.selected)):t===s.ug[n]?(a.color.set(o.selected),r.color.set(o.selectedEdges),l.color.set(16777215)):(a.color.set(o.default),r.color.set(o.selected),l.color.set(o.selected)),a.needsUpdate=!0,r.needsUpdate=!0,l.needsUpdate=!0})},[m,t,d,w,p,x,y]),(0,a.jsx)("div",{className:"flex align-middle justify-center",style:{width:"100%",minHeight:"400px"},children:(0,a.jsx)("div",{ref:u,style:{width:"calc(100% - 2px)",minHeight:"400px"}})})}},76343:function(e,t,n){"use strict";n(67294),t.Z=e=>{let{value:t,significantFigures:n=5,thousandSeparator:a=!0,prefix:r="",suffix:l=""}=e;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=parseFloat(e);if(!Number.isFinite(l))return e;let o=n?l.toLocaleString("en",{maximumSignificantDigits:t}):l.toPrecision(t);return"".concat(a).concat(o).concat(r)}(t,n,a,r,l)}},8940:function(e,t,n){"use strict";n.d(t,{c:function(){return PranavViewer}});var a=n(85893),r=n(67294),l=n(64713),o=n(42978),i=n(32071),s=n(8380),c=n(14561),d=n(35829),u=n(40949),m=n.n(u);let h=["#004282","#3d6099","#238ec8","#17b2dc","#b0dcf1","#26a065","#99c68e","#fecd70","#e97c1d","#dc1921"];function Options(e){return(0,a.jsx)(l.default.Group,{options:e.options.map(e=>({label:e,value:e})),onChange:t=>{let{target:{value:n}}=t;return e.onChange(n)},value:e.value,optionType:"button",buttonStyle:"solid"})}function PranavViewer(e){let{className:t,url:n}=e,[l,s]=r.useState("BPAP"),[c,d]=r.useState("Amplitude");return(0,a.jsxs)("div",{className:(0,o.AK)(m().main,t),children:[(0,a.jsxs)("header",{children:[(0,a.jsx)(Options,{options:["BPAP","EPSP"],value:l,onChange:s}),(0,a.jsx)(Options,{options:["Amplitude","Delay"],value:c,onChange:d})]}),(0,a.jsx)(i.f,{href:"".concat(n,"/").concat(l.toLowerCase(),"_result.csv"),loader:"Amplitude"===c?pranavLoaderAmplitude:pranavLoaderDelay})]})}async function pranavLoad(e,t,n){let a=await fetch(e);if(!a.ok)throw Error("Error #".concat(a.status,": ").concat(a.statusText));let r=await a.text(),[l,...o]=r.split("\n").filter(e=>e.trim().length>0),i=function(e,t){var n;let a=e.split(",").map(e=>e.trim().toLowerCase()),r=null!==(n=t.find(e=>a.indexOf(e)>-1))&&void 0!==n?n:"";return a.indexOf("voltage_attenuation"),{id:makeFieldGetter(a.indexOf("unique_int_id")),parent:makeFieldGetter(a.indexOf("parent_unique_int_id")),x:makeFieldGetter(a.indexOf("x")),y:makeFieldGetter(a.indexOf("y")),z:makeFieldGetter(a.indexOf("z")),radius:makeFieldGetter(a.indexOf("radius")),u:makeFieldGetter(a.indexOf(r)),v:makeFieldGetter(a.indexOf(r))}}(l,t),u=0,m=0,p=0,v=0,x=o.map(e=>{let t=e.split(","),n=i.parent(t),a=i.x(t),r=i.y(t),l=i.z(t);n<1&&(u++,m+=a,p+=r,v+=l);let o={type:c.d.Unknown,index:i.id(t),parent:n,x:a,y:r,z:l,radius:i.radius(t),u:i.u(t),v:i.v(t)};return o});x.forEach((e,t)=>{Number.isNaN(e.u)&&console.log("\uD83D\uDE80 [PranavViewer] index, node = ",t,e)});let g=x.reduce((e,t)=>Math.min(e,t.u),Number.MAX_VALUE),y=x.reduce((e,t)=>Math.max(e,t.u),-Number.MAX_VALUE),f=1/(y-g);x.forEach((e,t)=>{x[t].u=f*(e.u-g),x[t].v=f*(e.v-g)});let w=u>0?new d.Ui(m,p,v).scale(1/u):void 0;return{legend:{colorRamp:h,labelMin:"".concat(g.toFixed(3)," ").concat(n),labelMax:"".concat(y.toFixed(3)," ").concat(n)},morphologies:[{nodes:new s.D(x),colors:h,texture:{magFilter:"LINEAR",minFilter:"LINEAR"},center:w}]}}let pranavLoaderAmplitude=async e=>pranavLoad(e,["voltage_attenuation","psp_amplitude_ratio"],""),pranavLoaderDelay=async e=>pranavLoad(e,["delay","peak_delays"],"ms");function makeFieldGetter(e){return t=>parseFloat(t[e])}},43483:function(e,t,n){"use strict";n.d(t,{o:function(){return termFactory}});var a=n(85893);n(67294);var r=n(94055),l=n(33511),o=n.n(l);let termFactory=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return n=>{let{className:l,term:i,description:s}=n,c=s||e[i],d=t?t(i):i;return c?(0,a.jsx)(r.default,{title:c,destroyTooltipOnHide:!0,children:(0,a.jsx)("span",{className:"".concat(o().container," ").concat(null!=l?l:""),children:d})}):(0,a.jsx)("span",{className:l,children:d})}}},28354:function(e,t,n){"use strict";var a=n(85893),r=n(67294),l=n(11163);t.Z=(e,t)=>()=>{let n=(0,l.useRouter)();return(0,r.useEffect)(()=>{if(n.isReady&&!n.query[t.key]){let e=t.defaultQuery;n.replace({query:e},void 0,{shallow:!0})}},[n.query]),(0,a.jsx)(e,{})}},91968:function(e,t,n){"use strict";var a=n(85893),r=n(67294),l=n(60192),o=n(5152),i=n.n(o),s=n(61267);let c=i()(()=>Promise.all([n.e(2960),n.e(8660)]).then(n.bind(n,58660)),{loadableGenerated:{webpack:()=>[58660]},ssr:!1});t.Z=e=>{let{plotData:t,maxTime:n=5e3}=e,[o,i]=(0,r.useState)([]),[d,u]=(0,r.useState)({}),[m,h]=(0,r.useState)(!0),[p,v]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[y,f]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(!t||!t.value_map||Array.isArray(t.value_map)&&0===t.value_map.length||0===Object.keys(t.value_map).length){console.log("No plot data available"),h(!1),v(!0);return}try{let e;h(!0),v(!1),e=Array.isArray(t.value_map)?t.value_map.map((e,t)=>({x:Array.from({length:e.length},(t,a)=>a*(n/(e.length-1))),y:e,type:"scatter",mode:"lines",name:"Trace ".concat(t+1),line:{color:"hsl(".concat(137.5*t%360,", 70%, 50%)"),width:1},visible:!!y||"legendonly"})):Object.entries(t.value_map).map((e,t)=>{let[a,r]=e;return{x:Array.from({length:r.length},(e,t)=>t*(n/(r.length-1))),y:r,type:"scatter",mode:"lines",name:a,line:{color:"hsl(".concat(137.5*t%360,", 70%, 50%)"),width:1},visible:!!y||"legendonly"}}),i(e);let a=n/5,r=Array.from({length:6},(e,t)=>t*a),l=r.map(e=>"".concat(Math.round(e)," ms"));u({xaxis:{title:{text:"Time (ms)",standoff:20},showticklabels:!0,tickmode:"array",tickvals:r,ticktext:l,range:[0,n],showgrid:!0,gridwidth:1,gridcolor:"#E0E0E0",linewidth:1,tickwidth:1,ticklen:8,zeroline:!1,anchor:"y",automargin:!1},yaxis:{title:{text:t.units?"Voltage (".concat(t.units,")"):"Voltage",standoff:60},showticklabels:!0,showgrid:!0,gridwidth:1,gridcolor:"#E0E0E0",linewidth:1,tickwidth:1,ticklen:8,zeroline:!1,anchor:"x",automargin:!1},autosize:!0,margin:{l:100,r:50,b:50,t:50,pad:0},hovermode:"x unified",showlegend:!0,legend:{orientation:"h",x:0,y:1.2},plot_bgcolor:"#EFF1F8",paper_bgcolor:"#EFF1F8"}),h(!1)}catch(e){console.error("Error processing plot data:",e),h(!1),v(!0)}},[t,y,n]),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>{f(!y);let e=o.map(e=>({...e,visible:!y||"legendonly"}));i(e)},style:{marginBottom:"1rem",padding:"0.25rem .5rem",backgroundColor:s.x8.blue,color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},children:y?"Hide All Traces":"Show All Traces"}),(0,a.jsx)("div",{style:{width:"100%",height:"500px",position:"relative"},children:m?(0,a.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:(0,a.jsx)(l.Z,{className:"w-8 h-8 animate-spin"})}):p||!o.length?(0,a.jsx)("p",{className:"text-center text-gray-500 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:"No data available."}):(0,a.jsx)(c,{data:o,layout:d,useResizeHandler:!0,style:{width:"100%",height:"100%"},config:{responsive:!0},onLegendItemClick:()=>!1,onLegendItemHover:e=>{g(e.curveNumber)},onLegendItemUnhover:()=>{g(null)}})})]})}},40949:function(e){e.exports={main:"pranav-viewer_main__vNeI_"}},33511:function(e){e.exports={container:"styles_container__pHcWR"}}}]);