{"version":3,"sources":["webpack://_N_E/./node_modules/next/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://_N_E/./node_modules/next/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://_N_E/./node_modules/next/node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://_N_E/./node_modules/next/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://_N_E/./node_modules/next/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://_N_E/./src/components/NexusPlugin/nexus-plugin.tsx","webpack://_N_E/./node_modules/next/node_modules/@babel/runtime/helpers/esm/inherits.js","webpack://_N_E/./node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://_N_E/./node_modules/next/node_modules/@babel/runtime/helpers/esm/createClass.js"],"names":["_assertThisInitialized","self","ReferenceError","_setPrototypeOf","o","p","Object","setPrototypeOf","__proto__","_typeof","obj","Symbol","iterator","constructor","prototype","_possibleConstructorReturn","call","_getPrototypeOf","getPrototypeOf","NexusPlugin","subClass","superClass","TypeError","create","value","writable","configurable","props","state","error","loading","container","React","destroyPlugin","invariant","window","System","this","current","fetch","nexusPluginBaseUrl","then","res","json","pluginManifest","modulePath","name","moduleUrl","pluginModule","setState","ref","nexusClient","resource","console","log","prevProps","loadExternalPlugin","isFunction","className","_classCallCheck","instance","Constructor","_defineProperties","target","i","length","descriptor","enumerable","defineProperty","key","_createClass","protoProps","staticProps"],"mappings":"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","file":"static/chunks/232.24d8b15def4fa7429252.js","sourcesContent":["export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","/**\n * This component requires SystemJS to be available globally (in window)\n */\nimport * as React from 'react';\nimport invariant from 'ts-invariant';\nimport isFunction from 'lodash/isFunction';\nimport { NexusClient, Resource } from '@bbp/nexus-sdk';\n// import { Result } from 'antd';\n\n// import Loading from '../components/Loading';\nimport { nexusPluginBaseUrl } from '../../config';\n\n\nconst PluginError: React.FC<{ error: Error }> = ({ error }) => {\n  return (\n    <p>Plugin failed to render</p>\n    // <Result\n    //   status=\"warning\"\n    //   title=\"Plugin failed to render\"\n    //   subTitle={error.message}\n    // />\n  );\n};\n\nconst warningMessage =\n  'SystemJS not found. ' +\n  'To load plugins, Nexus Web requires SystemJS to be available globally.' +\n  ' You can find out more here https://github.com/systemjs/systemjs';\n\nexport type NexusPluginProps<T> = {\n  name: string;\n  resource: Resource<T>;\n  className?: string;\n};\n\nexport type NexusPluginClassProps<T = any> = NexusPluginProps<T> & {\n  nexusClient: NexusClient;\n};\n\nexport class NexusPlugin extends React.Component<\n  NexusPluginClassProps,\n  { error: Error | null; loading: boolean }\n> {\n  private container: React.RefObject<HTMLDivElement>;\n  private destroyPlugin: (() => void) | null;\n\n  constructor(props: NexusPluginClassProps) {\n    super(props);\n    this.state = { error: null, loading: true };\n    this.container = React.createRef();\n    this.destroyPlugin = null;\n    // @ts-ignore\n    invariant(window.System, warningMessage);\n  }\n\n  async loadExternalPlugin() {\n    if (!this.container.current) return;\n\n    const pluginManifest = await fetch(`${nexusPluginBaseUrl}/manifest.json`)\n      .then(res => res.json());\n\n    const { modulePath } = pluginManifest[this.props.name];\n    const moduleUrl = `${nexusPluginBaseUrl}/${modulePath}`;\n\n    // @ts-ignore\n    window.System.import(moduleUrl)\n      .then(\n        (pluginModule: {\n          default: ({\n            ref,\n            nexusClient,\n            resource,\n          }: {\n            ref: HTMLDivElement | null;\n            nexusClient?: NexusClient;\n            resource: Resource;\n          }) => () => void;\n        }) => {\n          this.setState({\n            error: null,\n            loading: false,\n          });\n          this.destroyPlugin = pluginModule.default({\n            ref: this.container.current,\n            nexusClient: this.props.nexusClient,\n            resource: this.props.resource,\n          });\n        }\n      )\n      .catch((error: Error) => {\n        console.log(error);\n        this.setState({ error, loading: false });\n      });\n  }\n\n  componentDidCatch(error: Error) {\n    this.setState({ error, loading: false });\n  }\n\n  componentWillUpdate(prevProps: NexusPluginClassProps) {\n    // Reload the plugin(and pass in new props to it) when props change\n    // NOTE: will not reload the plugin if nexusClient or goToResource changes\n    // otherwise it will cause too many reloads\n    if (\n      prevProps.resource !== this.props.resource ||\n      prevProps.name !== this.props.name\n    ) {\n      this.loadExternalPlugin();\n    }\n  }\n\n  componentDidMount() {\n    this.loadExternalPlugin();\n  }\n\n  componentWillUnmount() {\n    if (isFunction(this.destroyPlugin)) {\n      this.destroyPlugin();\n    }\n  }\n\n  render() {\n    const className = this.props.className || '';\n\n    return (\n      <div\n        className={`remote-component ${className}`}\n        ref={this.container}\n      />\n      // <Loading\n      //   size=\"big\"\n      //   loading={this.state.loading}\n      //   loadingMessage={<h3>Loading {this.props.pluginName || 'Plugin'}</h3>}\n      // >\n      //   {this.state.error ? (\n      //     <PluginError error={this.state.error} />\n      //   ) : (\n      //     <div className=\"remote-component\" ref={this.container}></div>\n      //   )}\n      // </Loading>\n    );\n  }\n}\n\nexport default NexusPlugin;\n","import setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}"],"sourceRoot":""}