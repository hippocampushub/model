(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7605],{17388:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reconstruction-data/volume",function(){return n(8646)}])},1342:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{noSSR:function(){return noSSR},default:function(){return dynamic}});let o=n(38754),a=(n(67294),o._(n(24304)));function convertModule(e){return{default:(null==e?void 0:e.default)||e}}function noSSR(e,t){return delete t.webpack,delete t.modules,e(t)}function dynamic(e,t){let n=a.default,o={loading:e=>{let{error:t,isLoading:n,pastDelay:o}=e;return null}};e instanceof Promise?o.loader=()=>e:"function"==typeof e?o.loader=e:"object"==typeof e&&(o={...o,...e}),o={...o,...t};let r=o.loader;return(o.loadableGenerated&&(o={...o,...o.loadableGenerated},delete o.loadableGenerated),"boolean"!=typeof o.ssr||o.ssr)?n({...o,loader:()=>null!=r?r().then(convertModule):Promise.resolve(convertModule(()=>null))}):(delete o.webpack,delete o.modules,noSSR(n,o))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},30043:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return r}});let o=n(38754),a=o._(n(67294)),r=a.default.createContext(null)},24304:function(e,t,n){"use strict";/**
@copyright (c) 2017-present James Kyle <me@thejameskyle.com>
 MIT License
 Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:
 The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE
*/Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let o=n(38754),a=o._(n(67294)),r=n(30043),i=[],l=[],s=!1;function load(e){let t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then(e=>(n.loading=!1,n.loaded=e,e)).catch(e=>{throw n.loading=!1,n.error=e,e}),n}let LoadableSubscription=class LoadableSubscription{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}};function Loadable(e){return function(e,t){let n=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),o=null;function init(){if(!o){let t=new LoadableSubscription(e,n);o={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return o.promise()}if(!s){let e=n.webpack?n.webpack():n.modules;e&&l.push(t=>{for(let n of e)if(t.includes(n))return init()})}function LoadableComponent(e,t){!function(){init();let e=a.default.useContext(r.LoadableContext);e&&Array.isArray(n.modules)&&n.modules.forEach(t=>{e(t)})}();let i=a.default.useSyncExternalStore(o.subscribe,o.getCurrentValue,o.getCurrentValue);return a.default.useImperativeHandle(t,()=>({retry:o.retry}),[]),a.default.useMemo(()=>{var t;return i.loading||i.error?a.default.createElement(n.loading,{isLoading:i.loading,pastDelay:i.pastDelay,timedOut:i.timedOut,error:i.error,retry:o.retry}):i.loaded?a.default.createElement((t=i.loaded)&&t.default?t.default:t,e):null},[e,i])}return LoadableComponent.preload=()=>init(),LoadableComponent.displayName="LoadableComponent",a.default.forwardRef(LoadableComponent)}(load,e)}function flushInitializers(e,t){let n=[];for(;e.length;){let o=e.pop();n.push(o(t))}return Promise.all(n).then(()=>{if(e.length)return flushInitializers(e,t)})}Loadable.preloadAll=()=>new Promise((e,t)=>{flushInitializers(i).then(e,t)}),Loadable.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let res=()=>(s=!0,t());flushInitializers(l,e).then(res,res)})),window.__NEXT_PRELOADREADY=Loadable.preloadReady;let c=Loadable},8646:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return VolumePage}});var o=n(85893),a=n(9008),r=n.n(a),i=n(67294),l=n(89552),s=n(11163),c=n(41664),d=n.n(c),u=n(5152),m=n.n(u),h=n(2064),p=n.n(h);let f=m()(()=>Promise.all([n.e(9006),n.e(3825),n.e(4420)]).then(n.bind(n,54420)),{loadableGenerated:{webpack:()=>[54420]},ssr:!1});var volume_viewer=e=>(0,o.jsx)("div",{className:p().fixedAspectRation,children:(0,o.jsx)(f,{...e})}),v=n(20745),b=n(2801),g=n(83848),y=n(73265),w=n(26401),x=n(65400),_=n(94055),j=n(93162),P=n(99477),E=n(62249),S=n.n(E);let AtomicState=class AtomicState{get value(){return this.currentValue}set value(e){let{transform:t,storage:n}=this.options;t&&(e=t(e)),e!==this.currentValue&&(this.currentValue=e,n?window.localStorage.setItem(this.id,JSON.stringify(e)):this.saveSession(e),this.listeners.forEach(t=>t(e)))}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}loadFromStorage(){let{storage:e}=this.options;if(e)try{let t=window.localStorage.getItem(this.id);if(!t)return;let n=JSON.parse(t);if(!e.guard(n))throw Error("Invalid type!");this.currentValue=n}catch(t){console.error('Unable to retrieve AtomicState "'.concat(e.id,'":'),t)}}saveSession(e){{let t=JSON.stringify(e),n=computeHash(t);window.sessionStorage.setItem(this.sessionId,"".concat(n).concat(t))}}restoreSession(){{let e=window.sessionStorage.getItem(this.sessionId);if(!e)return;let t=e.substring(0,16),n=e.substring(16);if(computeHash(n)!==t){console.error("Atomic state has been corrupted!",this.sessionId);return}try{let e=JSON.parse(n);this.value=e}catch(e){console.error("Atomic state is an invalid JSON!",this.sessionId)}}}constructor(e,t={}){var n,o;this.options=t,this.listeners=new Set,this.sessionId="AtomicState:".concat((AtomicState.counter++).toString(16),"\r"),this.currentValue=t.transform?t.transform(e):e,this.id="AtomicState\n".concat(null!==(o=null===(n=t.storage)||void 0===n?void 0:n.id)&&void 0!==o?o:""),t.storage?this.loadFromStorage():this.restoreSession()}};AtomicState.counter=0;let A="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function computeHash(e){let t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);t[n%t.length]+=o}return t.map(e=>A[e%A.length]).join("")}let C={axe:new AtomicState("L",{storage:{id:"axe",guard:function(e){return"string"==typeof e}}})},N=null;function getGradientCanvas(){if(!N){(N=document.createElement("canvas")).width=2048,N.height=1;let e=N.getContext("2d");if(!e)throw Error("Unable to get 2D context on canvas!");let t=e.createLinearGradient(0,0,N.width,0);t.addColorStop(0,"#7b7"),t.addColorStop(.1,"#4e4"),t.addColorStop(.5,"#dd2"),t.addColorStop(.9,"#e44"),t.addColorStop(1,"#b77"),e.fillStyle=t,e.fillRect(0,0,N.width,N.height)}return N}let T={type:"change"},O={type:"start"},M={type:"end"};let OrbitControls=class OrbitControls extends P.pBf{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new P.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:P.RsA.ROTATE,MIDDLE:P.RsA.DOLLY,RIGHT:P.RsA.PAN},this.touches={ONE:P.QmN.ROTATE,TWO:P.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return i.phi},this.getAzimuthalAngle=function(){return i.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",onKeyDown),this._domElementKeyEvents=e},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(T),n.update(),a=o.NONE},this.update=function(){let t=new P.Pa4,u=new P._fP().setFromUnitVectors(e.up,new P.Pa4(0,1,0)),m=u.clone().invert(),h=new P.Pa4,p=new P._fP,f=2*Math.PI;return function(){let e=n.object.position;t.copy(e).sub(n.target),t.applyQuaternion(u),i.setFromVector3(t),n.autoRotate&&a===o.NONE&&rotateLeft(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(i.theta+=l.theta*n.dampingFactor,i.phi+=l.phi*n.dampingFactor):(i.theta+=l.theta,i.phi+=l.phi);let v=n.minAzimuthAngle,b=n.maxAzimuthAngle;return isFinite(v)&&isFinite(b)&&(v<-Math.PI?v+=f:v>Math.PI&&(v-=f),b<-Math.PI?b+=f:b>Math.PI&&(b-=f),v<=b?i.theta=Math.max(v,Math.min(b,i.theta)):i.theta=i.theta>(v+b)/2?Math.max(v,i.theta):Math.min(b,i.theta)),i.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,i.phi)),i.makeSafe(),i.radius*=s,i.radius=Math.max(n.minDistance,Math.min(n.maxDistance,i.radius)),!0===n.enableDamping?n.target.addScaledVector(c,n.dampingFactor):n.target.add(c),t.setFromSpherical(i),t.applyQuaternion(m),e.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,c.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),c.set(0,0,0)),s=1,!!(d||h.distanceToSquared(n.object.position)>r||8*(1-p.dot(n.object.quaternion))>r)&&(n.dispatchEvent(T),h.copy(n.object.position),p.copy(n.object.quaternion),d=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",onContextMenu),n.domElement.removeEventListener("pointerdown",onPointerDown),n.domElement.removeEventListener("pointercancel",onPointerCancel),n.domElement.removeEventListener("wheel",onMouseWheel),n.domElement.removeEventListener("pointermove",onPointerMove),n.domElement.removeEventListener("pointerup",onPointerUp),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",onKeyDown)};let n=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},a=o.NONE,r=1e-6,i=new P.$V,l=new P.$V,s=1,c=new P.Pa4,d=!1,u=new P.FM8,m=new P.FM8,h=new P.FM8,p=new P.FM8,f=new P.FM8,v=new P.FM8,b=new P.FM8,g=new P.FM8,y=new P.FM8,w=[],x={};function getZoomScale(){return Math.pow(.95,n.zoomSpeed)}function rotateLeft(e){l.theta-=e}let _=function(){let e=new P.Pa4;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),c.add(e)}}(),j=function(){let e=new P.Pa4;return function(t,o){!0===n.screenSpacePanning?e.setFromMatrixColumn(o,1):(e.setFromMatrixColumn(o,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),c.add(e)}}(),E=function(){let e=new P.Pa4;return function(t,o){let a=n.domElement;if(n.object.isPerspectiveCamera){let r=n.object.position;e.copy(r).sub(n.target);let i=e.length();_(2*t*(i*=Math.tan(n.object.fov/2*Math.PI/180))/a.clientHeight,n.object.matrix),j(2*o*i/a.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(_(t*(n.object.right-n.object.left)/n.object.zoom/a.clientWidth,n.object.matrix),j(o*(n.object.top-n.object.bottom)/n.object.zoom/a.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function dollyOut(e){n.object.isPerspectiveCamera?s/=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*e)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function dollyIn(e){n.object.isPerspectiveCamera?s*=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/e)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function handleMouseDownRotate(e){u.set(e.clientX,e.clientY)}function handleMouseDownPan(e){p.set(e.clientX,e.clientY)}function handleTouchStartRotate(){if(1===w.length)u.set(w[0].pageX,w[0].pageY);else{let e=.5*(w[0].pageX+w[1].pageX),t=.5*(w[0].pageY+w[1].pageY);u.set(e,t)}}function handleTouchStartPan(){if(1===w.length)p.set(w[0].pageX,w[0].pageY);else{let e=.5*(w[0].pageX+w[1].pageX),t=.5*(w[0].pageY+w[1].pageY);p.set(e,t)}}function handleTouchStartDolly(){let e=w[0].pageX-w[1].pageX,t=w[0].pageY-w[1].pageY;b.set(0,Math.sqrt(e*e+t*t))}function handleTouchMoveRotate(e){var t;if(1==w.length)m.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),n=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);m.set(n,o)}h.subVectors(m,u).multiplyScalar(n.rotateSpeed);let o=n.domElement;rotateLeft(2*Math.PI*h.x/o.clientHeight),t=2*Math.PI*h.y/o.clientHeight,l.phi-=t,u.copy(m)}function handleTouchMovePan(e){if(1===w.length)f.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),n=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);f.set(n,o)}v.subVectors(f,p).multiplyScalar(n.panSpeed),E(v.x,v.y),p.copy(f)}function handleTouchMoveDolly(e){let t=getSecondPointerPosition(e),o=e.pageX-t.x,a=e.pageY-t.y;g.set(0,Math.sqrt(o*o+a*a)),y.set(0,Math.pow(g.y/b.y,n.zoomSpeed)),dollyOut(y.y),b.copy(g)}function onPointerDown(e){!1!==n.enabled&&(0===w.length&&(n.domElement.setPointerCapture(e.pointerId),n.domElement.addEventListener("pointermove",onPointerMove),n.domElement.addEventListener("pointerup",onPointerUp)),w.push(e),"touch"===e.pointerType?function(e){switch(trackPointer(e),w.length){case 1:switch(n.touches.ONE){case P.QmN.ROTATE:if(!1===n.enableRotate)return;handleTouchStartRotate(),a=o.TOUCH_ROTATE;break;case P.QmN.PAN:if(!1===n.enablePan)return;handleTouchStartPan(),a=o.TOUCH_PAN;break;default:a=o.NONE}break;case 2:switch(n.touches.TWO){case P.QmN.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&handleTouchStartDolly(),n.enablePan&&handleTouchStartPan(),a=o.TOUCH_DOLLY_PAN;break;case P.QmN.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&handleTouchStartDolly(),n.enableRotate&&handleTouchStartRotate(),a=o.TOUCH_DOLLY_ROTATE;break;default:a=o.NONE}break;default:a=o.NONE}a!==o.NONE&&n.dispatchEvent(O)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case P.RsA.DOLLY:if(!1===n.enableZoom)return;b.set(e.clientX,e.clientY),a=o.DOLLY;break;case P.RsA.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;handleMouseDownPan(e),a=o.PAN}else{if(!1===n.enableRotate)return;handleMouseDownRotate(e),a=o.ROTATE}break;case P.RsA.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;handleMouseDownRotate(e),a=o.ROTATE}else{if(!1===n.enablePan)return;handleMouseDownPan(e),a=o.PAN}break;default:a=o.NONE}a!==o.NONE&&n.dispatchEvent(O)}(e))}function onPointerMove(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(trackPointer(e),a){case o.TOUCH_ROTATE:if(!1===n.enableRotate)return;handleTouchMoveRotate(e),n.update();break;case o.TOUCH_PAN:if(!1===n.enablePan)return;handleTouchMovePan(e),n.update();break;case o.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&handleTouchMoveDolly(e),n.enablePan&&handleTouchMovePan(e),n.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&handleTouchMoveDolly(e),n.enableRotate&&handleTouchMoveRotate(e),n.update();break;default:a=o.NONE}}(e):function(e){switch(a){case o.ROTATE:if(!1===n.enableRotate)return;!function(e){var t;m.set(e.clientX,e.clientY),h.subVectors(m,u).multiplyScalar(n.rotateSpeed);let o=n.domElement;rotateLeft(2*Math.PI*h.x/o.clientHeight),t=2*Math.PI*h.y/o.clientHeight,l.phi-=t,u.copy(m),n.update()}(e);break;case o.DOLLY:if(!1===n.enableZoom)return;g.set(e.clientX,e.clientY),y.subVectors(g,b),y.y>0?dollyOut(getZoomScale()):y.y<0&&dollyIn(getZoomScale()),b.copy(g),n.update();break;case o.PAN:if(!1===n.enablePan)return;f.set(e.clientX,e.clientY),v.subVectors(f,p).multiplyScalar(n.panSpeed),E(v.x,v.y),p.copy(f),n.update()}}(e))}function onPointerUp(e){removePointer(e),0===w.length&&(n.domElement.releasePointerCapture(e.pointerId),n.domElement.removeEventListener("pointermove",onPointerMove),n.domElement.removeEventListener("pointerup",onPointerUp)),n.dispatchEvent(M),a=o.NONE}function onPointerCancel(e){removePointer(e)}function onMouseWheel(e){!1!==n.enabled&&!1!==n.enableZoom&&a===o.NONE&&(e.preventDefault(),n.dispatchEvent(O),e.deltaY<0?dollyIn(getZoomScale()):e.deltaY>0&&dollyOut(getZoomScale()),n.update(),n.dispatchEvent(M))}function onKeyDown(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:E(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:E(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:E(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:E(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function onContextMenu(e){!1!==n.enabled&&e.preventDefault()}function removePointer(e){delete x[e.pointerId];for(let t=0;t<w.length;t++)if(w[t].pointerId==e.pointerId){w.splice(t,1);return}}function trackPointer(e){let t=x[e.pointerId];void 0===t&&(t=new P.FM8,x[e.pointerId]=t),t.set(e.pageX,e.pageY)}function getSecondPointerPosition(e){let t=e.pointerId===w[0].pointerId?w[1]:w[0];return x[t.pointerId]}n.domElement.addEventListener("contextmenu",onContextMenu),n.domElement.addEventListener("pointerdown",onPointerDown),n.domElement.addEventListener("pointercancel",onPointerCancel),n.domElement.addEventListener("wheel",onMouseWheel,{passive:!1}),this.update()}};let R={L:new P.Pa4(1,0,0),T:new P.Pa4(0,1,0),R:new P.Pa4(0,0,1)};let Painter=class Painter{constructor(e,t,n,o){this.canvas=e,this.lastWidth=0,this.lastHeight=0,this.paint=e=>{let{canvas:t,controls:n,camera:o,renderer:a,scene:r}=this;if(t.clientWidth!==this.lastWidth||t.clientHeight!==this.lastHeight){let e=t.clientWidth,r=t.clientHeight;this.lastWidth=e,this.lastHeight=r,t.width=e,t.height=r,o.aspect=e/r,o.updateProjectionMatrix(),o.updateMatrix(),a.setSize(e,r,!1),n.update()}a.render(r,o)};let a=new P.xsS,r=new P.cPb(50,1,1,1e5),i=new P.CP7({alpha:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,depth:!0,canvas:e});i.setClearColor(3355443,1),this.scene=a,this.camera=r,this.renderer=i,i.setClearColor(15725048,1);let{x:l,y:s,z:c,sizeX:d,sizeY:u,sizeZ:m}=function(e){let[t,n,o]=e.min,[a,r,i]=e.max;return{x:(t+a)/2,y:(n+r)/2,z:(o+i)/2,sizeX:a-t,sizeY:r-n,sizeZ:i-o}}(t),h=new OrbitControls(r,e);this.controls=h,h.target.set(l,s,c),h.addEventListener("change",this.paint);let[p,f]=function(e,t){let n=new P.ROQ(getGradientCanvas()),o=new P.u9r,a=new P.vpT(e,9);o.setIndex(t),o.setAttribute("position",new P.kB5(a,3,0,!1)),o.setAttribute("normal",new P.kB5(a,3,3,!1)),o.setAttribute("coords",new P.kB5(a,3,6,!1));let r={texCoords:{type:"t",value:n},uniSelector:{value:new P.Pa4(0,1,0)}},i=new P.jyz({uniforms:r,fragmentShader:"precision mediump float;\n\nuniform sampler2D texCoords;\nuniform vec3 uniSelector;\n\nvarying vec3 varCoords; \nvarying vec3 varNormal;\n\nvoid main() {\n    float u = dot(varCoords, uniSelector);\n    vec3 color = texture2D(texCoords, vec2(u, 0.5)).rgb;\n    vec3 n = normalize(varNormal);\n    float light = pow(-n.z, 2.0) * 2.0 + 0.1;\n    gl_FragColor = vec4(light * color, 1.0);\n}",vertexShader:"precision mediump float;\n\n// Attribute `position` is automatically added by ThreeJS.\n// attribute vec4 position;\nattribute vec3 coords;\nvarying vec3 varCoords;\nvarying vec3 varNormal;\n\nvoid main() {\n    varCoords = coords;\n    vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);\n    varNormal = mat3(modelViewMatrix) * normal;\n    gl_Position = projectionMatrix * modelViewPosition;\n}",side:P._Li,depthTest:!0});n.generateMipmaps=!0,n.needsUpdate=!0;let l=new P.ZAu,s=new P.Kj0(o,i);return l.add(s,new P.Kj0(o,new P.jyz({fragmentShader:"precision mediump float;\n\nvoid main() {\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}",vertexShader:"precision mediump float;\n\n// Attribute `position` is automatically added by ThreeJS.\n// attribute vec4 position;\nattribute vec3 coords;\nvarying vec3 varCoords;\nvarying vec3 varNormal;\n\nvoid main() {\n    varCoords = coords;\n    vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);\n    varNormal = mat3(modelViewMatrix) * normal;\n    gl_Position = projectionMatrix * (\n        modelViewPosition - vec4(varNormal, 0.0) * 20.0\n    );\n}",side:P.Wl3,depthTest:!0}))),[l,e=>{i.uniforms.uniSelector.value=e}]}(n,o);p.position.set(l,s,c),p.rotation.x=Math.PI,p.rotation.y=-Math.PI/2,a.add(p),r.position.set(l,s,c-1.5*Math.max(d,u,m)),r.lookAt(new P.Pa4(l,s,c)),window.requestAnimationFrame(this.paint),C.axe.addListener(e=>{var t;f(null!==(t=R[e])&&void 0!==t?t:R.L),window.requestAnimationFrame(this.paint)})}};function Scene(e){let{className:t="",meshInfo:n,vert:a,elem:r,onPainterInit:l}=e,s=(0,i.useRef)(null),c=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(s.current){let e=new Painter(s.current,n,a,r);c.current=e,l&&l(e)}},[n,a,r,l]),(0,o.jsx)("canvas",{className:"".concat(t," ").concat(S().Scene),ref:s})}var L=n(5333),k=n.n(L);function Selector(e){let{className:t}=e,[n,a]=function(e){let[t,n]=(0,i.useState)(e.value);return(0,i.useEffect)(()=>{let listener=e=>n(e);return e.addListener(listener),()=>{e.removeListener(listener)}},[e]),[t,t=>e.value=t]}(C.axe);return(0,o.jsxs)("div",{className:"".concat(k().Selector," ").concat(null!=t?t:""),children:[(0,o.jsx)("button",{className:"L"===n?k().selected:k().unselected,onClick:()=>a("L"),children:"Longitudinal"}),(0,o.jsx)("button",{className:"T"===n?k().selected:k().unselected,onClick:()=>a("T"),children:"Transverse"}),(0,o.jsx)("button",{className:"R"===n?k().selected:k().unselected,onClick:()=>a("R"),children:"Radial"})]})}var D=n(97223),I=n.n(D);let V={min:[0,0,0],max:[1,1,1]},F=new Float32Array([0,0,0,1,1,1]),Z=[0,1,2];function Gradient(){return(0,o.jsx)("div",{style:{width:"50px",height:"50px",borderRadius:"5px",border:"none"},className:I().colorramp,ref:e=>{null==e||e.appendChild(getGradientCanvas())}})}var Viewer_Viewer=e=>{let{className:t,meshInfo:n=V,vert:a=F,elem:r=Z}=e,l=(0,b.r)(),[s,c]=(0,i.useState)(null),downloadRender=e=>{if(!s)return;let{clientWidth:t,clientHeight:n}=s.renderer.domElement.parentElement,o=new P.CP7({antialias:!0,alpha:!0,preserveDrawingBuffer:!0,physicallyCorrectColors:!0});o.setSize(3*t,3*n),o.render(s.scene,s.camera),o.domElement.toBlob(t=>{t&&(0,j.saveAs)(t,"".concat(e,".png"))}),o.dispose()};return(0,o.jsxs)(b.I,{className:l.active?void 0:I().fixedAspectRatio,handle:l,children:[(0,o.jsxs)("div",{className:I().topRightCtrlGroup,children:[(0,o.jsx)(_.default,{title:"Download render as a PNG",children:(0,o.jsx)(x.default,{size:"small",onClick:()=>downloadRender("volume_render_CA1"),icon:(0,o.jsx)(w.Z,{})})}),(0,o.jsx)(_.default,{title:"Fullscreen",children:(0,o.jsx)(x.default,{size:"small",className:"ml-1",onClick:()=>{l.active?l.exit():l.enter()},icon:l.active?(0,o.jsx)(y.Z,{}):(0,o.jsx)(g.Z,{})})})]}),(0,o.jsxs)("div",{className:function(e){let t=[I().App];return e&&t.push(e),t.join(" ")}(t),children:[(0,o.jsx)(Scene,{className:I().canvas,meshInfo:n,vert:a,elem:r,onPainterInit:c}),(0,o.jsxs)("div",{className:I().colorrampContainer,children:[(0,o.jsx)("div",{style:{color:"black"},children:"0.0"}),(0,o.jsx)(Gradient,{}),(0,o.jsx)("div",{style:{color:"black"},children:"1.0"})]}),(0,o.jsx)(Selector,{className:I().selector})]})]})},z=n(17931);async function loadData(e){let t=await fetch(e);return await t.arrayBuffer()}async function loadInfo(e){let t=await fetch(e),n=await t.json();return function assertType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data";if("unknown"!==t){if("null"===t){if(null!==e)throw Error("Expected ".concat(n," to be null and not a ").concat(typeof e,"!"));return}if("string"==typeof t){if(typeof e!==t)throw Error("Expected ".concat(n," to be a string and not a ").concat(typeof e,"!"));return}if(Array.isArray(t)){let[o]=t;switch(o){case"array":!function(e,t,n){if(!Array.isArray(e))throw Error("Expected ".concat(t," to be an array and not a ").concat(typeof e,"!"));let[,o]=n;for(let n=0;n<e.length;n+=1)assertType(e[n],o,"".concat(t,"[").concat(n,"]"))}(e,n,t);return;case"map":!function(e,t,n){if(!(!(!e||Array.isArray(e))&&"object"==typeof e))throw Error("Expected ".concat(t," to be an object and not a ").concat(typeof e,"!"));let[,o]=n;for(let n of Object.keys(e))"string"==typeof n&&assertType(e[n],o,"".concat(t,"[").concat(n,"]"))}(e,n,t);return;case"?":!function(e,t,n){if(void 0===e)return;let[,o]=n;assertType(e,o,t)}(e,n,t);return;case"|":!function(e,t,n){let[,...o]=n,a=Error("No type has been defined for this alternative: ".concat(JSON.stringify(n),"!"));for(let n of o)try{assertType(e,n,t);return}catch(e){e instanceof Error&&(a=e)}throw a}(e,n,t);return;default:if(o.startsWith("array(")){let a=parseInt(o.substring(6,o.length-1),10);!function(e,t,n,o){if(!Array.isArray(e))throw Error("Expected ".concat(t," to be an array and not a ").concat(typeof e,"!"));if(e.length!==o)throw Error("".concat(t," was expected to have a length of ").concat(o,", but we got ").concat(e.length,"!"));let[,a]=n;for(let n=0;n<e.length;n+=1)assertType(e[n],a,"".concat(t,"[").concat(n,"]"))}(e,n,t,a);return}throw Error("Don't know how to create a type guard for this kind of type: ".concat(JSON.stringify(t)))}}if("object"!=typeof e)throw Error("Expected ".concat(n," to be an object and not a ").concat(typeof e,"!"));for(let o of Object.keys(t)){if("string"!=typeof o)continue;let a=t[o];a&&assertType(e[o],t[o],"".concat(n,".").concat(o))}}}(n,{min:["array(3)","number"],max:["array(3)","number"]}),n}var coordinates_viewer_CoordinatesViewer=()=>{let[e,t]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let start=async()=>{let e=await loadInfo("".concat(z.$N,"/3d/2_reconstruction-data/coordinates/mesh.json")),t=new Uint32Array(await loadData("".concat(z.$N,"/3d/2_reconstruction-data/coordinates/elem.dat"))),n=new Float32Array(await loadData("".concat(z.$N,"/3d/2_reconstruction-data/coordinates/vert.dat"))),a=document.getElementById("root"),r=(0,v.createRoot)(a);r.render((0,o.jsx)(Viewer_Viewer,{meshInfo:e,vert:n,elem:Array.from(t)}))};start()},[]),(0,o.jsx)("div",{id:"root",children:e&&(0,o.jsx)("p",{children:"Loading..."})})},H=n(42978),Y=n(61267),B=n(69313),U=n(71376),X=n(8404),G=n(82718),W=n(78433),K=n(67264),Q=n(50818),q=n(35930),J=n(22633),$=n(28354),ee=n(33638),et=(0,$.Z)(()=>{let e=(0,s.useRouter)(),[t,n]=(0,i.useState)(!1),{volume_section:a}=e.query,setVolumeSectionQuery=t=>{e.push({query:{volume_section:t}},void 0,{shallow:!0})};RegExp("region"===a?"CA1":a,"i");let r=[{title:"Volume section",key:"volume_section",values:Y.jo,setFn:setVolumeSectionQuery}];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(U.Z,{theme:2,hasData:!0,children:(0,o.jsxs)("div",{className:"flex flex-col lg:flex-row w-full lg:items-center mt-40 lg:mt-0",children:[(0,o.jsx)("div",{className:"w-full lg:w-1/2 md:w-full md:flex-none mb-8 md:mb-8 lg:pr-0",children:(0,o.jsxs)(G.Z,{children:[(0,o.jsx)(W.Z,{title:"Volume",subtitle:"Reconstruction Data",theme:2}),(0,o.jsx)("div",{role:"information",children:(0,o.jsx)(K.Z,{children:(0,o.jsxs)("p",{children:["We combined a publicly available ",(0,o.jsx)(d(),{href:"http://cng.gmu.edu/hippocampus3d/",className:"link theme-".concat(2),children:"atlas"})," with a process of coordinate extraction and ",(0,o.jsx)(d(),{href:"/experimental-data/layer-anatomy/",className:"link theme-".concat(2),children:"layer thickness estimation"})," to reconstruct the volume of CA1. From the entire CA1, we can obtain subvolumes of particular interest, such as cylinders and slices, at any desired location."]})})})]})}),(0,o.jsx)("div",{className:"flex flex-col-reverse md:flex-row-reverse gap-8 mb-12 md:mb-0 mx-8 md:mx-0 lg:w-1/2 md:w-full flex-grow md:flex-none justify-center",children:(0,o.jsxs)("div",{className:"selector__column selector__column--lg theme-".concat(2," w-full"),children:[(0,o.jsx)("div",{className:"selector__head theme-".concat(2),children:"Choose a layer"}),(0,o.jsx)("div",{className:"selector__body",children:(0,o.jsx)(J.Z,{value:a,onSelect:setVolumeSectionQuery,theme:2})})]})})]})}),(0,o.jsxs)(Q.Z,{theme:2,navItems:[{id:"volumeSection",label:"Volume"},{id:"coordinatesSection",label:"Coordinates"}],quickSelectorEntries:r,children:[(0,o.jsxs)(q.Z,{id:"volume",title:"Volume",properties:[a],children:[(0,o.jsx)("h2",{children:"region"===a?(0,o.jsx)("span",{children:"Region CA1"}):"cylinder"===a?(0,o.jsx)("span",{children:"Cylindrical subvolume of radius 300 um from the dorsal CA1."}):"slice"===a?(0,o.jsx)("span",{children:"Coronal slice of 400 um from the dorsal CA1."}):null}),(0,o.jsx)("h3",{children:"3D volume viewer"}),(0,o.jsx)(l.default,{spinning:!t,children:(0,o.jsx)("div",{className:"graph no-padding",children:(0,o.jsx)(volume_viewer,{meshPath:"".concat(z.$N,"/3d/2_reconstruction-data/volume/volume.obj"),volumeSection:a,onReady:()=>n(!0)})})}),(0,o.jsxs)("p",{className:"mt-4",children:["Related: ",(0,o.jsx)(d(),{href:"/experimental-data/layer-anatomy/",children:"Experimental data - Layer anatomy"})]}),(0,o.jsxs)("div",{className:"mt-12",children:[(0,o.jsx)("h2",{className:"text-lg",children:"Volume analysis"}),(0,o.jsx)(B.Z,{path:"".concat(z.$N,"/2_reconstruction-data/volume/volume_analysis.json"),children:e=>(0,o.jsxs)(o.Fragment,{children:[e&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(X.Z,{facts:e.values})}),(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)(ee.Z,{onClick:()=>(0,H.KO)(e.values,"volume_analysis.json"),theme:2,children:" Volume analysis "})})]})})]})]}),(0,o.jsxs)(q.Z,{id:"coordinatesSection",title:"Coordinates",className:"mt-4",properties:[a],children:[(0,o.jsx)("p",{children:"Due to its curvature and irregularities, the volume of CA1 is difficult to manipulate. For this reason, we define a coordinate system that follows the hippocampal axes (longitudinal, transverse, radial)."}),(0,o.jsx)("div",{className:"graph no-padding flex-col",children:(0,o.jsx)(l.default,{spinning:!t,children:(0,o.jsx)(coordinates_viewer_CoordinatesViewer,{})})})]})]})]})},{key:"volume_section",defaultQuery:Y.defaultSelection.reconstructionData.volume});function VolumePage(){let e={title:"Volume - Reconstruction Data | The Hippocampus Hub",description:"Explore the reconstructed volume of the CA1 region of the hippocampus. Visualize the 3D structure of CA1, including detailed layers and coordinates, and extract subvolumes of particular interest for further analysis.",keywords:["Hippocampus","CA1 Volume","3D Structure","Reconstruction Data","Neuroscience","Blue Brain Project","Coordinate System"],author:"Blue Brain Project",creator:"EPFL Blue Brain Project",publisher:"The Hippocampus Hub"};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r(),{children:[(0,o.jsx)("title",{children:e.title}),(0,o.jsx)("meta",{name:"description",content:e.description}),(0,o.jsx)("meta",{name:"keywords",content:e.keywords.join(", ")}),(0,o.jsx)("meta",{name:"author",content:e.author}),(0,o.jsx)("meta",{name:"creator",content:e.creator}),(0,o.jsx)("meta",{name:"publisher",content:e.publisher})]}),(0,o.jsx)(et,{})]})}},62249:function(e){e.exports={Scene:"Scene_Scene__w0BtV"}},5333:function(e){e.exports={Selector:"Selector_Selector__VUaVF",selected:"Selector_selected__q_nDm",unselected:"Selector_unselected__IVu7D"}},97223:function(e){e.exports={fixedAspectRatio:"viewer_fixedAspectRatio__sLXZy",App:"viewer_App__hb47X",canvas:"viewer_canvas__jn8nV",colorrampContainer:"viewer_colorrampContainer__Wc0AE",colorramp:"viewer_colorramp__0uORu",selector:"viewer_selector__l0_Sa",topRightCtrlGroup:"viewer_topRightCtrlGroup__Brav4"}},2064:function(e){e.exports={fixedAspectRatio:"volume-viewer_fixedAspectRatio__On_lG",container:"volume-viewer_container__o8FSH",coloredCheckbox:"volume-viewer_coloredCheckbox__9bhIF",coloredBox:"volume-viewer_coloredBox__vgrjm",settingBtn:"volume-viewer_settingBtn__DUNhE",fullscreenBtn:"volume-viewer_fullscreenBtn__HdEG7",config:"volume-viewer_config__3a6ZN",legend:"volume-viewer_legend__bshzh",topRightCtrlGroup:"volume-viewer_topRightCtrlGroup__t06Be",legendDivider:"volume-viewer_legendDivider__0yp_a"}},5152:function(e,t,n){e.exports=n(1342)}},function(e){e.O(0,[1228,3737,7056,4055,685,9242,9227,9886,8287,5653,9774,2888,179],function(){return e(e.s=17388)}),_N_E=e.O()}]);