(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6313],{17517:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/predictions/voltage",function(){return n(77244)}])},22633:function(e,t,n){"use strict";var r=n(85893),l=n(67294),c=n(99477),a=n(87011),i=n(97157),s=n(71711),o=n(61267),u=n(17931),m=n(80204),d=n.n(m);t.Z=e=>{let{value:t="region",onSelect:n=()=>{},theme:m=2}=e,p=(0,l.useRef)(null),h=(0,l.useRef)(null),y=(0,l.useRef)(t),f=(0,l.useRef)(null),g=(0,l.useRef)(null),x=(0,l.useRef)(null),j=(0,l.useRef)(null),v=(0,l.useRef)(null),_=(0,l.useRef)(new c.FM8),S=(0,l.useRef)(null),w=(0,l.useRef)(null),b=(0,l.useRef)(null),k=(0,l.useRef)(!1),[E,C]=(0,l.useState)(21),[N,R]=(0,l.useState)(1),T=(0,l.useCallback)(e=>{if(!k.current)return;let t=p.current.getBoundingClientRect();_.current.x=(e.clientX-t.left)/t.width*2-1,_.current.y=-(2*((e.clientY-t.top)/t.height))+1,v.current.setFromCamera(_.current,g.current);let r=v.current.intersectObjects([S.current,w.current,b.current],!0);if(r.length>0){let e=r[0].object;for(;e.parent&&![S.current,w.current,b.current].includes(e);)e=e.parent;if([S.current,w.current,b.current].includes(e)){let t=e.userData.volumeSection;t&&(updateSelection(t,e),n(t))}}},[n,m]),updateSelection=(e,t)=>{f.current&&updateObjectColors(f.current,o.rS[m].default,o.rS[m].hover),updateObjectColors(t,o.rS[m].selected,16777215),y.current=e,f.current=t},updateObjectColors=(e,t,n)=>{e.traverse(r=>{r instanceof c.Kj0&&(r.name===e.userData.volumeSection&&r.material.color.set(t),r.geometry&&"TextGeometry"===r.geometry.type&&r.material.color.set(n))})};(0,l.useEffect)(()=>{if(!p.current)return;x.current=new c.xsS,x.current.background=new c.Ilk("#313354");let e=p.current.clientWidth/p.current.clientHeight;g.current=new c.iKG(-(200*e),200*e,200,-200,.1,1e3),g.current.position.z=10,j.current=new c.CP7({antialias:!0,alpha:!0}),j.current.setSize(p.current.clientWidth,p.current.clientHeight),j.current.setPixelRatio(window.devicePixelRatio),p.current.appendChild(j.current.domElement),v.current=new c.iMs;let n=new a.L;n.load("".concat(u.$N,"/3d/volume-selector/volume-selector.obj"),e=>{[S,w,b].forEach((t,n)=>{let r=e.clone();t.current=r,r.position.set((n-1)*E,0,0),r.userData.volumeSection=["region","slice","cylinder"][n],applyMaterial(r,n),x.current.add(r)});let n=new i.J;n.load("".concat(u.sb,"/assets/fonts/Titillium_Web_Light_.json"),e=>{["Region","Slice","Cylinder"].forEach((t,n)=>{createText(t,[S,w,b][n].current,t.toLowerCase(),e)})}),k.current=!0,t&&setInitialSelection(t),animate()},e=>console.log(e.loaded/e.total*100+"% loaded"),e=>console.error("An error happened",e));let animate=()=>{requestAnimationFrame(animate),j.current.render(x.current,g.current)},handleResize=()=>{if(p.current&&j.current&&g.current){let e=p.current.clientWidth,t=p.current.clientHeight;j.current.setSize(e,t);let n=e/t;g.current.left=-(200*n),g.current.right=200*n,g.current.top=200,g.current.bottom=-200,g.current.updateProjectionMatrix();let r=window.innerWidth<1400?16:21;C(r),g.current.zoom=window.innerWidth<1200?11:16,g.current.updateProjectionMatrix();let l=window.innerWidth<1200?1:.8;R(l),updateTextSize()}},handleMouseMove=e=>{if(!k.current)return;let t=p.current.getBoundingClientRect();_.current.x=(e.clientX-t.left)/t.width*2-1,_.current.y=-(2*((e.clientY-t.top)/t.height))+1,v.current.setFromCamera(_.current,g.current);let n=v.current.intersectObjects([S.current,w.current,b.current],!0);if(n.length>0){let e=n[0].object;for(;e.parent&&![S.current,w.current,b.current].includes(e);)e=e.parent;h.current!==e&&f.current!==e&&(h.current&&h.current!==f.current&&updateObjectColors(h.current,o.rS[m].default,o.rS[m].hover),updateObjectColors(e,o.rS[m].hover,o.rS[m].hover),h.current=e,p.current.style.cursor="pointer")}else h.current&&h.current!==f.current&&(updateObjectColors(h.current,o.rS[m].default,o.rS[m].hover),h.current=null,p.current.style.cursor="default")};return window.addEventListener("resize",handleResize),p.current.addEventListener("mousemove",handleMouseMove),p.current.addEventListener("click",T),handleResize(),()=>{window.removeEventListener("resize",handleResize),p.current&&(p.current.removeEventListener("mousemove",handleMouseMove),p.current.removeEventListener("click",T),p.current.removeChild(j.current.domElement))}},[m]),(0,l.useEffect)(()=>{k.current&&[S,w,b].forEach((e,t)=>{e.current&&e.current.position.set((t-1)*E,0,0)})},[E]),(0,l.useEffect)(()=>{k.current&&t&&setInitialSelection(t)},[t,m]);let applyMaterial=(e,t)=>{e.traverse(t=>{if(t instanceof c.Kj0){let n;if(t.name===e.userData.volumeSection)n=new c.vBJ({color:o.rS[m].default,transparent:!1,opacity:1,depthWrite:!0}),t.renderOrder=2;else if("skeleton"===t.name){n=new c.vBJ({color:o.rS[m].selectedEdges,transparent:!0,opacity:0,depthWrite:!1});let e=new c.TOt(t.geometry),r=new c.nls({color:o.rS[m].default,transparent:!0,opacity:1,depthWrite:!1}),l=new c.ejS(e,r);l.renderOrder=1,t.add(l)}else t.visible=!1;n&&(t.material=n)}})},createText=(e,t,n,r)=>{let l=new s.M(e,{font:r,size:N,height:.2,curveSegments:32,bevelEnabled:!0,bevelThickness:.02,bevelSize:.02}),a=y.current===n?16777215:o.rS[m].hover,i=new c.vBJ({color:a,transparent:!1,opacity:1}),u=new c.Kj0(l,i);t.traverse(e=>{e instanceof c.Kj0&&e.name===n&&(u.position.set(0,0,0),e.add(u))})},updateTextSize=()=>{["Region","Slice","Cylinder"].forEach((e,t)=>{let n=[S,w,b][t].current;n&&n.traverse(t=>{if(t instanceof c.Kj0&&t.geometry&&"TextGeometry"===t.geometry.type){let r=t.parent;if(r){r.remove(t);let l=new i.J;l.load("".concat(u.sb,"/assets/fonts/Titillium_Web_Light_.json"),t=>{createText(e,n,e.toLowerCase(),t)})}}})})},setInitialSelection=e=>{let t=[S,w,b].find(t=>{var n;return(null===(n=t.current)||void 0===n?void 0:n.userData.volumeSection)===e});(null==t?void 0:t.current)&&updateSelection(e,t.current)};return(0,r.jsxs)("div",{className:d().container,children:[(0,r.jsx)("div",{className:d().volumeSelector,ref:p}),(0,r.jsx)("div",{className:d().volumeList})]})}},77244:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return VoltagePage}});var r=n(85893),l=n(9008),c=n.n(l),a=n(67294),i=n(11163),s=n(71376),o=n(82718),u=n(78433),m=n(67264),d=n(13210),p=n(3725),h=n(50818),y=n(35930),f=n(64632),g=n(22923),x=n(17931),j=n(22633),v=n(61267),_=n(91968),S=n(33638),w=n(42978);let b={cylinder:{K_Inj:[110,115,120,122,124,126,128,130,140],CA_O:[1,1.25,1.5,1.75,2,2.25,2.5]},region:{K_Inj:[115,120,122,124,126,128,130,140],CA_O:[1,1.5,2]},slice:{K_Inj:[120,130,140],CA_O:[1,2]}};var Voltage=()=>{let e=(0,i.useRouter)(),[t,n]=(0,a.useState)({}),[l,c]=(0,a.useState)(null),[k,E]=(0,a.useState)(null),[C,N]=(0,a.useState)(null),[R,T]=(0,a.useState)(null),getVolumeSection=()=>t.volume_section||"region",getMtypes=()=>[...new Set(g.map(e=>e.mtype))].sort(),getEtypes=e=>[...new Set(g.filter(t=>t.mtype===e).map(e=>e.etype))].sort();(0,a.useEffect)(()=>{if(!e.isReady)return;let{volume_section:t,mtype:r,etype:l,ca_o:c,k_inj:a}=e.query,i={};if("string"==typeof t&&(i.volume_section=t),"string"==typeof r&&(i.mtype=r),"string"==typeof c&&(i.ca_o=parseFloat(c)),"string"==typeof a&&(i.k_inj=parseFloat(a)),"string"==typeof r){let e=getEtypes(r);i.etype="string"==typeof l&&e.includes(l)?l:e[0]||""}if(n(i),0===Object.keys(i).length){let t=getMtypes()[0],r="region",l={volume_section:r,mtype:t,etype:getEtypes(t)[0]||"",ca_o:b[r].CA_O[0],k_inj:b[r].K_Inj[0]};n(l),e.replace({query:l},void 0,{shallow:!0})}},[e.isReady,e.query]),(0,a.useEffect)(()=>{let fetchData=async()=>{let{volume_section:e,ca_o:n,k_inj:r,mtype:l,etype:a}=t;if(void 0===n||void 0===r||!l||!a||!e)return;let i="".concat(x.$N,"/5_prediction/voltage/").concat(e,"/").concat(n,"-").concat(r,"/").concat(l,"-").concat(a);for(let{name:e,setter:t}of[{name:"spike-time",setter:c},{name:"mean-firing-rate",setter:E},{name:"trace",setter:N}])try{let n=await fetch("".concat(i,"/").concat(e,".json"));if(n.ok){let e=await n.json();t(e)}else if(404===n.status)console.warn("".concat(e," data not found")),t(null);else throw Error("HTTP error! status: ".concat(n.status))}catch(n){console.error("Error fetching ".concat(e," data:"),n),t(null)}try{let e=await fetch("".concat(i,"/spike-time-plot.svg"));if(e.ok){let t=await e.text();T(t)}else if(404===e.status)console.warn("Spike time plot SVG not found"),T(null);else throw Error("HTTP error! status: ".concat(e.status))}catch(e){console.error("Error fetching spike-time-plot.svg:",e),T(null)}};fetchData()},[t]);let setParams=t=>{let n={...e.query,...t};e.push({query:n,pathname:e.pathname},void 0,{shallow:!0})},handleVolumeSelect=e=>{let r=t.mtype,l=t.etype,c=getMtypes(),a=c.includes(r)?r:c[0],i=getEtypes(a),s=i.includes(l)?l:i[0],o={...t,volume_section:e,ca_o:b[e].CA_O[0],k_inj:b[e].K_Inj[0],mtype:a,etype:s};n(o),setParams(o)},handleMtypeSelect=e=>{let t=getEtypes(e),r=t[0]||"";n(t=>({...t,mtype:e,etype:r})),setParams({mtype:e,etype:r})},handleEtypeSelect=e=>{n(t=>({...t,etype:e})),setParams({etype:e})},M=getMtypes(),O=getEtypes(t.mtype),V=[{title:"Volume Section",key:"volume_section",values:v.jo,setFn:handleVolumeSelect},{title:"CA_0",key:"ca_o",getValuesFn:()=>b[getVolumeSection()].CA_O,sliderRange:b[getVolumeSection()].CA_O},{title:"K_Inj",key:"k_inj",getValuesFn:()=>b[getVolumeSection()].K_Inj,sliderRange:b[getVolumeSection()].K_Inj},{title:"M-type",key:"mtype",values:M,setFn:handleMtypeSelect},{title:"E-Type",key:"etype",values:O,setFn:handleEtypeSelect}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{theme:5,hasData:!!t.volume_section&&!!t.mtype&&!!t.etype,children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row w-full lg:items-center mt-40 lg:mt-0",children:[(0,r.jsx)("div",{className:"w-full lg:w-1/2 md:w-full md:flex-none mb-8 md:mb-8 lg:pr-0",children:(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(u.Z,{title:"Voltage - Calcium Scan",subtitle:"Predictions",theme:5}),(0,r.jsx)("div",{role:"information",children:(0,r.jsx)(m.Z,{children:(0,r.jsx)("p",{children:"Changing the extracellular ionic concentrations is known to alter excitability of neurons. To model this effect, we varied over a realistic range changes in extracellular calcium and the tonic depolarization resulting from varying extracellular potassium concentration. Here, we report that for restricted parameter ranges only variable and irregular theta activity was generated in CA1."})})})]})}),(0,r.jsxs)("div",{className:"flex flex-col gap-8 mb-12 md:mb-0 mx-8 md:mx-0 lg:w-1/2 md:w-full flex-grow md:flex-none justify-center",style:{maxWidth:"800px"},children:[(0,r.jsxs)("div",{className:"selector__column selector__column--lg mt-3 theme-".concat(5),style:{maxWidth:"auto"},children:[(0,r.jsx)("div",{className:"selector__head theme-".concat(5),children:"1. Select a volume section"}),(0,r.jsx)("div",{className:"selector__body",children:(0,r.jsx)(j.Z,{value:getVolumeSection(),onSelect:handleVolumeSelect,theme:5})})]}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8 flex-grow p-0 m-0",children:[(0,r.jsxs)("div",{className:"selector__column theme-".concat(5," flex-1"),style:{maxWidth:"auto"},children:[(0,r.jsx)("div",{className:"selector__head theme-".concat(5),children:"2. Select extracellular conditions"}),(0,r.jsx)("div",{className:"selector__body",children:(0,r.jsx)(p.Z,{path:"5_prediction/voltage/".concat(t.volume_section,"/"),xRange:b[getVolumeSection()].CA_O,yRange:b[getVolumeSection()].K_Inj,xAxisLabel:"Ca2+ (mM)",yAxisLabel:"k_inj",theme:5,onSelect:(e,t)=>{n(n=>({...n,ca_o:e,k_inj:t})),setParams({ca_o:e,k_inj:t})},selectedX:t.ca_o,selectedY:t.k_inj})})]}),(0,r.jsxs)("div",{className:"selector__column theme-".concat(5," flex-1"),children:[(0,r.jsx)("div",{className:"selector__head theme-".concat(5),children:"3. Select cell types"}),(0,r.jsxs)("div",{className:"selector__body",children:[(0,r.jsx)(d.Z,{block:!0,list:M,value:t.mtype,title:"M-type ".concat(M.length?"("+M.length+")":""),onSelect:handleMtypeSelect,theme:5}),(0,r.jsx)(d.Z,{block:!0,list:O,value:t.etype,title:"E-type ".concat(O.length?"("+O.length+")":""),onSelect:handleEtypeSelect,theme:5})]})]})]})]})]})}),(0,r.jsxs)(h.Z,{theme:5,navItems:[{id:"spikeTimeSection",label:"Spike Time"},{id:"meanFiringRateSection",label:"Mean Firing Rate"},{id:"traceSection",label:"Traces"}],quickSelectorEntries:V,children:[(0,r.jsxs)(y.Z,{id:"spikeTimeSection",properties:[t.mtype+"-"+t.etype],title:"Spike Time",children:[(0,r.jsx)("div",{className:"graph",children:R?(0,r.jsx)("div",{className:"svg-container",style:{width:"100%",height:"550px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:R},className:"svg-content"})}):(0,r.jsx)("p",{children:"Spike time plot not available"})}),(0,r.jsxs)(S.Z,{theme:5,onClick:()=>l&&(0,w.KO)(l,"spike-time-".concat(t.mtype,"-").concat(t.etype,"_").concat(t.ca_o,"-").concat(t.k_inj)),children:["Spike time","  ",(0,r.jsx)("span",{className:"!ml-0 collapsible-property small",children:t.volume_section}),(0,r.jsxs)("span",{className:"!ml-0 collapsible-property small",children:[t.mtype,"-",t.etype]}),(0,r.jsxs)("span",{className:"!ml-0 collapsible-property small",children:[t.ca_o,"-",t.k_inj]})]})]}),(0,r.jsxs)(y.Z,{id:"meanFiringRateSection",properties:[t.mtype+"-"+t.etype],title:"Mean Firing Rate",children:[(0,r.jsxs)("p",{children:["Distribution of neuron firing rate. We excluded first 1000 ms and sampled a maximum of 100 random neurons",(0,r.jsx)("sup",{children:"*"}),"."]}),(0,r.jsx)("div",{className:"graph",children:k?(0,r.jsx)(f.Z,{plotData:k,xAxis:"Firing Rate (Hz)",yAxis:"Frequency",xAxisTickStep:.1}):(0,r.jsx)("p",{children:"Mean firing rate data not available"})}),(0,r.jsxs)("small",{children:[(0,r.jsx)("sup",{children:"[*]"})," We may see an empty mean firing rate plot, even though there are spikes in the network (see ",(0,r.jsx)("a",{href:"#spikeTimeSection",children:"Spike Time"})," section). This is because the plot is based on a sample of 100 neurons, none of which may spike at low firing rates."]}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsxs)(S.Z,{theme:5,onClick:()=>k&&(0,w.KO)(k,"mean-firing-rate-".concat(t.mtype,"-").concat(t.etype,"_").concat(t.ca_o,"-").concat(t.k_inj)),children:["Mean Firing Rate","  ",(0,r.jsx)("span",{className:"!ml-0 collapsible-property small",children:t.volume_section}),(0,r.jsxs)("span",{className:"!ml-0 collapsible-property small",children:[t.mtype,"-",t.etype]}),(0,r.jsxs)("span",{className:"!ml-0 collapsible-property small",children:[t.ca_o,"-",t.k_inj]})]})]}),(0,r.jsxs)(y.Z,{id:"traceSection",title:"Traces",children:[(0,r.jsx)("div",{className:"graph",children:C?(0,r.jsx)(_.Z,{plotData:C,maxTime:1e4}):(0,r.jsx)("p",{children:"Trace data not available"})}),(0,r.jsxs)(S.Z,{theme:5,onClick:()=>C&&(0,w.KO)(C,"trace-".concat(t.mtype,"-").concat(t.etype,"_").concat(t.ca_o,"-").concat(t.k_inj)),children:["Trace","  ",(0,r.jsx)("span",{className:"!ml-0 collapsible-property small",children:t.volume_section}),(0,r.jsxs)("span",{className:"!ml-0 collapsible-property small",children:[t.mtype,"-",t.etype]}),(0,r.jsxs)("span",{className:"!ml-0 collapsible-property small",children:[t.ca_o,"-",t.k_inj]})]})]})]})]})};function VoltagePage(){let e={title:"Voltage - Calcium Scan - Predictions | The Hippocampus Hub",description:"Explore predictions of network excitability under varying extracellular calcium concentrations and ionic conditions. Visualize the spike time, mean firing rate, and traces for CA1 neurons in different voltage-calcium scenarios.",keywords:["Voltage","Calcium Scan","Spike Time","Firing Rate","Hippocampus","Neuroscience","Blue Brain Project","The Hippocampus Hub"],author:"Blue Brain Project",creator:"EPFL Blue Brain Project",publisher:"The Hippocampus Hub"};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{children:e.title}),(0,r.jsx)("meta",{name:"description",content:e.description}),(0,r.jsx)("meta",{name:"keywords",content:e.keywords.join(", ")}),(0,r.jsx)("meta",{name:"author",content:e.author}),(0,r.jsx)("meta",{name:"creator",content:e.creator}),(0,r.jsx)("meta",{name:"publisher",content:e.publisher})]}),(0,r.jsx)(Voltage,{})]})}},80204:function(e){e.exports={container:"styles_container__NKkJz",volumeSelector:"styles_volumeSelector__dN4Dl",volumeList:"styles_volumeList__5Src0",volumeSection:"styles_volumeSection__yJuJz",active:"styles_active__RrlYY"}}},function(e){e.O(0,[1228,2196,3737,7056,9676,9242,4922,8287,7577,9774,2888,179],function(){return e(e.s=17517)}),_N_E=e.O()}]);